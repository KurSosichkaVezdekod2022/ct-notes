\documentclass{article}
\input{Headers/header}
\input{Headers/formal}

\fancyhead[L]{Математический анализ}

\let\eps\varepsilon

\undef\limsup
\DeclareMathOperator*{\limsup}{\overline{\lim}}
\undef\liminf
\DeclareMathOperator*{\liminf}{\underline{\lim}}

\begin{document}
    \tableofcontents\pagebreak
    \part{Функциональные последовательности и ряды.}
    \begin{remark}
        В этом разделе будут изучаться последовательности вида $\{f_n\}_{n=1}^\infty$, где каждая $f_n\colon X\to\mathbb R$ или $f_n\colon X\to\mathbb C$.
    \end{remark}
    \section{Определение и признаки равномерной сходимости.}
    \begin{definition}
        Пусть $f_n,f\colon X\to\mathbb R(\mathbb C)$. Говорят, что последовательность $f_n$ \textbf{поточечно сходится} к $f$ на множестве $X$, если $\forall x\in X$ числовая последовательность $f_n(x)$ сходится к $f(x)$.\\
        На $\varepsilon$-языке:
        $$
        \forall x\in X~\forall\eps>0~\exists N\in\mathbb N~\forall n>N~|f_n(x)-f(x)|<\eps
        $$
    \end{definition}
    \begin{remark}
        Обычно нас интересуют вопросы вида: если все $f_n$ обладают некоторым свойством, обладает ли этим свойством $f$? А точнее
        \begin{enumerate}
            \item Если каждая $f_n$ непрерывна, непрерывна ли $f$?
            \item Если каждая $f_n$ дифференцируема, дифференцируема ли $f$? А если так, то стремится ли предел производных к производной предела?
            \item Если каждая $f_n$ интегрируема, интегрируема ли $f$? А если так, то стремится ли предел интегралов к интегралу предела?
        \end{enumerate}
        На все три вопроса ответ отрицательный, а чтобы утверждения были верны, приходится требовать какую-то более сильную сходимость.
    \end{remark}
    \begin{example}
        Контрпример для непрерывности мы можем привести уже сейчас:
        $$f_n(x)=x^n\quad x\in[0;1]$$
        Тогда $f_n\underset{n\to\infty}\longrightarrow\begin{cases}
            0 & x\in[0;1)\\
            1 & x=1
        \end{cases}\notin C[0;1]$
    \end{example}
    \begin{definition}
        Пусть $f_n,f\colon X\to\mathbb R(\mathbb C)$. Говорят, что $f_n$ \textbf{равномерно сходится} к $f$, если
        $$
        \forall\eps>0~\exists N\in\mathbb N~\forall n>N~\forall x\in X~|f_n(x)-f(x)|<\eps
        $$
        Пишут $f_n\toto f$.
    \end{definition}
    \begin{claim}
        Очевидно, если $f_n\toto f$, то $f\to n$. Обратное неверно (примером является пример выше).
    \end{claim}
    \begin{remark}
        Давайте посмотрим, как выглядит условие равномерной сходимости на графике. У нас есть график $y=f(x)$, и есть два подобных ему: $y=f(x)\pm\eps$. Утверждение говорит нам, что для любого $\eps$ начиная с некоторого $N$ графики всех функций $f_{n\geqslant N}$ будут \textbf{полностью} лежать в этой области.
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 10cm,
                    height = 8cm,
                    grid = none,
                    xmin = -.5,
                    xmax = 5,
                    ymin = -.4,
                    ymax = 4,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    xtick = \empty,
                    ytick = \empty,
                    xlabel = \empty,
                    ylabel = \empty,
                    ]
                    \addplot[domain=-.5:5,samples=100,black,thick]{((x - 2.5)/3)^3 + 2};
                    \addplot[domain=-.5:5,samples=100,black,dashed,name path=A]{((x - 2.5)/3)^3 + 1.7};
                    \addplot[domain=-.5:5,samples=100,black,dashed,name path=B]{((x - 2.5)/3)^3 + 2.3};
                    \node[coordinate] (A) at (axis cs:4.9,557/216) {};
                    \node[coordinate] (B) at (axis cs:4.9,557/216+.3) {};
                    \node[coordinate] (C) at (axis cs:4.9,557/216-.3) {};
                    \addplot[gray,pattern=north east lines] fill between[of=A and B];
                \end{axis}
                \node[draw=none,label={0:$y=f(x)$}] at (A) {};
                \node[draw=none,label={0:$y=f(x)+\eps$}] at (B) {};
                \node[draw=none,label={0:$y=f(x)-\eps$}] at (C) {};
            \end{tikzpicture}
        \end{figure}
        В нашем же случае с $f_n(x)=x^n$ у функций $f_n$ вблизи единицы (а не в самой единице) происходит резкий рост. И какое бы $\eps$ мы не выбрали, любая $f_n$ (даже с достаточно большим номером) рано или поздно вырвется из области $y=f(x)+\eps$.
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 10cm,
                    height = 10cm,
                    grid = none,
                    xmin = -.1,
                    xmax = 1.1,
                    ymin = -.1,
                    ymax = 1.1,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    ]
                    \addplot[black,samples=2,domain=0:1] {x};
                    \addplot[black,samples=100,domain=0:1] {x^3};
                    \addplot[black,samples=100,domain=0:1] {x^10};
                    
                    \node[circle,draw=black,fill=white,very thick,scale=.7] (1) at (axis cs:1,0) {};
                    \node[circle,fill=black,scale=.7] (0) at (axis cs:0,0) {};
                    \node[circle,fill=black,scale=.7] (11) at (axis cs:1,1) {};
                    \draw[ultra thick] (0) -- (1);
                    \draw[dashed] (axis cs:0,.07) -- (axis cs:1,.07);
                \end{axis}
            \end{tikzpicture}
        \end{figure}
    \end{remark}
    \begin{example}
        Пусть $f_n(x)=\alpha_n$. Тогда, как несложно заметить, что поточечная сходимости, что равномерная равносильны обычной сходимости числового ряда $\{\alpha_n\}_{n=1}^\infty$.
    \end{example}
    \begin{claim}
        $$
        f_n\toto f\Leftrightarrow\left\{\begin{aligned}
            \Re f_n&\toto \Re f\\
            \Im f_n&\toto \Im f
        \end{aligned}\right.
        $$
        Доказательство оставляется читателю.
    \end{claim}
    \begin{definition}
        Пусть $f_n\colon X\to\mathbb R(\mathbb C)$. Тогда $\sum\limits_{n=1}^\infty f_n$ называется \textbf{функциональным рядом}.
    \end{definition}
    \begin{definition}
        Множество $E=\left\{x\in X~\middle|~\sum\limits_{n=1}^\infty f_n(x)\text{ сходится}\right\}$ называется \textbf{множеством сходимости ряда} $\sum\limits_{n=1}^\infty f_n$.
    \end{definition}
    \begin{definition}
        Функции $S_n=\sum\limits_{k=1}^n f_n$ называются \textbf{частичными суммами функционального ряда} $\sum\limits_{n=1}^\infty f_n$.
    \end{definition}
    \begin{definition}
        \textbf{Суммой функционального ряда} называется предел частичных сумм.
    \end{definition}
    \begin{definition}
        Если частичные суммы равномерно сходятся к сумме ряда, то говорят, что ряд \textbf{равномерно сходится} к своей сумме.\\
        На $\eps$-языке:
        $$
        \forall\eps>0~\exists N\in\mathbb N~\forall n>N~\forall x\in X~\left|\sum\limits_{k=n+1}^\infty f_k(x)\right|<\eps
        $$
    \end{definition}
    \begin{claim}
        Из предыдущего функциональный ряд равномерно сходится тогда и только тогда, когда его остаток равномерно стремится к нулю.
    \end{claim}
    \begin{definition}
        Пусть $f\colon X\to\mathbb R(\mathbb C)$. Тогда равномерной (чебышёвской) нормой $f$ называется величина
        $$
        \|f\|=\|f\|_X=\sup\limits_{x\in X}|f(x)|
        $$
    \end{definition}
    \begin{property}
        Это действительно норма.
    \end{property}
    \begin{proof}
        \begin{enumerate}
            \item $\|f\|=0\Leftrightarrow f=0$. Тривиально.
            \item $\|\lambda f\|=|\lambda|\|f\|$. Тривиально, если принять соглашение $0\cdot\infty=0$.
            \item $\|f+g\|\leqslant\|f\|+\|g\|$. Рассмотрим $x\in X$.
            $$
            |f(x)+g(x)|\leqslant|f(x)|+|g(x)|\leqslant\|f\|+\|g\|
            $$
            Если перейти в этом неравенстве к супремуму, получится то, что требуется доказать.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Равномерную норму называют нормой несмотря на то, что норма в наших определениях была функцией с конечными значениями. Вместо того, чтобы не считать её нормой, рассматривают конкретное множество, на котором она принимает конечные значения. Среди них
        \begin{itemize}
            \item $l_\infty(X)$~--- множество функций, ограниченных на $X$ с равномерной нормой. Но его рассматривают не так часто, оно не очень интересно.
            \item Пусть $\scriptK$~--- компакт. Тогда рассматривают $C(\scriptK)$~--- пространство непрерывных на $\scriptK$ функций с равномерной нормой. Тогда
            $$\|f\|=\max\limits_\scriptK|f|$$
        \end{itemize}
    \end{remark}
    \begin{claim}
        $$\|fg\|\leqslant\|f\|\|g\|$$
    \end{claim}
    \begin{proof}
        Рассмотрим $x\in X$.
        $$|f(x)g(x)|=|f(x)||g(x)|\leqslant\|f\|\|g\|$$
        Осталось перейти к супремуму.
    \end{proof}
    \begin{claim}
        $$f_n\toto f\Leftrightarrow\|f_n-f\|\rightarrow0$$
        Иначе говоря, равномерная сходимость равносильна сходимости по равномерной норме.
    \end{claim}
    \begin{remark}
        Это позволяет нам не доказывать простейшие свойства равномерной сходимости.
    \end{remark}
    \begin{remark}
        Также это позволяет нам легко определять равномерную сходимость. Если мы нашли поточечный предел функциональной последовательности, то можно рассмотреть числовую последовательность $\|f_n-f\|$. Наш поточечный предел является равномерным пределом тогда и только тогда, когда эта числовая последовательность бесконечно мала.
    \end{remark}
    \begin{remark}
        Если $f_n,f\colon X\to\mathbb R(\mathbb C)$ и $X_0\subset X$, то
        $$
        f_n\toto f(X)\Rightarrow f_n\toto f(X_0)
        $$
        В частности, если последовательность не является равномерно сходящейся на подмножестве $X$, то и на $X$ тоже.
    \end{remark}
    \begin{example}
        \begin{enumerate}[a)]
            \item Рассмотрим уже знакомый нам пример $f_n(x)=x^n$ на $[0;1)$. Тогда поточечный предел равен $0$, а предел нормы разностей
            $$\|f_n-f\|=\sup\limits_{x\in[0;1)}x^n=1\not\rightarrow0$$
            \item Отсюда на множестве $[0;1]$ также нет равномерной сходимости
            \item А вот на множестве $[0;q]\mid q<1$ равномерная сходимость есть:
            $$\|f_n-f\|=\sup\limits_{x\in[0;q]}x^n=q^n\rightarrow0$$
        \end{enumerate}
    \end{example}
    \addtocounter{property}{-1}
    \begin{property}
        Тривиально проверить, что если $f_n\toto f$, $g_n\toto g$, $\alpha,\beta\in\mathbb R(\mathbb C)$, то $\alpha f_n+\beta g_n\toto\alpha f+\beta g$.
    \end{property}
    \begin{property}
        \label{Произведение равномерно сходящейся на ограниченную}
        Если $f_n\toto f$, $g$ ограничена, то $f_ng\toto fg$.
    \end{property}
    \begin{proof}
        $$\|f_ng-fg\|=\|(f_n-f)g\|\leqslant\|f_n-f\|\|g\|$$
        Это произведение бесконечно малой на ограниченную.
    \end{proof}
    \begin{theorem}[Критерий Больцано-Коши равномерности функциональных последовательностей]
        \label{Б-К для функциональных последовательностей}
        Пусть $X$~--- множество, $f_n\colon X\to\mathbb R(\mathbb C)$. Тогда $\{f_n\}_{n=1}^\infty$ равномерно сходится на $X$ тогда и только тогда, когда
        $$
        \forall\eps>0~\exists N~\forall n,l>N~\forall x\in X~|f_n-f_l|<\eps
        $$
    \end{theorem}
    \begin{definition}
        Последняя формулировка называется \textbf{равномерной сходимостью в себе} и обозначается также
        $$
        \|f_n-f_l\|\underset{n,l\to\infty}\longrightarrow0
        $$
    \end{definition}
    \begin{proof}
        \begin{itemize}
            \item[$\Rightarrow$.] Пусть $f_n\toto f$. Тогда для $\eps>0$ подберём $N(\frac\eps2)$, то есть такое $N$, что
            $$
            \forall n>N~\forall x\in X~|f_n-f|<\frac\eps2
            $$
            Тогда это $N$ подойдёт для равномерной сходимости в себе.
            \item[$\Leftarrow$.] Если $\forall x~\{f_n(x)\}$ сходится в себе, то и просто сходится (по полноте $\mathbb R(\mathbb C)$). Обозначим предел через $f(x)$. Осталось доказать, что эта поточечная сходимость также равномерная.\\
            А для этого можно взять определение равномерной сходимости в себе и устремить $l\to\infty$. Получим как равномерную сходимость к $f$.
        \end{itemize}
    \end{proof}
    \begin{theorem}[Критерий Больцано~--- Коши равномерной сходимости функциональных рядов]
        \label{Б-К для функциональных рядов}
        Пусть $f\colon X\to\mathbb R(\mathbb C)$. Тогда ряд $\sum\limits_{k=1}^\infty f_k$ равномерно сходится на $X$ тогда и только тогда, когда
        $$
        \forall\eps>0~\exists N~\forall n>N~\forall p\in\mathbb N~\forall x\in X~\left|\sum\limits_{k=n+1}^{n+p}f_k(x)\right|<\eps
        $$
    \end{theorem}
    \begin{proof}
        Очевидно из предыдущего.
    \end{proof}
    \begin{corollary}
        \label{общий член к 0}
        Если ряд равномерно сходится, то его общий член равномерно стремится к нулю.
    \end{corollary}
    \begin{proof}
        Возьмите в теореме \ref{Б-К для функциональных рядов} $p=1$.
    \end{proof}
    \begin{example}
        $$\sum\limits_{k=0}^\infty x^k=\frac1{1-x}\mid |x|<1$$
        При этом на $[0;1)$ и тем более, на $(-1;1)$ сходимость неравномерна по следствию \ref{общий член к 0}.
    \end{example}
    \begin{theorem}
        Пространство $l_\infty(X)$ полно.
    \end{theorem}
    \begin{proof}
        Рассмотрим последовательность $\{f_n\}_{n=1}^\infty\subset l_\infty(X)$. Она сходится в себе, а следовательно равномерно сходится в себе. По теореме \ref{Б-К для функциональных последовательностей}, $\{f_n\}$ равномерно сходится к некоторому пределу $f$. Если $f$ ограничена, то мы докажем полноту.\\
        Последовательность $\{f_n\}$ сходится в себе, значит ограничена, то есть $\exists K\in(0;+\infty)~\forall n\in\mathbb N~\|f_n\|\leqslant K$. Отсюда
        $$
        \forall n\in\mathbb N~\forall x\in X~\|f_n(x)\|\leqslant K
        $$
        Перейдя к пределу по $n$, получим ограниченность $f(x)$.
    \end{proof}
    \begin{theorem}[Признак Вейерштрасса равномерной сходимости рядов]
        \label{Признак Вейерштрасса}
        Пусть $f_n\colon X\to\mathbb R(\mathbb C)$, $\sum\limits_{k=1}^\infty\|f_n\|<+\infty$. Тогда $\sum\limits_{k=1}^\infty f_n$ равномерно сходится на $X$.
    \end{theorem}
    \begin{proof}
        Возьмём $\eps>0$ и из критерия Больцано-Коши для числовых рядов подберём $N$ такое, что
        $$
        \forall n>N~\forall p\in\mathbb N~\sum\limits_{k=n+1}^{n+p}\|f_k\|<\eps
        $$
        Утверждается, что это же $N$ подойдёт нам и сюда. Рассмотрим $x\in X$.
        $$
        \left|\sum\limits_{k=n+1}^{n+p}f_k(x)\right|\leqslant\sum\limits_{k=n+1}^{n+p}|f_k(x)|\leqslant\sum\limits_{k=n+1}^{n+p}\|f_k\|<\eps
        $$
    \end{proof}
    \begin{corollary}
        Пусть $f_n\colon X\to\mathbb R(\mathbb C)$, $a_k\in\mathbb R$. Тогда, если выполнено
        $$
        \forall k\in\mathbb N~\forall x\in X~|f_k(x)|\leqslant a_k\qquad\sum\limits_{k=1}^\infty a_k<+\infty
        $$
        то $\sum\limits_{k=1}^\infty f_k$ равномерно сходится на $X$.
    \end{corollary}
    \begin{proof}
        Несложно заметить, что $\|f_k\|\leqslant a_k$. В таком случае в силу признака сравнения $\sum\limits_{k=1}^\infty\|f_k\|<+\infty$.
    \end{proof}
    \begin{remark}
        Вообще следствие также называют признаком Вейерштрасса.
    \end{remark}
    \begin{remark}
        В частности, в качестве наименьших возможных $a_k$ подходят $\|f_k\|$.
    \end{remark}
    \begin{example}
        $$\sum\limits_{k=1}^\infty\frac{\cos kx}{k^\alpha}\quad \sum\limits_{k=1}^\infty\frac{\sin kx}{k^\alpha}\quad\alpha>1$$
        равномерно сходятся на $\mathbb R$ так как
        $$
        \left\|\frac{\cos kx}{k^\alpha}\right\|<\frac1{k^\alpha}\quad\left\|\frac{\sin kx}{k^\alpha}\right\|<\frac1{k^\alpha}
        $$
        А ряд $\sum\limits_{k=1}^\infty\frac1{k^\alpha}$, как известно, сходится.
    \end{example}
    \begin{definition}
        Сходимость по \hyperref[Признак Вейерштрасса]{признаку Вейерштрасса} называется \textbf{мажорированной} или \textbf{мажорантной}.
    \end{definition}
    \begin{definition}
        Говорят, что ряд \textbf{абсолютно сходится}, если сходится ряд его норм.
    \end{definition}
    \begin{remark}
        В условиях \hyperref[Признак Вейерштрасса]{признака Вейерштрасса} ряд $\sum\limits f_k$ сходится абсолютно, и даже $\sum\limits|f_k|$ сходится равномерно.
    \end{remark}
    \begin{claim}
        Абсолютная сходимость не влечёт равномерной, а равномерная~--- абсолютной.
    \end{claim}
    \begin{proof}
        Для доказательства первого можно взять уже известный нам ряд $\sum\limits_{k=0}^\infty x^k$, а для доказательства второго~--- $\sum\limits_{k=1}^\infty\frac{(-1)^n}k$.
    \end{proof}
    \begin{claim}
        Более того, существует \hyperref[Равномерно абсолютно сходящийся ряд с неравномерно сходящимися модулями]{ряд}, сходящийся равномерно, абсолютно, но такой, что ряд из модулей сходится неравномерно.\\
        Также существует \hyperref[Положительный равномерно немажорируемо сходящийся ряд]{ряд}, сходящийся равномерно, абсолютно, с равномерно сходящимися модулями, но при этом сам ряд сходится не мажорируемо.
    \end{claim}
    \begin{claim}[Ряды в нормированных пространствах]
        В полном нормированном пространстве $X$ всякий абсолютно сходящийся ряд сходится.
    \end{claim}
    \begin{definition}
        Для подобных (полных нормированных пространств) существует название: \textbf{банахово пространство}.
    \end{definition}
    \begin{proof}
        Доказательство аналогично такому в \hyperref[Признак Вейерштрасса]{признаке Вейерштрасса}.
    \end{proof}
    \begin{claim}
        Пусть $f_n\colon X\to Y$, где $Y$~--- нормированное пространство. Определения равномерной сходимости и равномерной нормы остаются прежними (кроме замены модуля на $\|\cdot\|_Y$). Тогда, если $Y$ полно, все доказанные теоремы остаются верными.
    \end{claim}
    \begin{claim}
        Если вместо функциональной последовательности взять функциональное семейство $\{f_t\}_{t\in T}$ и $t_0\in T$~--- предельная точка, то, очевидно
        $$
        f_t\underset{t\to t_0}\toto f\text{ на }X\Leftrightarrow\sum\limits_{x\in X}|f_t(x)-f(x)|\underset{t\to t_0}\longrightarrow0
        $$
    \end{claim}
    \begin{definition}
        Последовательность $\{f_n\}$, $f_n\colon X\to\mathbb R(\mathbb C)$ называется равномерно ограниченной, если
        $$
        \exists K\in(0;+\infty)~\forall n\in\mathbb N~\forall x\in X~|f_n(x)|\leqslant K
        $$
        или, равносильно
        $$
        \exists K\in(0;+\infty)~\forall n\in\mathbb N~\|f_n\|\leqslant K
        $$
    \end{definition}
    \begin{remark}
        И является это преобразование по сути своей дискретным вариантом интегрирования по частям.
    \end{remark}
    \begin{lemma}[Преобразование Абеля]
        Пусть $a_k,b_k\in\mathbb R(\mathbb C)$, $A_k=\sum\limits_{j=1}^ka_j+A_0$, $n,m\in\mathbb Z_+$, $n<m$. Тогда
        $$
        \sum\limits_{k=n+1}^ma_kb_k=A_mb_m-A_nb_{n+1}+\sum\limits_{k=n+1}^{m-1}A_k(b_k-b_{k+1})
        $$
        Пусть вдобавок $b_k\in\mathbb R$, $\{b_k\}$ монотонна. Тогда
        $$
        \left|\sum\limits_{k=n+1}^m a_kb_k\right|\leqslant4\max\limits_{n\leqslant k\leqslant m}|A_k|\max\{|b_{n+1}|;|b_m|\}
        $$
    \end{lemma}
    \begin{proof}
        Первое утверждение:
        \[\begin{split}
            \sum\limits_{k=n+1}^ma_kb_k&=\sum\limits_{k=n+1}^m(A_k-A_{k-1})b_k=\sum\limits_{k=n+1}^mA_kb_k-\sum\limits_{k=n+1}^mA_{k-1}b_k=\sum\limits_{k=n+1}^mA_kb_k-\sum\limits_{k=n}^{m-1}A_kb_k=\\&=A_mb_m-A_nb_{n+1}+\sum\limits_{k=n+1}^{m-1}A_k(b_k-b_{k+1})
        \end{split}\]
        Второе утверждение:
        \[\begin{split}
            \left|\sum\limits_{k=n+1}^m a_kb_k\right|&\leqslant |A_mb_m|+|A_nb_{n+1}|+\sum\limits_{k=n+1}^{m-1}|A_k||b_k-b_{k+1}|\leqslant\\&\leqslant\max\limits_{n\leqslant k\leqslant m}|A_k|\left(|b_m|+|b_{n+1}|+\sum\limits_{k=n+1}^{m-1}|b_k-b_{k+1}|\right)\leqslant\\&\leqslant4\max\limits_{n\leqslant k\leqslant m}|A_k|\max\{|b_{n+1}|;|b_m|\}
        \end{split}\]
    \end{proof}
    \begin{theorem}[Признаки Дирихле и Абеля равномерной сходимости рядов]
        Пусть $f_k\colon X\to\mathbb R(\mathbb C)$, $g_k\colon X\to\mathbb R$, $\forall x\in X~\{g_k(x)\}_{k=1}^\infty$ монотонна.
        \begin{itemize}
            \item[Дирихле] Если $F_n=\sum\limits_{k=1}^nf_n$, $\{F_n\}$ равномерно ограничена на $X$, $g\toto0$ на $X$, то $\sum\limits_{k=1}^\infty f_kg_k$ равномерно сходится на $X$.
            \item[Абель] Если $\sum\limits_{k=1}^\infty f_k$ равномерно сходится на $X$, $\{g_n\}$ равномерно ограничена на $X$, то выполнено то же самое.
        \end{itemize}
    \end{theorem}
    \begin{remark}
        Признаки сходимости числовых рядов следуют из этого.
    \end{remark}
    \begin{proof}[Доказательство признака Дирихле]
        Пусть $A_0=0$. Тогда $A_k=F_k(x)$. Как известно,
        $$
        \left\|\sum\limits_{k=n+1}^mf_k(x)g_k(x)\right\|\leqslant4\max\limits_{n\leqslant k\leqslant m}|F_k(x)|\max\{|g_{n+1}(x)|;g_m(x)\}
        $$
        Первое условие признака Дирихле выглядит так:
        $$
        \exists K>0~\forall k\in\mathbb N~\forall x\in X~|F_k(x)|\leqslant K
        $$
        Выберем $\eps>0$. По второму условию признака подберём такое $N$, что
        $$
        \forall n>N~\forall x\in X~|f_n(x)|<\frac\eps{4K}
        $$
        Отсюда
        $$
        \forall n,m>N~\forall x\in X~\left|\sum\limits_{n=1}^mf_k(x)g_k(x)\right|<4K\frac\eps{4K}=\eps
        $$
    \end{proof}
    \begin{proof}[Доказательство признака Абеля]
        Сделаем то же самое, но в качестве $A_0$ возьмём $-\sum\limits_{j=1}^\infty f_j(x)$. Тогда $A_k=-\sum\limits_{j=k+1}^\infty f_j(x)=-R_k(x)$. Тогда из второго условия признака Абеля
        $$
        \exists L>0~\forall k\in\mathbb N~\forall x\in X~|g_k(x)|\leqslant L
        $$
        Выберем $\eps>0$. Из первого подберём такое $N$, что
        $$
        \forall k>N~\forall x\in X~|R_k(x)|<\frac\eps{4L}
        $$
        Отсюда то же самое, что и раньше.
    \end{proof}
    \begin{corollary}[Признак Лейбница]
        Пусть $X$~--- множество, $g\colon X\to\mathbb R$, $\forall x\in X~\{g_k(x)\}_{k=1}^\infty$ монотонна, $g_n\toto0$ на $X$. Тогда $\sum\limits_{k=1}^\infty(-1)^{k-1}g_k$ равномерно сходится на $X$
    \end{corollary}
    \begin{proof}
        Следствие признака Дирихле с $f_k(x)=(-1)^k$.
    \end{proof}
    \begin{example}
        $$
        \sum\limits_{k=0}^\infty b_ke^{\im kx}\quad b_k\in\mathbb R,b_k\to0,b_k\text{ убывает}
        $$
        Если $\sum\limits_{k=0}^\infty b_k<+\infty$, то $\sum\limits_{k=0}^\infty b_ke^{\im kx}$ сходится на $\mathbb R$ по Вейерштрассу. (Даже без монотонности $b_k$.)\\
        В противном случае воспользуемся признаком Дирихле для $g_k(x)=b_k$, $f_k=e^{\im kx}$. То что $g_k\toto 0$, очевидно, а равномерную ограниченность частичных сумм $f_k$ надо проверять. Пусть $x\neq2\pi m\mid m\in\mathbb N$. Тогда
        \[\begin{split}
            \sum\limits_{k=0}^ne^{\im kx}&=\sum\limits_{k=0}^n(e^{\im x})^k=\frac{1-e^{\im(n+1)x}}{1-e^{\im x}}
        \end{split}\]
        То есть
        \[\begin{split}
            |F_n(x)|\leqslant\frac2{|1-e^{\im x}|}=\frac2{|e^{\im x/2}||e^{-\im x/2}-e^{\im x/2}|}=\frac2{|\sin\frac x2|}
        \end{split}\]
        Пусть мы рассматриваем сходимость на $[a;b]\subset(2m\pi;2(m+1)\pi)\mid m\in\mathbb N$. Тогда из предыдущего $|F_n(x)|\leqslant\frac1\rho$, где $\rho=\min_{x\in[a;b]}\left|\sin\frac x2\right|>0$, а значит можно применить Дирихле, а значит нужные нам суммы равномерно сходятся на $[a;b]$. Но, вообще говоря, не на $(2m\pi;2(m+1)\pi)$.\\
        А на подобном интервале надо применить утверждение ниже. Если бы на нём была бы равномерная сходимость, то была бы равномерная сходимость на $[2m\pi;2(m+1)\pi]$, а это просто не правда, тут он и поточечно не сходится.
    \end{example}
    \begin{claim}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $f_n\in C(\overline D)$, $\{f_n\}$ равномерно сходится на $D$. Тогда $\{f_n\}$ равномерно сходится на $\overline D$. Аналогично для рядов.
    \end{claim}
    \begin{proof}
        $$\forall\eps>0~\exists N~\forall n,l>N~\forall x\in D~|f_n(x)-f_l(x)|<\eps$$
        Тогда рассмотрим осталось рассмотреть, что с $x_0\in\overline D$. Ну, по определению $\overline D$, $\exists\{x_\nu\}\subset D:x_\nu\to x_0$. По написанному выше $|f_n(x_\nu)-f_l(x_\nu)|<\eps$, а значит, устремив $\nu\to\infty$, получим $|f_n(x_0)-f_l(x_0)|\leqslant\eps$, что не совсем то, что нам надо, но тоже сойдёт.
    \end{proof}
    \begin{example}
        Равномерно ли сходится $\sum\limits_{k=1}^\infty\frac1{k^x}$ на $(1;+\infty)$. Разумеется, нет, в единице он расходится. На любом луче $[\alpha;+\infty]\mid\alpha>1$ вполне себе равномерно сходится по Вейерштрассу.
    \end{example}
    \begin{example}
        \label{Равномерно абсолютно сходящийся ряд с неравномерно сходящимися модулями}
        $\sum\limits_{k=1}^\infty\frac{(-1)^k}kx^k$ на $[0;1)$ сходится равномерно по Абелю:
        $$
        f_k(x)=\frac{(-1)^k}k\qquad g_k(x)=x^k
        $$
        С другой же стороны, $\sum\limits_{k=1}^\infty\left|\frac{(-1)^k}kx^k\right|=\sum\limits_{k=1}^\infty\frac{x^k}k$ равномерно на $[0;1)$ не сходится (иначе должен сходиться в единице).\\
        Вот он, равномерно абсолютно сходящийся ряд с неравномерно сходящимися модулями.
    \end{example}
    \begin{example}
        \label{Положительный равномерно немажорируемо сходящийся ряд}
        $$
        \sum\limits_{k=2}^\infty\frac x{1+(xk\ln k)^2}\quad x\in\mathbb R_+
        $$
        Обозначим $k\ln k$ за $A$, а $Ax$ обозначим за $t$. Несложно заметить, что $t>0$. Тогда
        $$
        \frac x{1+(xk\ln k)^2}=\frac x{1+(Ax)^2}=\frac1A\frac{Ax}{1+(Ax)^2}=\frac1A\frac{t}{1+t^2}
        $$
        Нам, как известно, нужно найти супремум (супремум~--- лучшая мажорантная оценка), а для этого возьмём производную $\frac{t}{1+t^2}$:
        $$
        \left(\frac{t}{1+t^2}\right)'=\frac{1+t^2-2t^2}{(1+t^2)^2}=\frac{1-t^2}{(1+t^2)^2}
        $$
        Нулю это равно в $t=1$ ($t>0$, напомню), а значит в этой точке достигается экстремум. Несложно проверить, что это минимум, а значит
        $$
        \frac x{1+(xk\ln k)^2}=\frac1A\frac{t}{1+t^2}\leqslant\frac1A\frac{1}{1+1^2}=\frac1{2A}
        $$
        Также значение $\frac1{2A}$ достигается (в $x=\frac1A$, очевидно), а значит это и есть супремум. То есть
        $$
        \sup\limits_{x\geqslant0}\frac x{1+(xk\ln k)^2}=\frac1{2k\ln k}
        $$
        Но есть один нюанс:
        $$
        \sum\limits_{k=2}^\infty\frac1{2k\ln k}=+\infty
        $$
        То есть расходится ряд и мажорант, а значит ряд, если и сходится, то не мажорируемо.\\
        Теперь почему же он сходится? А давайте оценим остаток чем-то, что, как мы впоследствие узнаем, стремится к нулю. А именно оценим интегралом:
        $$
        \sum\limits_{k=n+1}^\infty\frac x{1+(xk\ln k)^2}\leqslant\int\limits_n^{+\infty}\frac x{1+(xt\ln t)^2}~\mathrm dt\leqslant\int\limits_n^{+\infty}\frac x{1+(xt\ln n)^2}~\mathrm dt=\frac{\atan(xt\ln n)}{\ln n}\Big|_{t=n}^{+\infty}\leqslant\frac\pi{2\ln n}\underset{n\to\infty}\longrightarrow0
        $$
        То есть ряд сходится (на $\mathbb R_+$), да ещё и равномерно. А поскольку это положительный ряд, то ещё и абсолютно, и его модули сходятся равномерно. Но не сходится мажорантно.
    \end{example}
    \section{Приложения равномерной сходимости.}
    \begin{remark}
        Задача была поставлена выше: хочется узнавать свойства функции, равной пределу функционального ряда.
    \end{remark}
    \begin{theorem}[Перестановка пределов]
        \label{Перестановка пределов}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0$~--- предельная точка $D$, $f_n,f\colon D\to\mathbb R(\mathbb C)$.\\
        Пусть $f_n\toto f$ на $D$ и $\forall n\in\mathbb N~\exists\lim\limits_{x\to x_0}f_n(x)=A_n\in\mathbb R(\mathbb C)$.\\
        Тогда $\lim\limits_{n\to\infty}A_n$ и $\lim\limits_{x\to x_0}f(x)$ оба существуют и равны. Равенство также можно записать как
        $$
        \lim\limits_{n\to\infty}\lim\limits_{x\to x_0}f_n(x)=\lim\limits_{x\to x_0}\lim\limits_{n\to\infty}f_n(x)
        $$
    \end{theorem}
    \begin{proof}
        Сначала докажем, что первый предел существует и конечен. Нам известно, что
        Выберем $\eps>0$ и подберём для него такое $N$, что
        $$
        \forall n,m>N~\forall x\in D~|f_n(x)-f_m(x)|<\eps
        $$
        Если в последнем неравенстве устремить $x$ к $x_0$, получим, что 
        $$
        \forall n,m>N~|A_n-A_m|<\eps
        $$
        А из этого следует существование предела $\lim\limits_{n\to\infty}A_n$, назовём его $A$.\\
        Теперь нам осталось доказать, что $\lim\limits_{x\to x_0}f(x)=A$. Зафиксируем $\eps>0$. Из равномерной сходимости знаем следующее:
        $$
        \exists L~\forall l>L~\forall x\in D~|f_l(x)-f(x)|<\frac\eps3
        $$
        Также из определения $A$
        $$
        \exists K~\forall k>K~|A_k-A|<\frac\eps3
        $$
        Тогда, если взять $M=\max\{K;L\}$, то
        $$
        |f(x)-A|\leqslant|f(x)-f_M(x)|+|f_M(x)-A_M|+|A_M-A|
        $$
        Первое и третье меньше $\frac\eps3$, осталось что-то сделать со вторым. Ну, а с ним всё легко, ведь существует окрестность $\dot{V}_{x_0}$, в которой $\forall x\in \dot{V}_{x_0}\cap D~|f_M(x)-A_M|<\frac\eps3$. Эта же окрестность подойдёт тут.
    \end{proof}
    \begin{theorem}[Перестановка пределов для рядов]
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0$~--- предельная точка $D$, $f_k\colon D\to\mathbb R(\mathbb C)$.\\
        Пусть $\sum\limits_{k=1}^\infty f_k$ равномерно сходится к $S$ на $D$ и $\forall k\in\mathbb N~\exists\lim\limits_{x\to x_0}f_k(x)=a_k\in\mathbb R(\mathbb C)$.\\
        Тогда $\sum\limits_{k=1}^\infty a_k$ сходится и $\exists\lim\limits_{x\to x_0}S(x)$, а также $\lim\limits_{x\to x_0}S(x)=\sum\limits_{k=1}^\infty a_k$. Равенство можно записать как
        $$
        \lim\limits_{x\to x_0}\sum\limits_{k=1}^\infty f_n(x)=\sum\limits_{k=1}^\infty\lim\limits_{x\to x_0}f_n(x)
        $$
    \end{theorem}
    \begin{proof}
        Примените предыдущую теорему к последовательности частичных сумм.
    \end{proof}
    \begin{remark}
        Напоминание: фраза <<$x_0$~--- предельная точка $D$>> не имеет противоречий с бесконечно удалённой точкой ($\infty$ или $\pm\infty$ для $\mathbb R$). (Именно поэтому, кстати, доказательство велось на языке окрестностей.)
    \end{remark}
    \begin{corollary}[Непрерывность предельной функции в точке]
        \label{Непрерывность предельной функции в точке}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0\in D$, $f_n,f\colon D\to\mathbb R(\mathbb C)$.\\
        Пусть $f_n\toto f$ на $D$ и $\forall n\in\mathbb N~f_n$ непрерывна в $x_0$.\\
        Тогда $f$ непрерывна в $x_0$.
    \end{corollary}
    \begin{corollary}[Непрерывность суммы ряда в точке]
        \label{Непрерывность cуммы ряда в точке}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0\in D$, $f_k\colon D\to\mathbb R(\mathbb C)$.\\
        $\sum\limits_{k=1}^\infty f_k$ равномерно сходится к $S$ на $D$ и $\forall k\in\mathbb N~f_k$ непрерывна в $x_0$.\\
        Тогда $S$ непрерывна в $x_0$.
    \end{corollary}
    \begin{corollary}[Непрерывность предельной функции на множестве]
        \label{Непрерывность предельной функции на множестве}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0\in D$, $f_n,f\colon D\to\mathbb R(\mathbb C)$.\\
        Пусть $f_n\toto f$ на $D$ и $\forall n\in\mathbb N~f_n\in C(D)$.\\
        Тогда $f\in C(D)$.
    \end{corollary}
    \begin{corollary}[Непрерывность суммы ряда на множестве]
        \label{Непрерывность суммы ряда на множестве}
        Пусть $X$~--- метрическое пространство, $D\subset X$, $x_0\in D$, $f_k\colon D\to\mathbb R(\mathbb C)$.\\
        $\sum\limits_{k=1}^\infty f_k$ равномерно сходится к $S$ на $D$ и $\forall k\in\mathbb N~f_k\in C(D)$.\\
        Тогда $S\in C(D)$.
    \end{corollary}
    \begin{remark}
        Все следствия суммарно называют теоремой \textbf{Стокса~--- Зейделя}.
    \end{remark}
    \begin{claim}[Равномерная непрерывность предельной функции/суммы ряда]
        В следствиях \ref{Непрерывность предельной функции на множестве} и \ref{Непрерывность суммы ряда на множестве} поточечную сходимость можно заменить на равномерную.
    \end{claim}
    \begin{proof}
        Замените конец доказательства теоремы \ref{Перестановка пределов} на
        $$
        \exists\delta>0~\forall x,x_0\in D:\rho(x,x_0)<\delta~|f_M(x)-f_M(x_0)|<\frac\eps3
        $$
    \end{proof}
    \begin{theorem}
        \label{Полнота C(K)}
        Пространство $C(K)$ полно.
    \end{theorem}
    \begin{proof}
        Пусть нам дана сходящаяся в себе последовательность $\{f_n\}\subset C(K)$. А пространстве $C(K)$ это значит она равномерно сходится в себе. А тогда по \hyperref[Б-К для функциональных последовательностей]{критерию Больцано~--- Коши} она равномерно сходится к некоторой функции $f$, которая, по теореме Стокса~--- Зейделя, непрерывна.
    \end{proof}
    \begin{lemma}
        Пусть $X$~--- полное метрическое пространство, $X_0$ замкнуто в $X$. Тогда $X_0$ полно.
    \end{lemma}
    \begin{proof}
        Рассмотрим сходящуюся в себе последовательность $\{x_n\}\subset X_0$. Рассмотрев её как $\{x_n\}\subset X$, получим, что по полноте $X$ она сходится. А по замкнутости $X_0$ $\lim\limits_{n\to\infty}x_n\in X_0$, то есть в $X_0$ последовательность тоже сходится.
    \end{proof}
    \begin{remark}
        Альтернативным доказательством теоремы \ref{Полнота C(K)} могло бы быть следующее рассуждение:\\
        $l_\infty$ полно, а $C(K)$ замкнуто в $l_\infty$.
    \end{remark}
    \begin{remark}
        Теоремы \ref{Перестановка пределов} и \ref{Полнота C(K)} вместо со следствиями и замечаниями верны для произвольных отображений со значениями в \textbf{полном} нормированном пространстве.
    \end{remark}
    \begin{example}
        В теореме \ref{Перестановка пределов} равномерная сходимость существенна:
        $$
        \lim\limits_{x\to 1-}\lim\limits_{n\to\infty}x^n=0
        $$
        $$
        \lim\limits_{n\to\infty}\lim\limits_{x\to 1-}x^n=1
        $$
    \end{example}
    \begin{example}
        Равномерная сходимость является достаточной, но отнюдь не необходимой.
        $$
        f_n(x)=\sqrt nx(1-x^2)^n\quad x\in[0;1]
        $$
        Поточечный предел этого чуда равен тождественному нулю. Равномерной же сходимости нет, потому что
        $$
        \|f_n\|\geqslant f_n\left(\frac1{\sqrt n}\right)=\left(1-\frac1n\right)^n\to\frac1e\neq0
        $$
        Но, тем не менее, предела функций непрерывен
    \end{example}
    \begin{remark}
        Возникает резонный вопрос: а что там с необходимым и достаточным условием для сохранения непрерывности? Эту задачу решили, но критерий там совершенно не удобен, поэтому им не пользуются. Если вам зачем-то интересно, почитайте второй том Фихтенгольца, там это есть.
    \end{remark}
    \begin{remark}
        Непрерывность~--- свойство локальное. Поэтому в следствиях \ref{Непрерывность предельной функции в точке} и \ref{Непрерывность cуммы ряда в точке} нам достаточно проверить равномерную сходимость не на всём множестве $D$, а в некоторой окрестности $x_0$, а в следствиях \ref{Непрерывность предельной функции на множестве} и \ref{Непрерывность суммы ряда на множестве} достаточно равномерной сходимости в окрестности каждой точки $D$. Это формально более слабое свойство, нежели на всём $D$, но мы пока не понимаем, почему это существенно. Впрочем, ещё поймём.
    \end{remark}
    \begin{theorem}[Теорема Дини для последовательностей]
        Пусть $K$~--- компакт, $f_n\in C(K\to\mathbb R)$, $f_n\leqslant f_{n+1}$, $\lim\limits_{n\to\infty}f_n\in C(K)$. Тогда $f_n$ равномерно сходится.
    \end{theorem}
    \begin{theorem}[Теорема Дини для рядов]
        Пусть $K$~--- компакт, $f_k\in C(K)$, $f_k\geqslant0$, $\sum\limits_{k=1}^\infty f_k$ сходится на $K$ к непрерывной функции. Тогда $\sum\limits_{k=1}^\infty f_k$ равномерно сходится.
    \end{theorem}
    \begin{proof}
        Без доказательства. Желающие могут почитать второй том Фихтенгольца.
    \end{proof}
    \begin{theorem}[Равномерная сходимость и предельный переход под знаком интеграла]
        \label{Предельный переход под знаком интеграла}
        Пусть $f_n\in C[a;b]$, $f_n\toto f$ на $[a;b]$. Тогда
        $$
        \int\limits_a^bf_n\underset{n\to\infty}\longrightarrow\int\limits_a^bf
        $$
        Или
        $$
        \lim\limits_{n\to\infty}\int\limits_a^bf_n=\int\limits_a^b\lim\limits_{n\to\infty}f_n
        $$
    \end{theorem}
    \begin{proof}
        Для начала, по теореме Стокса~---Зейделя $\int\limits_a^bf$ имеет смысл.\\
        Теперь рассмотрим $\eps>0$ и подберём такое $N$, что $\forall n>N~\forall x\in[a;b]~|f_n(x)-f(x)|<\frac\eps{b-a}$. Тогда
        $$
        \left|\int\limits_a^bf_n-\int\limits_a^bf\right|=\left|\int\limits_a^b(f_n-f)\right|\leqslant\int\limits_a^b|f_n-f|<\eps
        $$
    \end{proof}
    \begin{theorem}[Почленное интегрирование равномерно сходящихся рядов]
        \label{Интегрирование равномерно сходящихся рядов}
        Пусть $f_k\in C[a;b]$, ряд $\sum\limits_{k=1}^\infty f_k$ равномерно сходится на $[a;b]$. Тогда
        $$
        \sum\limits_{k=1}^\infty\int\limits_a^bf_k=\int\limits_a^b\sum\limits_{k=1}^\infty f_k
        $$
    \end{theorem}
    \begin{proof}
        Примените предыдущее.
    \end{proof}
    \begin{remark}
        Вообще говоря теоремы \ref{Предельный переход под знаком интеграла} и \ref{Интегрирование равномерно сходящихся рядов} верны и для $f_n\in R[a;b]$. Для доказательства этого нужно узнать свойство, аналогичное теореме Стокса~--- Зейделя, но для интегрируемости. Его проще всего доказать, используя критерий Лебега.
    \end{remark}
    \begin{remark}
        Иногда возникает необходимость делать предельный переход под знаком интеграла даже когда равномерной сходимости нет, но тут нам нужно узнать про интегрируемость по мере, чтобы изучить, когда так можно.
    \end{remark}
    \begin{example}
        Равномерная сходимость существенна для \hyperref[Предельный переход под знаком интеграла]{предельного перехода под знаком интеграла}.
        $$
        f_n(x)=n^2x(1-x^2)^n\quad x\in[0;1]
        $$
        Как мы знаем, $f_n\to0$ и $f_n\not\toto0$. Тогда давайте посчитаем интеграл:
        $$
        \int\limits_0^1n^2x(1-x^2)^n~\mathrm dx=n^2\int\limits_0^1x(1-x^2)^n~\mathrm dx=n^2\frac{(1-x^2)^{n+1}}{(-2)(n+1)}\Bigg|_0^1=\frac{n^2}{2(n+1)}\to\infty
        $$
        Тут ряд интегралов расходится.\\
        А может и сходится:
        $$
        f_n(x)=nx(1-x^2)^n\quad x\in[0;1]
        $$
        Тут сходится к $\frac12$.
    \end{example}
    \begin{example}
        Впрочем, тут также равномерной сходимости может быть много. Да что там, поточечной тоже
        $$
        \int\limits_0^1\sum\limits_{k=0}^\infty(-1)^kx^k~\mathrm dx=\int\limits_0^1\frac{\mathrm dx}{1+x}=\ln2
        $$
        В то же время
        $$
        \sum\limits_{k=0}^\infty\int\limits_0^1(-1)^kx^k~\mathrm dx=\sum\limits_{k=0}^\infty\frac{(-1)^k}{k+1}=\ln2
        $$
        А ряд расходится в $x=1$.
    \end{example}
    \begin{theorem}[Предельный переход под знаком производной]
        Пусть $E$~--- ограниченный промежуток. Пусть $f_n,\varphi\colon R\to\mathbb R$, $f_n$ дифференцируемы на $E$ и $f'_n\toto\varphi$ на $E$. Пусть $\exists c\in E~\{f_n(c)\}$ сходится.\\
        Тогда выполнено следующее:
        \begin{enumerate}
            \item $f_n$ равномерно сходится на $E$ (к некоторой функции $f$).
            \item $f$ дифференцируема на $E$.
            \item $f'=\varphi$.
        \end{enumerate}
        Последнее равенство можно переписать так:
        $$
        \left(\lim\limits_{n\to\infty}f_n\right)'=\lim\limits_{n\to\infty}f'_n
        $$
    \end{theorem}
    \begin{theorem}[Почленное дифференцирование рядов]
        Пусть $E$~--- ограниченный промежуток. Пусть $f_k\colon R\to\mathbb R$, $f_k$ дифференцируемы на $E$ и $\sum\limits_{k=1}^\infty f'_k$ равномерно сходится на $E$. Пусть $\exists c\in E~\sum\limits_{k=1}^\infty f_k(c)$ сходится.\\
        Тогда выполнено следующее:
        \begin{enumerate}
            \item $\sum\limits_{k=1}^\infty f_k$ равномерно сходится на $E$ к некоторой функции $S$.
            \item $S$ дифференцируема на $E$.
            \item $S'=\sum\limits_{k=1}^\infty f'_k$.
        \end{enumerate}
        Последнее равенство можно переписать так:
        $$
        \left(\sum\limits_{k=1}^\infty f_k\right)'=\sum\limits_{k=1}^\infty f'_k
        $$
    \end{theorem}
    \begin{proof}
        Как обычно, докажем для последовательностей, для рядов получим из частных сумм.\\
        Давайте рассмотрим $x_0\in E$ и введём последовательность функций $g_n(x)=\frac{f_n(x)-f_n(x_0)}{x-x_0}\mid x\in E\setminus\{x_0\}$.\\
        Докажем, что $\{g_n\}$ равномерно сходится в себе:
        $$
            g_n(x)-g_l(x)=\frac{(f_n-f_l)(x)-(f_n-f_l)(x_0)}{x-x_0}\overset{\text{Формула Лагранжа}}=(f_n-f_l)'(t)=(f'_n-f'_l)(t)
        $$
        То есть
        $$
        \|g_n(x)-g_l(x)\|_{E\setminus\{x_0\}}=\|f'_n-f'_l\|_{E}\underset{n,l\to0}\longrightarrow0
        $$
        $\{g_n\}$ действительно равномерно сходится в себе (на $E\setminus\{x_0\}$), а значит равномерно сходится.\\
        А нам-то хочется равномерной сходимости $\{f_n\}$. Ну так пусть $x_0=c$. Тогда
        $$
        g(x)=\frac{f_n(x)-f_n(c)}{x-c}\Rightarrow f_n(x)=(x-c)g_n(x)+f_n(c)
        $$
        Известно, что $g_n(x)$ равномерно сходится на $E\setminus\{c\}$, эту равномерную сходимость \hyperref[Произведение равномерно сходящейся на ограниченную]{не нарушает} умножение на ограниченную функцию $x-c$, а значит $(x-c)g_n(x)$ равномерно сходится на $E\setminus\{c\}$, более того равномерно сходится на $E$, ведь в точке $c$ эта функция равна нулю. Хорошо, то есть $f_n(x)$~--- сумма двух равномерно сходящихся функций.\\
        О'кей, теперь перейдём ко второму и третему пункту, про дифференцируемость $f$. Известно, что $g_n$ равномерно сходится. Только теперь мы уже знаем, к чему:
        $$
        \frac{f_n(x)-f_n(x_0)}{x-x_0}\underset{n\to\infty}\toto\frac{f(x)-f(x_0)}{x-x_0}
        $$
        А теперь мы можем воспользоваться теоремой \ref{Перестановка пределов}. Мы знаем, что
        $$
        \frac{f_n(x)-f_n(x_0)}{x-x_0}\underset{x\to x_0}\longrightarrow f'_n(x_0)\underset{n\to\infty}\longrightarrow\varphi(x_0)
        $$
        Ну, значит и $\frac{f(x)-f(x_0)}{x-x_0}\underset{n\to\infty}\longrightarrow\varphi(x_0)$. Существует и равно.
    \end{proof}
    \begin{remark}
        Вопрос на внимательность: где тут ограниченность $E$? В том, что $x-c$ ограничено. Поэтому даже без ограниченности пункты 2 и 3 верны, а пункт 1 остаётся верным на любом ограниченном интервале, лежащем в $E$.
    \end{remark}
    \begin{example}
        $$
        \sum\limits_{k=1}^\infty1\text{ расходится}\quad\sum\limits_{k=1}^\infty1'=\sum\limits_{k=1}^\infty0\text{ равномерно сходится}
        $$
        Это то, зачем нужно $\exists c\in E~\sum\limits_{k=1}^\infty f_k(c)$.
    \end{example}
    \begin{example}
        $$
        f_n(x)=\frac{\sin nx}n\quad x\in\mathbb R
        $$
        Поскольку $\|f_n\|=\frac1n$, $f_n\toto0$. Однако, $f_n(x)=\cos nx$, что расходится почти везде. Поэтому равномерной сходимости самих функций не достаточно: последовательность производных может расходиться (как тут), а может и сходиться не туда:
        $$
        f_n(x)=\frac{x^{n+1}}{n+1}\quad x\in[0;1]
        $$
        $\|f_n\|=\frac1{n+1}$, потому $f_n\toto0$. Однако
        $$
        f'_n(x)=x^n\rightarrow\begin{cases}
            1 & x=1\\
            0 & x\in[0;1)
        \end{cases}\neq0'
        $$
    \end{example}
    \begin{example}
        Непрерывная нигде не дифференцируемая функция.\\
        Начнём вот с такой функции:
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                        width = 12cm,
                        height = 5cm,
                        grid = none,
                        xmin = -2,
                        xmax = 2,
                        ymin = -.1,
                        ymax = .9,
                        axis equal,
                        axis x line = middle,
                        axis y line = middle,
                        axis line style = {->},
                    ]
                    \draw (axis cs:-2,0) -- (axis cs:-1.5,.5) -- (axis cs:-1,0) -- (axis cs:-.5,.5) -- (axis cs:0,0) -- (axis cs:.5,.5) -- (axis cs:1,0) -- (axis cs:1.5,.5) -- (axis cs:2,0);
                \end{axis}
            \end{tikzpicture}
        \end{figure}\noindent
        $$
        f_0(x)=\begin{cases}
            x & x\in\left[0;\frac12\right]\\
            1-x & x\in\left(\frac12;1\right]
        \end{cases}\quad\text{В остальных точках }\pi\text{-периодична}
        $$
        Теперь давайте возьмём $f_k(x)=\frac1{4^k}f_0(4^kx)$. Вот рисунок $f_1$ под $f_0$:
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 12cm,
                    height = 5cm,
                    grid = none,
                    xmin = -2,
                    xmax = 2,
                    ymin = -.1,
                    ymax = .9,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    ]
                    \draw (axis cs:-2,0) -- (axis cs:-1.5,.5) -- (axis cs:-1,0) -- (axis cs:-.5,.5) -- (axis cs:0,0) -- (axis cs:.5,.5) -- (axis cs:1,0) -- (axis cs:1.5,.5) -- (axis cs:2,0);
                    \pgfplotsinvokeforeach{-2,-1,0,1}{
                        \draw (axis cs:#1,0) -- (axis cs:#1+1/8,1/8) -- (axis cs:#1+2/8,0) -- (axis cs:#1+3/8,1/8) -- (axis cs:#1+4/8,0) -- (axis cs:#1+5/8,1/8) -- (axis cs:#1+6/8,0) -- (axis cs:#1+7/8,1/8) -- (axis cs:#1+1,0);
                    }
                \end{axis}
            \end{tikzpicture}
        \end{figure}\noindent
        Искомая функция равна $f=\sum\limits_{k=0}^\infty f_k$. Для начала докажем, что эта сумма равномерно сходится:
        $$
        \|f_k\|_{\mathbb R}=\frac1{2\cdot 4^k}\text{ отсюда }\sum\limits_{k=0}^\infty\|f_k\|<+\infty
        $$
        Что по \hyperref[Признак Вейерштрасса]{признаку Вейерштрасса} значит, что $\sum\limits_{k=0}^\infty f_k$ равномерно сходится на $\mathbb R$. А отсюда $f$ непрерывна.\\
        Осталось доказать её недифференцируемость ни в одной точке. Рассмотрим $a\in\mathbb R$. Заметим, что
        $$
        \forall n\in\mathbb Z~\exists q_n\in\mathbb Z~a\in\left[\frac{q_n-1}{2\cdot 4^n};\frac{q_n}{2\cdot 4^n}\right]=\Delta_n
        $$
        Почему такой отрезок бывает? Ну, очевидно, они все вместе покрывают всю прямую, а значит в каком-то любая точка лежит (может, лежит в двух, возьмём любой).\\
        Заметим, что $|\Delta_n|=\frac1{2\cdot 4^n}$. Тогда $\exists x_n\in\Delta_n~|x_n-a|=\frac1{4^{n+1}}$. Так вот
        $$
        \frac{f(x_n)-f(a)}{x_n-a}=\sum\limits_{k=0}^\infty\frac{f(x_k)-f(a)}{x_k-a}\underset{\text{и }|x_n-a|=\frac1{4^{n+1}}}{\overset{\frac1{4^k}\text{-периодичность}}=}\sum\limits_{k=0}^n\frac{f(x_k)-f(a)}{x_k-a}=\sum\limits_{k=0}^\infty\eps_{kn}=A_n
        $$
        При этом $\eps_{kn}=\pm 1$ ($\Delta_n$~--- промежуток монотонности любой из функций $f_{k\leqslant n}$), а $A_n$ и $A_{n+1}$~--- целые числа разной чётности (мы сложили соотвественно $n$ и $n+1$ нечётных чисел $\eps_{nk}$), а значит предела $\lim A_n$ не бывает. А должен бы бывать, потому что $x_n$~--- последовательность, стремящаяся к $a$, а $A_n$ тогда~--- подпоследовательность последовательности из определения производной.
    \end{example}
    \begin{remark}
        На самом деле тут дело не в том, что мы брали функцию с большим количеством изломов. Ведь на самом деле для любой липшицевой и периодической функции $f_0$ существуют такие достаточно малое $q$ и достаточно большое $Q$, что
        $$
        f(x)=\sum\limits_{k=0}^\infty q^kf_0(Q^kx)
        $$
        непрерывна и нигде не дифференцируема. То есть дело тут не в большом количестве изломов, а в сильном сжатии. Именно оно портит дифференцируемость на самом деле.
    \end{remark}
    \begin{example}
        Кривые Пеано.\\
        Нам хочется построить путь на плоскости, носитель которого~--- квадрат $[0;1]^2$. давайте строить его так: Возьмём квадрат и поделим его на 4 равные части. На этих частях построим вот такую ломаную:
        \begin{figure}[H]
            \begin{tikzpicture}[scale=3]
                \draw[step=.5] (0,0) grid (1,1);
                \draw[very thick] (.25,.25) -- ++(.5,0) -- ++(0,.5) -- ++(-.5,0);
            \end{tikzpicture}
        \end{figure}\noindent
        Это множество значений некоторого пути. Например, давайте наш путь будет таким: на отрезке $\left[0;\frac14\right]$ он будет равномерно обходить нижнюю левую часть квадрата, на отрезке $\left[\frac14;\frac12\right]$~---  правую нижнюю, на $\left[\frac12;\frac34\right]$~--- правую верхнюю, на $\left[\frac34;1\right]$~--- левую верхнюю.\\
        Это было на первом шаге. На втором мы делим каждый квадратик на 4 части и обходим так:
        \begin{figure}[H]
            \begin{tikzpicture}[scale=3]
                \draw[step=.25] (0,0) grid (1,1);
                \newcommand\rd{ -- ++(.25,0)}
                \newcommand\ld{ -- ++(-.25,0)}
                \newcommand\ud{ -- ++(0,.25)}
                \newcommand\dd{ -- ++(0,-.25)}
                \draw[very thick] (.125,.125) \ud\rd\dd\rd\rd\ud\ld\ud\rd\ud\ld\ld\dd\ld\ud;
            \end{tikzpicture}
        \end{figure}\noindent
        И тут мы тоже каждую четверть времени проводим в правильном большом квадрате, но ещё и отрезок $\left[0;\frac14\right]$, например, также делится на 4 части, чтобы в каждой из них пройти нужную часть пути в маленьком квадрате.\\
        Понятно, что так можно умельчать разбиение сколько угодно раз, а знчит это последовательность $\{f_n\}_{n=1}^\infty$. Утверждается, что $f_n$ равномерно сходится в себе. Почему? Пусть $n<m$, тогда оценим $\|f_m-f_n\|$. Ну, на каждом подотрезке $[0;1]$ все значения обеих этих функций располагаются в одном квадрате $n$-ного уровня, а значит
        $$
        \|f_m-f_n\|\leqslant\frac{\sqrt2}{2^n}\underset{m,n\to\infty}\longrightarrow0
        $$
        А значит $f_n$ равномерно сходится к какому-то пределу $f$. $f$, объективно, непрерывное отображение $[0;1]\to[0;1]^2$. То есть, действительно, путь.\\
        Осталось объяснить, что множество значений $f$~--- весь квадрат. Ну, смотрите. Каждая точка $[0;1]$ находится в каком-то квадрате $\frac12\times\frac12$, в каком-то квадрате $\frac14\times\frac14$ и так далее, то есть каждую точку квадрата можно сколь угодно близко приблизить точками $f([0;1])$. Но также из теоремы Вейерштрасса непрерывный образ компакта компакт, а значит замкнутое множество, то есть содержащее все свои предельные точки. Тогда деваться некуда, получается весь квадрат.
    \end{example}
    \begin{remark}
        Функция $f$ всем хороша, кроме того, что она не взаимооднозначна. Если бы мы смогли построить непрерывную биекцию между отрезком и квадратом, у нас бы начались фундаментальные топологические проблемы.
    \end{remark}
    \section{Степенные ряды.}
    \begin{definition}
        Ряд вида
        \begin{equation}
            \label{Степенной ряд}
            \sum\limits_{k=0}^\infty c_k(z-z_0)^k
        \end{equation}
        называется \textbf{степенным рядом}. $z,z_0,c\in\mathbb C$. $z_0$ называется центром, а $c_k$~--- коэффициентами.
    \end{definition}
    \begin{remark}
        В вещественном степенном ряде обозначения обычно $x_0$, $x$ и $a_k$.
    \end{remark}
    \begin{remark}
        Встретившись со степенным рядом, обычно задаются следующими вопросами:
        \begin{itemize}
            \item Какова область сходимости?
            \item Какими свойствами обладает сумма?
        \end{itemize}
        Ещё есть третий вопрос: если есть функция, можно ли разложить её в степенной ряд и как?
    \end{remark}
    \begin{remark}
        При $z=z_0$ ряд сходится к $c_0$.
    \end{remark}
    \begin{definition}
        Величина $R\in[0;+\infty]$ называется радиусом сходимости ряда \ref{Степенной ряд}, если
        $$\begin{aligned}
            &\forall z\in\mathbb C:|z-z_0|<R~\text{ряд \ref{Степенной ряд} сходится}\\
            &\forall z\in\mathbb C:|z-z_0|>R~\text{ряд \ref{Степенной ряд} расходится}\\
        \end{aligned}$$
    \end{definition}
    \begin{lemma}
        Пусть $\{x_n\},\{y_n\}$~--- вещественные последовательности, $\exists\lim x_k\in(0;+\infty)$. Тогда
        $$
        \limsup x_ny_n=\lim x_n\limsup y_n
        $$
    \end{lemma}
    \begin{proof}
        Давайте обозначим пределы буквами:
        $$
        \underbrace{\limsup x_ny_n}_C=\underbrace{\lim x_n}_A\underbrace{\limsup y_n}_B
        $$
        Напоминается: верхний предел~--- наибольший из частичных пределов.\\
        О'кей, $y_{n_k}\to B$, также $x_{n_k}\to A$ (как подпоследовательность сходящейся последовательности), тогда $x_{n_k}y_{n_k}\to AB$, то есть $AB\leqslant C$.\\
        Теперь пусть $x_{m_l}y_{m_l}\to C$. Тогда $x_{m_l}\to A$. Начиная с определённого номера $x_{m_l}$ больше нуля, а значит с этого самого места $y_{m_l}\to \frac CA$, отсюда $\frac CA\leqslant B$.
    \end{proof}
    \begin{theorem}[Формула Коши~--- Адамара]
        \label{Формула Коши-Адамара}
        У любого ряда есть радиус сходимости, равный
        $$
        R=\frac1{\limsup\sqrt[n]{|c_n|}}
        $$
    \end{theorem}
    \begin{proof}
        Что говорил нам признак Коши? Он говорил нам, что ряд расходится, если $\limsup\sqrt[n]{|c_n(z-z_0)^n|}>1$, и абсолютно сходится, если $\limsup\sqrt[n]{|c_n(z-z_0)^n|}<1$. Хорошо:
        $$
        \limsup\sqrt[n]{|c_n(z-z_0)^n|}=\limsup(|z-z_0|\sqrt[n]{|c_n|})=|z-z_0|\limsup\sqrt[n]{|c_n|}
        $$
        Ну, и, тут всё, что нам надо, поскольку $|z-z_0|$~--- это, по сути, радиус.
    \end{proof}
    \begin{definition}
        \textbf{Круг сходимости} степенного ряда~--- $B(z_0;R)=\{z\in\mathbb C\mid|z-z_0|<R\}$.
    \end{definition}
    \begin{remark}
        Итого, мы получили б\'{о}льшую часть ответа на вопрос <<Когда ряд сходится?>> Когда $z\in B(z_0;R)$. Возможно, с какими-то точками на границе круга.
    \end{remark}
    \begin{claim}
        \label{Радиус сходимости по Д'Аламберу}
        Иногда проще посчитать радиус сходимости по признаку Д'Аламбера, а не по Коши:
        $$
        R=\lim\left|\frac{c_n}{c_{n+1}}\right|
        $$
    \end{claim}
    \begin{remark}
        Но этот предел, разумеется, может не существовать. В отличие от верхнего предела из Коши.
    \end{remark}
    \begin{example}
        Примеры о том, что на границе может быть всё, что угодно:
        \begin{multicols}{3}
            $$
            \sum\limits_{k=0}^\infty2^k=\frac1{1-z},|z|<1
            $$
            Тут $R=1$, а при $|z|=1$ ряд расходится.
            \columnbreak
            $$
            \sum\limits_{k=1}^\infty\frac{z^k}{k^2}
            $$
            Тут $R=1$, а в $|z|=1$ ряд абсолютно сходится.
            \columnbreak
            $$
            \sum\limits_{k=1}^\infty\frac{z^k}k
            $$
            Тут $R=1$, а при $z=1$ ряд расходится, а при $|z|=1,z\neq1$~--- сходится по Д'Аламберу (в случае $z=-1$ проще использовать Лейбница).
        \end{multicols}
    \end{example}
    \begin{example}
        Радиус бывает бесконечным:
        $$
        \sum\limits_{k=1}^\infty\frac{z^k}{k!}
        $$
        Для вещественных чисел мы знаем, что это везде сходится, а значит на комплексной плоскости (в силу того, что сходимость должна быть в круге)~--- тоже везде, то есть $R=+\infty$.
    \end{example}
    \begin{example}
        Радиус бывает нулевым:
        $$
        \sum\limits_{k=0}^\infty k!z^k
        $$
        Когда радиус нулевой, кстати, мы знаем про круг сходимости информацию о его границе: его граница~--- это точка $z=z_0$, а в ней, как известно, ряд всегда сходится.
    \end{example}
    \begin{remark}
        Если сделать замену $z-z_0=w$, то получится ряд с центром в нуле, а поскольку сдвиг никак не влияет на непрерывность, дифференцируемость и прочие интересные свойства функций, не умаляя общности очень часть можно считать, что все степенные ряды имеют центр в нуле.
    \end{remark}
    \begin{theorem}[Равномерная сходимость степенных рядов]
        \label{Равномерная сходимость степенных рядов}
        Пусть дан степенной ряд \ref{Степенной ряд} и его радиус сходимости $R\in(0;+\infty]$. Тогда $\forall r\in(0;R)$ ряд \ref{Степенной ряд} равномерно сходится в $\overline B(z_0;r)$.
    \end{theorem}
    \begin{proof}
        Если $|z-z_0|\leqslant r$, то $|c_k(z-z_0)^k|\leqslant |c_k|r^k$, потому что в круге сходимости степенной ряд сходится абсолютно. Тогда из \hyperref[Признак Вейерштрасса]{признака Вейерштрасса} мы получаем то, что нам надо.
    \end{proof}
    \begin{corollary}
        Сумма степенного ряда непрерывна в круге сходимости.
    \end{corollary}
    \begin{proof}
        Пусть $z_1\in B(z_0;r)$. Тогда $\exists r~|z_1-z_0|<r<R$. А поскольку степенной ряд равномерно сходится в $B(z_0;r)$, а значит сумма непрерывна на $B(z_0;r)$, то есть непрерывна в точке $z_1$.
    \end{proof}
    \begin{remark}
        Следствие временное. Ведь скоро мы докажем, что сумма не только непрерывна, а бесконечно дифференцируема.
    \end{remark}
    \begin{theorem}[Теорема Абеля о степенных рядах]
        \label{Теорема Абеля о степенных рядах}
        Пусть $\sum\limits_{k=0}^\infty a_k(x-x_0)^k$~--- вещественный степенно ряд, $R\in(0;+\infty)$~--- его радиус сходимости. Пусть ряд сходится в $x=x_0+R$ (или, симметрично, в $x=x_0-R$). Тогда он сходится равномерно на $[x_0;x_0+R]$ (или, соотвественно, $[x_0;x_0-R]$).\\
        В частности, его сумма непрерывна в $x_0+R$ слева (соответственно, в точке $x_0-R$ справа).
    \end{theorem}
    \begin{remark}
        Это верно и для комплексных рядов, у нас просто нет обозначения для отрезка длины $R$ в случайном направлении.
    \end{remark}
    \begin{proof}
        Не умаляя общности, пусть $x_0=0$. Тогда
        $$
        \sum\limits_{k=0}^\infty a_kR^k\left(\frac xR\right)^k
        $$
        Воспользуемся признаком Абеля:
        $$
        \sum\limits_{k=0}^\infty a_kR^k\qquad\text{равомерно сходится}
        $$
        $$
        0\leqslant\left(\frac xR\right)^{k+1}\leqslant\left(\frac xR\right)^k\leqslant1
        $$
    \end{proof}
    \begin{corollary}[Интегрирование степенных рядов.]
        \label{Интегрирование степенных рядов}
        Пусть $\sum\limits_{k=0}^\infty a_k(x-x_0)^k$~--- вещественный степенной ряд, $R>0$~--- его радиус сходимости. Тогда $\forall[a;b]\subset(x_0-R;x_0+R)$ ряд можно интегрировать по $[a;b]$ почленно.\\
        Если же ряд сходится на каком-нибудь из концов, на отрезке, содержащем этот конец, тоже можно.
    \end{corollary}
    \begin{remark}
        \hyperref[Теорема Абеля о степенных рядах]{Теорему Абеля} иногда называют второй теоремой Абеля. Первой теоремой Абеля считают утверждение, что любой степенной ряд имеет радиус сходимости (без опоры на \hyperref[Формула Коши-Адамара]{формулу Коши~--- Адамара}).
    \end{remark}
    \begin{remark}
        Здесь, также как и в теореме Абеля, вещественность ряда не нужна, просто мы не умеем интегрировать комплексные ряды. Однако скоро научимся.
    \end{remark}
    \begin{claim}
        Посмотрим на формулу:
        $$
        \int\limits_0^x\sum\limits_{k=0}^\infty a_kt^k~\mathrm dt=
        \sum\limits_{k=0}^\infty\frac{x^{k+1}}{k+1}
        $$
        Мы знаем, что она верна в условиях следствия \ref{Интегрирование степенных рядов}.\\
        Но также верно следующее: если $\sum\limits_{k=0}^\infty\frac{R^{k+1}}{k+1}$ сходится, то
        $$
        \int\limits_0^{\to R}\sum\limits_{k=0}^\infty a_kt^k~\mathrm dt=
        \sum\limits_{k=0}^\infty\frac{R^{k+1}}{k+1}
        $$
    \end{claim}
    \begin{proof}
        Из следствия теоремы \ref{Равномерная сходимость степенных рядов} о непрерывности в круге сходимости.
    \end{proof}
    \begin{definition}
        Пусть $f\colon\underset{\subset\mathbb C}D\to\mathbb C$, $z_0\in\Int D$. Если $\exists A\in\mathbb C~f(z)=f(z_0)+A(z-z_0)+o(z-z_0)$, то $f$ называется \textbf{дифференцируемой в точке} $z_0$, а $A$ называется её \textbf{производной в точке} $z_0$.
    \end{definition}
    \begin{claim}
        $$
        f'(z_0)=\lim\limits_{z\to z_0}\frac{f(z)-f(z_0)}{z-z_0}
        $$
    \end{claim}
    \begin{remark}
        Доказывается это также, как и в вещественном случае, и также как там, доказываются дифференцируемость арифметический операций и композиции.
    \end{remark}
    \begin{remark}
        Несмотря на то, что это чудо выглядит как вещественная производная, на самом деле это определение очень сильное (из-за того, что $z$ может стремиться к $z_0$ любым способом). Причём даже сильнее, чем дифференцируемость $f$ как $\mathbb R^2\to\mathbb R^2$ (к определению последней надо ещё одно уравнение (Коши~--- Римана) добавить, чтобы получилось равносильно). И это влечёт интересные эффекты.
    \end{remark}
    \begin{example}
        Давайте сделаем пару примеров дифференцируемых функций.
        $$
        (z^n)'=nz^{n-1}\qquad n\in\mathbb Z
        $$
        Отсюда вытекает непрерывность многочленов и дробно-рациональных функций. А дальше ни композиция, ни арифметические действия не выводят из класса дробно-рациональных функций. Больше так сходу примеров мы не приведём.
    \end{example}
    \begin{lemma}
        Ряды
        $$
        \sum\limits_{k=1}^\infty c_kk(z-z_0)^{k-1}\qquad\sum\limits_{k=0}^\infty c_k(z-z_0)^k\qquad\sum\limits_{k=0}^\infty c_k\frac{(z-z_0)^k}{k+1}
        $$
        имеют одинаковый радиус сходимости.
    \end{lemma}
    \begin{proof}
        Напрямую из \hyperref[Формула Коши-Адамара]{формулы Коши~--- Адамара}.
    \end{proof}
    \begin{theorem}[Дифференцирование степенных рядов]
        \label{Дифференцирование степенных рядов}
        Пусть
        $$f(z)=\sum\limits_{k=0}^\infty c_k(z-z_0)^k\qquad|z-z_0|<R$$
        Тогда $f\in C^{(\infty)}(B(z_0;R))$ и ряд можно дифференцировать почленно любое количество раз:
        $$
        f^{(m)}(z)=\sum\limits_{k=m}^\infty c_kk\cdot(k-1)\cdot\cdots\cdot(k-m+1)(z-z_0)^{k-m}\qquad|z-z_0|<R
        $$
    \end{theorem}
    \begin{proof}
        По предыдущей лемме надо лишь доказать формулу для первой производной. И поскольку сдвиг с производной коммутирует, не уменьшая общности можно считать $z_0=0$. Итого надо проверить, что
        $$
        f'(z)=\sum\limits_{k=m}^\infty c_kkz^{k-1}\qquad|z|<R
        $$
        Ну, что ж, возьмём точку $z_1\in B(0;R)$ и докажем, что в ней есть производная и что она равна тому, чему надо. Очевидно, $\exists\rho~|z_1|<\rho<R$. Что ж.
        $$
        \frac{f(z)-f(z_1)}{z-z_1}=\sum\limits_{k=1}^\infty c_k\frac{z^k-z_1^k}{z-z_1}=\sum\limits_{k=1}^\infty c_k\left(z^{k-1}+z_1z^{k-2}+\cdots+z_1^{k-2}z+z_1^{k-1}\right)
        $$
        Хочется почленно перейти к пределу при $z\to z_1$. Ну,
        $$
        |c_k\left(z^{k-1}+z_1z^{k-2}+\cdots+z_1^{k-2}z+z_1^{k-1}\right)|\leqslant k|c_k|\rho^{k-1}
        $$
        При этом
        $\sum\limits_{k=1}^\infty k|c_k|\rho^{k-1}$ сходится по лемме, а значит сходится равномерно в $B(0;\rho)$. Отсюда $\sum\limits_{k=1}^\infty c_k\frac{z^k-z_1^k}{z-z_1}$ сходится равномерно в $B(0;\rho)\setminus\{z_1\}$. А отсюда по теореме о почленном переходе к пределу
        $$
        \exists\lim_{z\to z_1}\sum\limits_{k=1}^\infty\frac{f(z)-f(z_1)}{z-z_1}=\sum\limits_{k=1}^\infty\lim_{z\to z_1}\frac{f(z)-f(z_1)}{z-z_1}=\sum\limits_{k=1}^\infty kc_kz_1^{k-1}
        $$
        То есть существует $f'(z_1)=\sum\limits_{k=1}^\infty kc_kz_1^{k-1}$.
    \end{proof}
    \begin{theorem}[Единственность разложения в степенной ряд]
        \label{Единственность разложения в степенной ряд}
        Пусть $R\in(0;+\infty]$, пусть
        $$
        f(z)=\sum\limits_{k=0}^\infty c_k(z-z_0)^k\qquad |z-z_0|<R
        $$
        Тогда коэффициенты $c_k$ определяются единственным образом функцией $\frac{f^{(k)}(z_0)}{k!}$.
    \end{theorem}
    \begin{definition}
        Пусть $f$ бесконечно дифференцируема в окрестности $z_0$. Тогда $\frac{f^{(k)}(z_0)}{k!}$ называются \textbf{коэффициентами Тейлора}, а ряд $f(z)=\sum\limits_{k=0}^\infty\frac{f^{(k)}(z_0)}{k!}(z-z_0)^k$~--- её \textbf{рядом Тейлора}.
    \end{definition}
    \begin{proof}
        Очевидно, $\frac{f^{(0)}(z_0)}{0!}=f(z_0)=c_0$. Для остальных подставим $z=z_0$ в формулу для $m$-той производной. Очевидно, получится то, что нам и надо.
    \end{proof}
    \begin{remark}
        Теоремы \ref{Дифференцирование степенных рядов} и \ref{Единственность разложения в степенной ряд} с доказательством верны и для вещественных рядов.
    \end{remark}
    \begin{remark}
        Итого для разложения в ряд есть следующий алгоритм:\\
        Пусть $f\in C^{(\infty)}\langle x_0-R;x_0+R\rangle$. Мы можем составить её ряд Тейлора:
        $$
        \sum\limits_{k=0}^\infty\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k
        $$
        Как этот ряд может себя вести? Есть варианты, что дальше: ряд сходится к $f(x)$ или расходится. Или, что более странно, может сходиться не туда.
    \end{remark}
    \begin{example}
        $$
        \sum\limits_{k=0}^\infty x^k=\frac1{1-x}
        $$
        Пример для замечания выше, который (для $|x|<1$) сходится к $f(x)$.
    \end{example}
    \begin{example}
        Пример же для расходящегося ряда тейлора можно взять такой
        $$
        \frac1{1+x^2}=\sum\limits_{k=0}^\infty(-1)^kx^{2k}
        $$
        Он расходится при $|x|>1$ (это легко понять, если рассмотреть эту функцию как функцию комплексной переменной; у знаменателя корни имеют модуль 1). 
    \end{example}
    \begin{example}
        А вот что по поводу ряда Тейлора, которых сходится не туда? Ну, вот:
        $$
        f(x)=\begin{cases}
            0 & x=0\\
            e^{-1/x^2} & x\neq0
        \end{cases}
        $$
        Как мы знаем, в нуле все производные этой функции равны нулю. А значит и ряд Тейлора её состоит только из нулей. Тривиально, везде, кроме нуля ряд Тейлора сходится не туда.
    \end{example}
    \begin{remark}
        На самом деле проблема тут в том, что эта функция не дифференцируема на комплексной плоскости, как бы её не продолжить там.
    \end{remark}
    \begin{claim}
        Примем без доказательства тот факт, что дифференцируемая в комплексном круге функция раскладывается в ряд.
    \end{claim}
    \begin{corollary}
        А отсюда, если функция комплексно дифференцируема, то $\sum\limits_{k=0}^\infty\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k$ всегда сходится, да ещё и в правильное место.
    \end{corollary}
    \begin{theorem}[Признак разложимости функции в ряд Тейлора]
        Пусть $f\in C^{(\infty)}\langle a;b\rangle$, $\exists M>0~\forall k\in\mathbb N~\forall t\in\langle a;b\rangle~|f^{(k)}(t)|\leqslant M$. Тогда
        $$
        \forall x,x_0\in\langle a;b\rangle~f(x)=\sum\limits_{k=0}^\infty\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k
        $$
    \end{theorem}
    \begin{proof}
        См. доказательство формулы Тейлора с остатком в форме Лагранжа.
    \end{proof}
    \begin{definition}
        Пусть $f\colon\underset{\subset\mathbb C}D\to\mathbb C$, $z_0\in\Int D$. Функция называется \textbf{аналитической в точке} $z_0$, если она раскладывается в степенной ряд в некоторой окрестности $z_0$.\\
        $f$ называется \textbf{аналитической на открытом множестве}, если она аналитична в любой его точке. Класс аналитический функций на $D$ обозначается $\scriptA(D)$.
    \end{definition}
    \begin{definition}
        Пусть $f\colon\underset{\subset\mathbb R}D\to\mathbb R$, $x_0\in\Int D$. Функция называется \textbf{аналитической в точке} $x_0$, если она раскладывается в степенной ряд в некоторой окрестности $x_0$.\\
        $f$ называется \textbf{аналитической на открытом множестве}, если она аналитична в любой его точке.
    \end{definition}
    \begin{remark}
        Поскольку мы знаем, что аналитические функции дифференцируемы сколько угодно раз, можно продолжить ряд:
        $$
        C(a;b)\supsetneqq C^{(1)}(a;b)\supsetneqq C^{(2)}(a;b)\supsetneqq\cdots\supsetneqq C^{(m-1)}(a;b)\supsetneqq C^{(m)}(a;b)\supsetneqq\cdots\supsetneqq C^{(\infty)}(a;b)\supsetneqq\scriptA(a;b)
        $$
        На комплексной плоскости всё не так, а вот так:
        $$
        C(D)\supsetneq C^{(1)}(D)=C^{(2)}(a;b)=\cdots=C^{(m-1)}(D)=C^{(m)}(D)=\cdots=C^{(\infty)}(D)=\scriptA(a;b)
        $$
        Потому что аналитичность, как мы уже обсудили, следует из наличия одной (даже необязательно непрерывной) производной.
    \end{remark}
    \section{Разложение элементарных функций.}
    Пусть
    $$
    f(z)=\sum\limits_{k=0}^\infty c_kz^k\qquad g(z)=\sum\limits_{k=0}^\infty d_kz^k\qquad|z|<R
    $$
    Тогда, очевидно,
    \begin{itemize}
        \item $$
        (f+g)(z)=\sum\limits_{k=0}^\infty(c_k+d_k)z^k
        $$
        \item $$
        (\lambda f)(z)=\sum\limits_{k=0}^\infty(\lambda c_k)z^k
        $$
        \item $$
        (fg)(z)=\sum\limits_{k=0}^\infty\left(\sum\limits_{l=0}^kc_ld_{k-1}\right)z^k
        $$
        \item $$
        f'(z)=\sum\limits_{k=1}^\infty kc_kz^{k-1}
        $$
        \item $$
        \int\limits_0^x f(z)~\mathrm dz=\sum\limits_{k=1}^\infty c_k\frac{x^{k+1}}{k+1}
        $$
    \end{itemize}
    \paragraph{Экспонента, косинус и синус.}
    \begin{definition}
        \begin{itemize}
            \item $$
            e^z=\exp z=\sum\limits_{k=0}^\infty\frac{z^k}{k!}
            $$
            \item $$
            \cos z=\sum\limits_{k=0}^\infty\frac{(-1)^k}{(2k)!}z^{2k}
            $$
            \item $$
            \sin z=\sum\limits_{k=0}^\infty\frac{(-1)^k}{(2k+1)!}z^{2k+1}
            $$
        \end{itemize}
        Радиус сходимости этих рядов бесконечен, таким образом они сходятся на комплексной плоскости. Их суммы и назовём \textbf{экспонентой}, \textbf{косинусом} и \textbf{синусом комплексной переменной}. Для $z\in\mathbb R$ определение согласуется с вещественным.
    \end{definition}
    \begin{property}
        $\exp'z=\exp z\qquad\sin'z=\cos z\qquad\cos'z=-\sin z$
    \end{property}
    \begin{proof}
        Возьмите да и продифференцируйте, лол. Ряды сходятся везде, значит можно.
    \end{proof}
    \begin{property}
        $$
        e^{z_1+z_2}=e^{z_1}e^{z_2}
        $$
    \end{property}
    \begin{proof}
        $$
        e^{z_1}e^{z_2}=\left(\sum\limits_{k=0}^\infty\frac{z_1^k}{k!}\right)\left(\sum\limits_{j=0}^\infty\frac{z_2^j}{j!}\right)=\sum\limits_{k=0}^\infty\left(\sum\limits_{k=0}^k\frac{z_1^j}{j!}\frac{z_2^{k-j}}{(k-j)!}\right)=\sum\limits_{k=0}^\infty\frac1{k!}\left(\sum\limits_{k=0}^k\Cnk{k}{j}z_1^jz_2^k\right)=\sum\limits_{k=0}^\infty\frac1{k!}(z_1+z_2)^k
        $$
    \end{proof}
    \begin{property}
        $\cos$ чётна, $\sin$ нечётна
    \end{property}
    \begin{proof}
        На определение посмотрите, лол.
    \end{proof}
    \begin{property}
        \begin{itemize}
            \item $$
            e^{\im z}=\cos z+\im\sin z
            $$
            \item $$
            \cos z=\frac{e^{\im z}+e^{-\im z}}2
            $$
            \item $$
            \sin z=\frac{e^{\im z}-e^{-\im z}}{2\im}
            $$
        \end{itemize}
    \end{property}
    \begin{proof}
        $$
        \cos z=\sum\limits_{k=0}^\infty\frac{(-1)^k}{(2k)!}z^{2k}=\sum\limits_{k=0}^\infty\frac{(\im z)^{2k}}{(2k)!}\qquad
        \im\sin z=\im\sum\limits_{k=0}^\infty\frac{(-1)^k}{(2k+1)!}z^{2k+1}=\sum\limits_{k=0}^\infty\frac{(\im z)^{2k+1}}{(2k+1)!}
        $$
        Ну, всё, отсюда выводится первая формула, и из неё~--- остальные.
    \end{proof}
    \begin{property}
        Все школьные тригонометрические формулы остаются верными.
    \end{property}
    \begin{proof}
        Доказывается из предыдущего и свойств экспоненты. Рассмотрим только одно доказательство, скажем вот такой формулы:
        $$
        \cos(z_1-z_2)=\cos z_1\cos z_2+\sin z_1\sin z_2
        $$
        Докажем:
        \[
        \begin{split}
            \cos z_1\cos z_2+\sin z_1\sin z_2=\frac{e^{\im z_1}+e^{-\im z_1}}2\frac{e^{\im z_2}+e^{-\im z_2}}2+\frac{e^{\im z_1}-e^{-\im z_1}}{2\im}\frac{e^{\im z_2}-e^{-\im z_2}}{2\im}=\frac14\left(e^{\im(z_1+z_2)}+e^{\im(z_1-z_2)}+e^{\im(z_2-z_1)}+e^{-\im(z_1+z_2)}-e^{\im(z_1+z_2)}+e^{\im(z_1-z_2)}+e^{\im(z_2-z_1)}-e^{-\im(z_1+z_2)}\right)=\frac{e^{\im(z_1-z_2)}+e^{-\im(z_1-z_2)}}2=\cos(z_1-z_2)
        \end{split}
        \]
    \end{proof}
    \begin{definition}
        \begin{itemize}
            \item $$\cosh z=\frac{e^z+e^{-z}}2$$
            \item $$\sinh z=\frac{e^z-e^{-z}}2$$
        \end{itemize}
    \end{definition}
    \begin{property}
        \begin{itemize}
            \item $$
            \cosh z=\sum\limits_{k=0}^\infty\frac{z^{2k}}{(2k)!}
            $$
            \item $$
            \sin z=\sum\limits_{k=0}^\infty\frac{z^{2k+1}}{(2k+1)!}
            $$
        \end{itemize}
    \end{property}
    \begin{proof}
        Из определения и ряда Тейлора экспоненты.
    \end{proof}
    \begin{property}
        \begin{itemize}
            \item $$\cos z=\cosh(\im z)$$
            \item $$\sin z=\im\sinh(\im z)$$
            \item $$\cosh z=\cos(\im z)$$
            \item $$\sinh z=\im\sin(\im z)$$
        \end{itemize}
    \end{property}
    \begin{proof}
        Подставьте в формулу Эйлера.
    \end{proof}
    \begin{remark}[Геометрический смысл гиперболических функций.]
        Сначала посмотрим на тригонометрические функции. Если мы выберем точку $(\cos t;\sin t)$, то $t$ можно рассматривать как полярный угол, а можно~--- как удвоенную площадь сектора.
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                        width = 10cm,
                        height = 10cm,
                        grid = none,
                        xmin = -1.5,
                        xmax = 1.5,
                        ymin = -1.5,
                        ymax = 1.5,
                        axis equal,
                        axis x line = middle,
                        axis y line = middle,
                        axis line style = {->},
                        xtick = {-1,0,1},
                        ytick = {-1,0,1},
                    ]
                    \addplot[domain=0:360,samples=100,black]({cos(x)},{sin(x)});
                    \pgfmathsetmacro\Ax{cos(60)}
                    \pgfmathsetmacro\Ay{sin(60)}
                    \node[fill,circle,label={45:$A(\cos t;\sin t)$},scale=.5] (A) at (axis cs:\Ax,\Ay) {};
                    \addplot[domain=60:0,samples=100,draw=none,name path=A]({cos(x)},{sin(x)});
                    \addplot[domain=0:1,samples=2,draw=none,name path=B]{0};
                    \addplot[green,pattern=north west lines] fill between[of=A and B];
                    \draw (axis cs:0,0) -- (A);
                \end{axis}
            \end{tikzpicture}
        \end{figure}
        А теперь посмотрим на гиперболу $x^2-y^2=1$:
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 10cm,
                    height = 10cm,
                    grid = none,
                    xmin = -1,
                    xmax = 4,
                    ymin = -2.5,
                    ymax = 2.5,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    xtick = {-1,0,1},
                    ytick = {-1,0,1},
                    ]
                    \addplot[domain=-pi:pi,samples=100,black]({cosh(x)},{sinh(x)});
                    \pgfmathsetmacro\Ax{cosh(pi/3)}
                    \pgfmathsetmacro\Ay{sinh(pi/3)}
                    \node[fill,circle,label={0:$A(\cosh t;\sinh t)$},scale=.5] (A) at (axis cs:\Ax,\Ay) {};
                    \addplot[domain=0:pi/3,samples=100,draw=none,name path=A]({cosh(x)},{sinh(x)});
                    \addplot[domain=0:1,samples=2,name path=B]({x*\Ax},{x*\Ay});
                    \addplot[green,pattern=north west lines] fill between[of=A and B];
                \end{axis}
            \end{tikzpicture}
        \end{figure}
        Тогда аргумент $t$ равен удвоенной закрашенной площади.
    \end{remark}
    \begin{definition}
        Обратные гиперболические функции:\\
        $$
        \sinh t=u\Leftrightarrow e^t-e^{-t}=2u\Leftrightarrow(e^t)^2-2u(e^t)-1=0\Leftrightarrow e^t=u\pm\sqrt{1+u^2}
        $$
        То есть $\asinh t=\ln\left(u+\sqrt{1+u^2}\right)$, $\acosh t=\ln\left(u+\sqrt{u^2-1}\right)$
    \end{definition}
    \begin{remark}
        Надо понимать, что в комплексной плоскости есть существенные проблемы с обеими этими функциями (как и с обратными тригонометрическими функциями, как и даже с логарифмом). Они совершенно неоднозначные.
    \end{remark}
    \begin{property}
        Синус и косинус неограничены на комплексной плоскости.
    \end{property}
    \begin{proof}
        Из неограниченности $\cosh$ и $\sinh$ и связи  тригонометрических и гиперболических функций.
    \end{proof}
    \begin{property}
        Экспонента не имеет нулей, а $\sin$ и $\cos$ не имеют невещественных нулей.
    \end{property}
    \begin{proof}
        Экспонента не имеет нулей вот почему:
        $$
        e^z=e^xe^{\im y}\Rightarrow|e^z|=e^x>0
        $$
        Теперь к синусу:
        \[
        \sin(x+\im y)=0\Leftrightarrow\sin x\cosh y+\im\cos x\sinh y=0\Leftrightarrow\left\{\begin{aligned}
            \cos x\sinh y&=0\\
            \sin x\cosh y&=0
        \end{aligned}\right.\Leftrightarrow\left\{\begin{aligned}
            \sin x&=0\\
            y&=0
        \end{aligned}\right.
        \]
        Косинус через формулу приведения.
    \end{proof}
    \begin{property}
        Экспонента имеет периоды $2k\pi\im\mid k\in\mathbb Z\setminus\{0\}$ и никаких других. Синус и косинус имеют периоды $2k\pi\mid k\in\mathbb Z\setminus\{0\}$ и никаких других
    \end{property}
    \begin{proof}
        Пусть $T$~--- период $\exp$. Тогда $e^{z+T}=e^z$ или $e^T=1$. Это бывает только в случае $T=2k\pi i$ (распишите $T=\alpha+\im\beta$).\\
        Для синуса и косинуса~--- либо аналогично, либо напрямую отсюда.
    \end{proof}
    \begin{definition}
        $$\tan z=\frac{\sin z}{\cos z}\qquad\cot z=\frac{\cos z}{\sin z}$$
    \end{definition}
    \begin{property}
        Эти функции определены и аналитичны там, где знаменатель не разлагается в ноль.
    \end{property}
    \begin{proof}
        Про их бесконечную дифференцируемость мы знаем, а из недоказанного нами утверждения они аналитичны.
    \end{proof}
    \paragraph{Логарифм и арктангенс.}
    \begin{remark}
        Здесь пока ограничимся вещественной переменной.
    \end{remark}
    \begin{claim}
        Начнём с того, что
        $$
        \frac1{1+t}=\sum\limits_{k=0}^\infty(-1)^kt^k\quad t\in(-1;1)
        $$
        А теперь возьмём $x\in(-1;1)$ и проинтегрируем это от 0 до $x$:
        $$
        \ln(1+x)=\sum\limits_{k=0}^\infty\frac{(-1)^{k-1}}kx^k\quad x\in(-1;1)
        $$
        При $x=1$ равенство также верно (по \hyperref[Теорема Абеля о степенных рядах]{теореме Абеля}), при $x=-1$~--- очевидно, нет. Тут, кстати, можно проиллюстрировать, как теорема Абеля применяется. При $x=1$ ряд сходится, значит его сумма непрерывна слева в $x=1$. И левая часть (логарифм) также непрерывен в $x=1$. Значит у нас две функции, которые равны слева единицы, там же обе непрерывны, а значит в единице они равны.
    \end{claim}
    \begin{claim}
        $$
        \ln(1-x)=-\sum\limits_{k=0}^\infty\frac{x^k}k\quad x\in[-1;1)
        $$
    \end{claim}
    \begin{claim}
        $$
        \frac12\ln\frac{1+x}{1-x}=\sum\limits_{l=0}^\infty\frac{x^{2l+1}}{2l+1}\quad x\in(-1;1)
        $$
    \end{claim}
    \begin{proof}
        Это мы вычли две предыдущие формулы друг из друга.
    \end{proof}
    \begin{claim}
        Пусть $n\in\mathbb N$.
        $$
        \frac12\ln\left(1+\frac1n\right)=\sum\limits_{l=0}^\infty\frac1{(2l+1)(2n+1)^{2l+1}}
        $$
    \end{claim}
    \begin{proof}
        Из предыдущего, $x=\frac1{2n+1}$.
    \end{proof}
    \begin{remark}
        Эта формула бывает применимее, нежели $\ln(1+x)=\sum\limits_{k=0}^\infty\frac{(-1)^{k-1}}kx^k$, ведь если вы решили посчитать $\ln\left(1+\frac1n\right)$, то общая формула будет сходиться гораздо медленнее.
    \end{remark}
    \begin{claim}[Формула Стирлинга]
        $$
        n!=\sqrt{2\pi}\left(\frac ne\right)^ne^{\frac\theta{12n}}\qquad \theta\in(0;1)
        $$
    \end{claim}
    \begin{proof}
        Из предыдущего
        $$
        \left(n+\frac12\right)\ln\left(1+\frac1n\right)=\sum\limits_{l=0}^\infty\frac1{(2l+1)(2n+1)^{2l}}=1+\sum\limits_{l=1}^\infty\frac1{(2l+1)(2n+1)^{2l}}
        $$
        Отсюда оценим левую часть:
        $$
        1<\left(n+\frac12\right)\ln\left(1+\frac1n\right)<1+\frac13\sum\limits_{k=1}^\infty\frac1{(2n+1)^{2l}}=1+\frac13\cdot\frac{1/(2n+1)^2}{1-1/(2n+1)^2}=1+\frac1{12n(n+1)}
        $$
        И к этому чуду применим экспоненту:
        $$
        e<\left(1+\frac1n\right)^{\left(n+\frac12\right)}<e^{1+\frac1{12n(n+1)}}
        $$
        Теперь введём такую последовательность
        $$
        a_n=\frac{n!e^n}{n^{n+1/2}}
        $$
        Мы хотим исследовать её монотонность. Чему равно $\frac{a_n}{a_{n+1}}$? Ну,
        $$
        \frac{a_n}{a_{n+1}}=\frac{n!e^n}{n^{n+1/2}}\frac{(n+1)^{n+3/2}}{(n+1)!e^{n+1}}=\frac1e\left(1+\frac1n\right)^{n+\frac12}>1
        $$
        То есть $a_n\downarrow$. Поскольку $a_n$ ограничены снизу нулём, существует предел $\lim\limits_{n\to\infty}a_n$, равный, скажем, $a\in[0;+\infty)$.\\
        Мы хотим понять, что $a>0$, и для этого рассмотрим последовательность $a_ne^{-\frac1{12n}}$. Для неё
        $$
        \frac{a_ne^{-\frac1{12n}}}{a_{n+1}e^{-\frac1{12(n+1)}}}=\frac{\left(1+\frac1n\right)^{n+\frac12}}{e^{1+\frac1{12n(n+1)}}}<1
        $$
        То есть $a_ne^{-\frac1{12n}}\uparrow$. При этом сходится эта штука также к $a$, и отсюда $a>0$. Тогда $a<a_n<ae^{\frac1{12n}}$ или $a_n=ae^{\frac\theta{12n}}\mid\theta\in(0;1)$, где $\theta$~--- какое-то число, зависящее от $n$. Раскрыв $a_n$, получим
        $$
        n!=a\sqrt n\left(\frac ne\right)^ne^{\frac\theta{12n}}
        $$
        Это уже почти формула Стирлинга, но нам надо лишь понять, что $a=\sqrt{2n}$. Искать будем при помощи формулы Валлиса, которая, если кто забыл, звучит как
        $$
        \frac1n\left(\frac{(2n)!!}{(2n-1)!!}\right)^2\longrightarrow\pi
        $$
        При этом
        \[\begin{split}
            \frac1n\left(\frac{(2n)!!}{(2n-1)!!}\right)^2&=\frac1n\left(\frac{((2n)!!)^2}{(2n)!}\right)^2=\frac1n\left(\frac{2^{2n}(n!)^2}{(2n)!}\right)^2=\frac1n\left(\frac{2^{2n}a^2n\frac{n^{2n}}{e^{2n}}e^{\frac\theta{6n}}}{a\sqrt{2n}\frac{(2n)^{2n}}{e^{2n}}e^{\frac\tau{24n}}}\right)^2=\\
            &=\frac1n\left(\frac{\cancel{2^{2n}}a^2n\frac{n^{2n}}{e^{2n}}e^{\frac\theta{6n}}}{a\sqrt{2n}\frac{(\cancel{2}n)^{2n}}{e^{2n}}e^{\frac\tau{24n}}}\right)^2=\frac1n\left(\frac{a^2n\cancel{\frac{n^{2n}}{e^{2n}}}e^{\frac\theta{6n}}}{a\sqrt{2n}\cancel{\frac{n^{2n}}{e^{2n}}}e^{\frac\tau{24n}}}\right)^2=\cancel{\frac1n}\left(\frac{a^{\bcancel{2}}\cancel{n}e^{\frac\theta{6n}}}{\bcancel{a}\sqrt{2\cancel{n}}e^{\frac\tau{24n}}}\right)^2\rightarrow\frac{a^2}2
        \end{split}\]
        Отсюда $\frac{a^2}2=\pi$, то есть $a=\sqrt{2\pi}$.
    \end{proof}
    \begin{remark}
        Вернёмся к комплексным переменным.
    \end{remark}
    \begin{definition}
        Как мы уже знаем,
        $$
        \ln z=\sum\limits_{k=0}^\infty\frac{(-1)^{k-1}}k(z-1)^k\quad |z-1|\in(-1;1)
        $$
        Как определить логарифм на всей остальной плоскости, мы пока не знаем, но на самом деле для аналитический функций верно, что если они совпадают в некотором круге, то они совпадают везде. Поэтому любую функцию можно единственным образом продолжить на всю плоскость. И Вейерштрасс придумал способ, каким можно продолжить функцию: берём произвольную точку круга сходимости $z_0$ и перераскладываем в ряд относительно $(z-z_0)$. Получаем новый ряд с новым радиусом, и круг сходимости этого ряда может вылезти за исходный круг. Делаем так до посинения, и если аналитическое продолжение существует, то у нас получится замостить такими кругами всю плоскости.\\
        При этом, если мы так сделаем с логарифмом, то мы получим особую точку 0, обойдя которую мы получим приращение аргумента на $2\pi$. И отсюда возникают многозначные функции.
        $$
        \Ln z=\ln |z|+\im\Arg z
        $$
        Если в качестве $\Arg z$ взять главное значение аргумента из $(-\pi;\pi]$, получим \textbf{главное значение логарифма}.
    \end{definition}
    \begin{remark}
        Теперь вернёмся к вещественным аргументам и рассмотрим арктангенс.
    \end{remark}
    \begin{claim}
        Рассмотрим
        $$
        \frac1{1-z}=\sum\limits_{k=0}^\infty z^k\qquad z\in(-1;1)
        $$
        И подставим $z=-t^2$. Получим
        $$
        \frac1{1+t^2}=\sum\limits_{k=0}^\infty(-1)^kz^{2k}\qquad t\in(-1;1)
        $$
        Проинтегрировав это от 0 до $x$, получим
        $$
        \atan x=\sum\limits_{k=0}^\infty\frac{(-1)^k}{2k+1}x^{2k+1}\qquad x\in[-1;1]
        $$
        При $x=\pm1$ выполнено по теореме Абеля.
    \end{claim}
    \begin{claim}
        В частности,
        $$
        \frac\pi4=\sum\limits_{k=0}^\infty\frac{(-1)^k}{2k+1}=1-\frac13+\frac15-\frac17+\cdots
        $$
    \end{claim}
    \begin{remark}
        Степенные ряды раньше очень любили применять для вычисления числа $\pi$ с большой точностью. Конкретно этот ряд для этого очень сложно использовать, он очень медленно сходится, а вот взяв $x=\frac1{\sqrt3}$, получим
        $$
        \frac\pi6=\sum\limits_{k=0}^\infty\frac{(-1)^k}{2k+1}\frac1{3^k}\frac1{\sqrt3}
        $$
        Потом придумали комбинировать ряды, чтобы получать ещё более быстро сходящиеся ряды, но потом вывели рекуррентные формулы, которые сходятся ещё быстрее, и дела с рядами заглохли.
    \end{remark}
    \paragraph{Степенная функция.}
    \begin{remark}
        Напоминание:
        $$
        \Cnk\alpha k=\frac{\alpha\cdot\cdots\cdot(\alpha-k+1)}{k!}\qquad k\in\mathbb Z_+,\alpha\in\mathbb C
        $$
    \end{remark}
    \begin{theorem}[Биномиальный ряд Ньютона]
        Пусть $\alpha\in\mathbb R$, тогда
        $$
        (1+x)^\alpha=\sum\limits_{k=0}^\infty\Cnk\alpha kx^k\qquad x\in(-1;1)
        $$
    \end{theorem}
    \begin{remark}
        Если $\alpha\in\mathbb Z_+$, ряд обрывается ($\Cnk\alpha k=0$ при $k>\alpha$). В таком случае
        $$
        (1+x)^n=\sum\limits_{k=0}^\infty \Cnk nk x^k
        $$
        для любого $x\in\mathbb C$.
    \end{remark}
    \begin{proof}
        Мы будем рассматривать только $\alpha\notin\mathbb Z_+$. Тогда докажем, что радиус сходимости в точности единица. Доказывать будем до \hyperref[Радиус сходимости по Д'Аламберу]{Д'Аламберу}.
        $$
        \left|\frac{\Cnk\alpha k}{\Cnk\alpha{k+1}}\right|=\left|\frac{\frac{\alpha\cdot\cdots\cdot(\alpha-k+1)}{k!}}{\frac{\alpha\cdot\cdots\cdot(\alpha-k)}{(k+1)!}}\right|=\left|\frac{k+1}{\alpha-k}\right|\rightarrow1
        $$
        Теперь докажем, что сумма этого ряда равна тому, чему хочется. Ну, пусть
        $$
        S(x)=\sum\limits_{k=0}^\infty\Cnk\alpha kx^k
        $$
        Давайте запишем $S'(x)$:
        $$
            S'(x)=\sum\limits_{k=1}^\infty\Cnk\alpha kkx^{k-1}=\sum\limits_{k=0}^\infty\Cnk\alpha{k+1}(k+1)x^k
        $$
        А ещё запишем $xS'(x)$:
        $$
        xS'(x)=x\sum\limits_{k=0}^\infty\Cnk\alpha kkx^{k-1}=\sum\limits_{k=0}^\infty\Cnk\alpha kkx^k
        $$
        Теперь сложим эти два равенства:
        \[\begin{split}
            (1+x)S'(x)&=\sum\limits_{k=0}^\infty\left(\Cnk\alpha kk+\Cnk\alpha{k+1}(k+1)\right)x^k=\sum\limits_{k=0}^\infty\left(\frac{\alpha\cdot\cdots\cdot(\alpha-k)}{(k+1)!}(k+1)+\frac{\alpha\cdot\cdots\cdot(\alpha-k+1)}{k!}k\right)x^k=\\
            &=\sum\limits_{k=0}^\infty\left(\frac{\alpha\cdot\cdots\cdot(\alpha-k+1)\cdot(\alpha-k+k)}{k!}\right)x^k=\sum\limits_{k=0}^\infty\alpha\Cnk\alpha kx^k=\alpha S(x)
        \end{split}\]
        То есть $(1+x)S'(x)=\alpha S(x)$. Чтобы решить это уравнение, введём $g(x)=\frac{S(x)}{(1+x)^\alpha}$. Тогда
        $$
        g'(x)=\frac{(1+x)^\alpha S'(x)-\alpha(1+x)^{\alpha-1}S(x)}{(1+x)^{2\alpha}}=0
        $$
        То есть $g(x)=\mathrm{const}$. Поскольку $g(0)=S(0)=1$, $g(x)\equiv1$, то есть $S(x)=(1+x)^\alpha$.
    \end{proof}
    \begin{remark}
        Исследовать поведение степенного ряда на концах~--- задание читателю. Мы же только обговорим, что если ряд сходится при $x=1$ или $x=-1$, то сходится к правильному значению по \hyperref[Теорема Абеля о степенных рядах]{теореме Абеля}. А вот когда сходится, решайте сами.
    \end{remark}
    \begin{remark}
        Частные случаи:
        \begin{enumerate}
            \addtocounter{enumi}{-1}
            \item $$
            (1+x)^\alpha=\sum\limits_{k=0}^\alpha\Cnk \alpha kx^k\qquad\alpha\in\mathbb Z_+
            $$
            \item $$
            \alpha=-1\qquad\frac1{x+1}=\sum\limits_{k=0}^\infty(-1)^kx^k\qquad x\in(-1;1)
            $$
            \item $$
            \alpha=-n,n\in\mathbb N\qquad\Cnk{-n}k=\frac{(-n)\cdot\cdots\cdot(-n-k+1)}{k!}=(-1)^k\frac{n\cdot\cdots\cdot(n+k-1)}{k!}
            $$
            $$
            \frac1{(1+x)^n}=\sum\limits_{k=0}^\infty(-1)^k\Cnk{n+k-1}kx^k\qquad x\in(-1;1)
            $$
            \begin{remark}
                Эту формулу на самом деле можно получить и проще. Например, возвести ряд $\frac1{1+x}$ в $n$-ную степень по Коши или продифференцировать его $n-1$ раз.\\
                Только на самом деле проще сделать это для ряда $\frac1{1-x}$, а не $\frac1{1+x}$, потому что в его разложении нет $(-1)^k$.
            \end{remark}
            \item $$
            \alpha=\frac12\qquad\Cnk{1/2}k=\frac{(1/2)\cdot(-1/2)\cdot\cdots\cdot(1/2-k+1)}{k!}=\frac{1\cdot(-1)\cdot\cdots\cdot(3-2k)}{2^kk!}=(-1)^{k-1}\frac{(2k-3)!!}{(2k)!!}
            $$
            $$
            \sqrt{1+x}=1+\sum\limits_{k=1}^\infty(-1)^{k-1}\frac{(2k-3)!!}{(2k)!!}x^k
            $$
            Но теперь мы можем узнать, что происходит на концах. Для этого воспользуемся формулой Валлиса.
            $$
            \frac{(2k-3)!!}{(2k)!!}=\frac1{2k-1}\frac{(2k-1)!!}{(2k)!!}\sim\frac1{2k\sqrt{\pi n}}
            $$
            И отсюда ряд на концах сходится абсолютно.
            \item $$
            \alpha=-\frac12\qquad\Cnk{-1/2}k=\frac{(-1/2)\cdot\cdots\cdot(-1/2-k+1)}{k!}=(-1)^k\frac{(2k-1)!!}{(2k)!!}
            $$
            $$
            \frac1{\sqrt{1+x}}=\sum\limits_{k=0}^\infty(-1)^k\frac{(2k-1)!!}{(2k)!!}x^k\qquad x\in(-1;1]
            $$
        \end{enumerate}
    \end{remark}
    \begin{corollary}
        Подставим в предыдущую формулу $x=-t^2$. Получим
        $$
        \frac1{\sqrt{1-t^2}}=\sum\limits_{k=0}^\infty\frac{(2k-1)!!}{(2k)!!}t^{2k}\qquad t\in(-1;1)
        $$
        Проинтегрируем от 0 до $x$, получим
        $$
        \asin x=\sum\limits_{k=0}^\infty\frac{(2k-1)!!}{(2k)!!}\frac{t^{2k}}{2k+1}\qquad t\in[-1;1]
        $$
        На краях есть равенство по \hyperref[Теорема Абеля о степенных рядах]{Абелю}.
    \end{corollary}
    \begin{corollary}[Свёртка Вандермонда]
        $$
        \sum\limits_{l=0}^k\Cnk\alpha l\Cnk\beta{k-l}=\Cnk{\alpha+\beta}k
        $$
    \end{corollary}
    \begin{proof}
        $$
        (1+x)^\alpha=\sum\limits_{k=0}^\infty\Cnk\alpha kx^k\qquad(1+x)^\beta=\sum\limits_{k=0}^\infty\Cnk\beta kx^k\qquad(1+x)^{\alpha+\beta}=\sum\limits_{k=0}^\infty\Cnk{\alpha+\beta}kx^k
        $$
        Также
        $$
        (1+x)^{\alpha+\beta}=(1+x)^\alpha\cdot(1+x)^{\beta}=\sum\limits_{k=0}^\infty\left(\sum\limits_{l=0}^k\Cnk\alpha l\Cnk\beta{k-l}\right)x^k
        $$
        Отсюда получаем то, что хотим получить.
    \end{proof}
    \section{Числа и многочлены Бернулли.}
    \begin{remark}
        здесь пойдёт речь о некоторой последовательности, которая удивительно много когда встречается в анализе.
    \end{remark}
    \begin{remark}
        Пусть $$g(z)=\sum\limits_{k=0}^\infty b_kz^k\qquad|z|<R$$
        Пусть $g(0)=b_0\neq0$. Тогда $h=\frac1g$ аналитична в некоторой окрестности нуля и
        $$
        h(z)=\sum\limits_{k=0}^\infty c_kz^k\qquad|z|<r
        $$
        Тогда $c_k$ можно найти методом неопределённых коэффициентов.
        $$
        1=\left(\sum\limits_{k=0}^\infty b_kz^k\right)\left(\sum\limits_{k=0}^\infty c_kz^k\right)
        $$
    \end{remark}
    \begin{definition}
        Пусть
        $$
        \frac z{e^z-1}=\sum\limits_{k=0}^\infty\frac{B_k}{k!}z^k\qquad|z|<2\pi
        $$
        Числа $B_k$ называют \textbf{числами Бернулли}.
    \end{definition}
    \begin{property}
        $B_0=1$,
        $$
        \sum\limits_{l=0}^k\frac{B_l}{l!(k-l+1)!}
        $$
    \end{property}
    \begin{proof}
        $$
        \frac{e^z-1}z=\sum\limits_{k=1}^\infty\frac{z^{k-1}}{k!}=\sum\limits_{j=0}^\infty\frac{z^j}{(j+1)!}
        $$
        Тогда
        $$
        1=\left(\sum\limits_{k=0}^\infty\frac{B_k}{k!}z^k\right)\left(\sum\limits_{j=0}^\infty\frac{z^j}{(j+1)!}\right)
        $$
        И отсюда то, что нам надо получить.
    \end{proof}
    \begin{remark}
        Предыдущую формулу проще всего запоминать так:
        $$B_{k+1}=\sum\limits_{l=0}^{k+1}\Cnk{k+1}lB_l$$
        И ещё её упорото записывают вот так:
        $$
        B_{k+1}=(B+1)_{k+1}
        $$
        Её понимать так: поднимем индекс вверх, раскроем по биному Ньютона, опустим у всех $B$ индексы вниз.\\
        При этом надо понимать, что их этого уравнения мы находим $B_k$, а не $B_{k+1}$.
    \end{remark}
    \begin{example}
        \begin{enumerate}
            \addtocounter{enumi}{-1}
            \item $B_0=1$.
            \item $\frac{B_0}2+B_1=0\Rightarrow B_1=-\frac12$.
            \item $\frac{B_0}6+\frac{B_1}2+\frac{B_2}2=0\Rightarrow B_2=\frac16$.
            \item $\frac{B_0}{24}+\frac{B_1}6+\frac{B_2}4+\frac{B_3}6=0\Rightarrow B_3=0$.
            \item $\frac{B_0}{120}+\frac{B_1}{24}+\frac{B_2}{12}+\frac{B_3}{12}+\frac{B_4}{24}=0\Rightarrow B_4=-\frac1{30}$.
            \item $B_5=0$.
            \item $B_6=\frac1{42}$.
            \item $B_7=0$.
            \item $B_8=-\frac1{30}$.
            \item $B_9=0$.
            \item $B_{10}=\frac5{66}$.
            \addtocounter{enumi}{1}
            \item $B_{12}=-\frac{691}{2730}$.
            \addtocounter{enumi}{1}
            \item $B_{14}=\frac76$.
            \addtocounter{enumi}{1}
            \item $B_{16}=-\frac{3617}{510}$
        \end{enumerate}
    \end{example}
    \begin{remark}
        Красивой и простой формулы для этих чисел нет, но у них есть некоторые свойства.
    \end{remark}
    \begin{property}
        Тривиально, $B_k\in\mathbb Q$.
    \end{property}
    \begin{property}
        Без доказательства, $(-1)^kB_{2k}>0$.
    \end{property}
    \begin{property}
        $B_{2k+1}=0$.
    \end{property}
    \begin{lemma}
        Тривиально:\\
        Если $f(z)=\sum\limits_{k=0}^\infty\frac{f^{(k)}(0)}{k!}z^k$. Тогда $f$ чётная тогда и только тогда, когда $\forall k\in\mathbb Z_+~f^{(k)}(0)=0$
    \end{lemma}
    \begin{proof}
        Давайте ещё раз запишем разложение:
        $$
        \frac z{e^z-1}=1-\frac z2+\sum\limits_{k=2}^\infty\frac{B_k}{k!}z^k
        $$
        Если мы докажем, что $\frac z{e^z-1}+\frac z2$~--- чётная функция, то мы получим то, что мы хотим.
        $$
        \frac z{e^z-1}+\frac z2=\frac{2z+ze^z-z}{2e^z-2}=\frac z2\cdot\frac{e^z+1}{e^z-1}=\frac z2\coth\frac z2
        $$
        $\frac z2$~--- нечётная функция, $\coth$~--- тоже.
    \end{proof}
    \begin{corollary}
        $$\frac z2\coth\frac z2=\sum\limits_{k=0}^\infty\frac{B_{2k}}{(2k)!}z^{2k}\qquad |z|<2\pi$$
        Или
        $$z\coth z=\sum\limits_{k=0}^\infty\frac{2^{2k}B_{2k}}{(2k)!}z^{2k}\qquad |z|<\pi$$
    \end{corollary}
    \begin{corollary}
        $$z\cot z=\sum\limits_{k=0}^\infty\frac{(-1)^k2^{2k}B_{2k}}{(2k)!}z^{2k}=1-\frac{z^2}3-\frac{z^2}3-\frac{z^4}{45}-\frac{2z^6}{945}-\cdots\qquad |z|<\pi$$
    \end{corollary}
    \begin{claim}
        $$
        \tan z=\cot z-2\cot 2z
        $$
    \end{claim}
    \begin{corollary}
        $$\tan z=\sum\limits_{k=1}^\infty\frac{(-1)^{k-1}(2^{2k}-1)2^{2k}B_{2k}}{(2k)!}z^{2k-1}=z+\frac{z^3}3+\frac{2z^5}{15}+\frac{17z^7}{315}+\cdots\qquad|z|<\frac\pi2$$
    \end{corollary}
    \begin{proof}
        $$\tan z=\sum\limits_{k=0}^\infty\frac{(-1)^k2^{2k}B_{2k}}{(2k)!}z^{2k-1}-\sum\limits_{k=0}^\infty\frac{(-1)^k2^{4k}B_{2k}}{(2k)!}z^{2k-1}=\sum\limits_{k=1}^\infty\frac{(-1)^k2^{2k}(1-2^{2k})B_{2k}}{(2k)!}z^{2k-1}$$
    \end{proof}
    \begin{remark}
        Также отсюда можно вывести разложение котангенса из вот такой формулы:
        $$
        \frac z{\sin z}=z\cot z+z\tan\frac z2
        $$
    \end{remark}
    \paragraph{Разложение синуса в бесконечное произведение. Гармонический ряд.}
    \begin{remark}
        Теперь мы хотим вычислить $\sum\limits_{k=1}^\infty\frac1{z^2}$. Делать мы это будем также, как делал в своё время Эйлер. И вывел он ответ из другой формулы.\\
        Пусть $P(z)=a_nz^n+\cdots+a_0\mid a_n\neq0$. Тогда $P(z)=a_n\prod\limits_{k=1}^n(z-z_k)$, где $z_k$~--- корни $P$. Но это удобнее переписать так:
        $$
        P(z)=Az^m\prod_{k=1}^{n-m}\left(1-\frac z{z_k}\right)
        $$
        $z^m$~--- это то, что у $P$ могут быть несколько корней, равных нулю, вот это они. На остальные можно делить. При этом изменение коэффициентов войдёт в $A$.\\
        Теперь, смотрите, что хочется (и что сделал Эйлер). Хочется сделать то же самое для синуса, получив
        $$\sin z=z\prod\limits_{k=1}^\infty\left(1-\frac{z^2}{k^2\pi^2}\right)$$
        Что делать, имея эту формулу? Ну, разложить обе части в степенной ряд. Слева получим
        $$
        \sin z=z-\frac{z^3}6+\frac{z^5}{120}
        $$
        Откуда мы справа берём $z$, понятно. А откуда у нас $-\frac{z^3}6$? Ну,
        $$
        -\frac16=-\sum\limits_{k=1}^\infty\frac1{k^2\pi^2}
        $$
        И отсюда мы как минимум догадываемся до
        $$
        \sum\limits_{k=1}^\infty\frac1{k^2}=\frac{\pi^2}6
        $$
    \end{remark}
    \begin{definition}
        \textbf{Бесконечное произведение}~--- вот что такое:
        $$
        \prod\limits_{k=1}^\infty p_k=\lim\limits_{n\to\infty}\prod\limits_{k=1}^np_k
        $$
        Говорят, что бесконечное произведение \textbf{сходится}, если предел существует, конечен и отличен от нуля.
    \end{definition}
    \begin{property}
        Если произведение сходится, то общий множитель стремится к 1.
    \end{property}
    \begin{proof}
        Пусть $P_n=\prod\limits_{k=1}^np_k$~--- частичные произведения.\\
        Тогда
        $$p_n=\frac{P_n}{P_{n-1}}\rightarrow\frac PP=1$$
    \end{proof}
    \begin{remark}
        Начиная с этого момента, $p_k\in\mathbb R$. Тогда если произведение сходится, то
        $\exists N~\forall k>N~p_k>0$.\\
        Начиная с этого момента все $p_k$ у сходящегося произведения положительны. А значит...
    \end{remark}
    \begin{property}
        $\prod\limits_{k=1}^\infty p_k$ сходится тогда и только тогда, когда $\sum\limits_{k=1}^\infty \ln p_k$ сходится. При этом
        $$
        \prod\limits_{k=1}^\infty p_k=e^{\sum\limits_{k=1}^\infty \ln p_k}
        $$
    \end{property}
    \begin{proof}
        Рассмотрите частичное произведение и частичную сумму, и получите то, что хотите.
    \end{proof}
    \begin{remark}
        Для комплексных то же самое работает, но нужно вам главное значение комплексного логарифма.
    \end{remark}
    \begin{remark}
        Именно из-за этого свойства принято считать, что бесконечное произведение расходится к нулю, а не сходится к нулю.
    \end{remark}
    \begin{theorem}[Теорема Эйлера]
        $$\sin z=z\prod\limits_{k=1}^\infty\left(1-\frac{z^2}{k^2\pi^2}\right)$$
    \end{theorem}
    \begin{proof}
        Докажем мы эту теорему для $z=x\in\mathbb R$, чтобы не возиться с главным значением логарифма.\\
        Если $x=l\pi\mid l\in\mathbb Z$, то неравенство принимает вид $0=0$. Дальше $\sin x\neq0$.\\
        По формуле Муавра
        $$
        \cos m\varphi+\im\sin m\varphi=(\cos\varphi+\im\sin\varphi)^m=\sum\limits_{k=0}^m\Cnk mk\cos^k\varphi\im^{m-k}\sin^{m-k}\varphi
        $$
        Отсюда
        $$
        \sin m\varphi=m\cos^{m-1}\varphi\sin\varphi-\Cnk m{m-3}m\cos^{m-3}\varphi\sin^3\varphi+\cdots
        $$
        Пусть $m=2n+1$. Тогда $\sin(2n+1)\varphi=\sin\varphi P(\sin^2\varphi)$, где $P$~--- некоторый многочлен степени $\leqslant n$. При этом $n$ его корней мы знаем:
        $$
        u_k=\sin^2\frac{k\pi}{2n+1}
        $$
        Отсюда
        $$
        P(u)=A\prod\limits_{k=1}^n\left(1-\frac u{u_k}\right)
        $$
        У нас тут какое-то непонятное $A$, давайте его найдём.
        $$
        A=P(0)=\lim\limits_{\varphi\to0}\frac{\sin(2n+1)\varphi}{\sin\varphi}=2n+1
        $$
        То есть
        $$
        \sin(2n+1)\varphi=(2n+1)\sin\varphi\prod\limits_{k=1}^n\left(1-\frac{\sin^2\varphi}{\sin\frac{k\pi}{2n+1}}\right)
        $$
        Очень хорошо, давайте положим $\varphi=\frac x{2n+1}$. Тогда что получим?
        $$
        \sin x=(2n+1)\sin\frac x{2n+1}\prod\limits_{k=1}^n\left(1-\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}\right)
        $$
        Нам очень хочется сделать сдесь предельный переход $n\to\infty$. Но нельзя, у нас произведение переменного количества множителей.\\
        Давайте зафиксируем $M>|x|$, и возьмём $n>M$. Тогда
        $$
        (2n+1)\sin\frac x{2n+1}\prod\limits_{k=1}^M\left(1-\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}\right)\underset{n\to\infty}\longrightarrow x\prod\limits_{k=1}^M\left(1-\frac{x^2}{k\pi}\right)
        $$
        Осталось лишь рассмотреть остаток и доказать, что он стремится к нулю. А для этого прологарифмируем его. Пусть
        $$
        \ln\prod\limits_{k=M+1}^n\left(1-\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}\right)=\sum\limits_{k=M+1}^\infty f_k(n)\qquad\qquad
        f_k(n)=\begin{cases}
            \ln\left(1-\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}\right) & M+1\leqslant k\leqslant n\\
            0 & k>n
        \end{cases}
        $$
        Мы хотим доказать, что $\sum\limits_{k=M+1}^\infty f_k(n)\rightarrow\sum\limits_{k=M+1}^\infty\ln\left(1-\frac{x^2}{k^2\pi^2}\right)$. А для этого мы докажем, что $\sum\limits_{k=M+1}^\infty f_k(n)$ равномерно сходится по $n$.\\
        Это делается по \hyperref[Признак Вейерштрасса]{признаку Вейерштрасса}.
        $$
        0<\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}\overset{\sin t\geqslant\frac2\pi t\mid t\in[0;\pi/2]}\leqslant\frac{\frac{x^2}{(2n+1)^2}}{\frac4{\pi^2}\frac{k^2\pi^2}{(2n+1)^2}}=\frac{x^2}{4k^2}\leqslant\frac14
        $$
        Заметим вот какое неравенство: для любого $u\in\left[0;\frac14\right]$ верно $|\ln(1-u)|\leqslant Cu$. Почему? Потому что $\frac{\ln(1-u)}u$ непрерывно на $\left[1;1/4\right]$, а значит ограничено. Обозначим то, чем оно ограничено за $C$.\\
        Теперь в качестве $u$ подставим $\frac{\sin^2\frac x{2n+1}}{\sin^2\frac{k\pi}{2n+1}}$. Получим $|f_k(n)|\leqslant\frac{Cx^2}4=\frac{C_x}4$. И по признаку Вейерштрасса ряд равномерно сходится на множестве $\{n\in\mathbb N\mid n>M\}$. То есть
        $$
        \sum\limits_{k=M+1}^\infty f_k(n)\rightarrow\sum\limits_{k=M+1}^\infty\ln\left(1-\frac{x^2}{k^2\pi^2}\right)
        $$
        А отсюда, потенцированием обеих частей, получаем то, что получить хотели.
    \end{proof}
    \begin{corollary}
        Пусть $x=\frac\pi2$. Тогда
        $$
        \prod\limits_{k=1}^\infty\left(1-\frac1{4k^2}\right)=\frac2\pi
        $$
        Это формула Валлиса, если расписать множители.
    \end{corollary}
    \begin{corollary}
        $$
        \cos z=\prod_{m=0}^\infty\left(1-\frac{z^2}{\left(m+\frac12\right)^2\pi^2}\right)
        $$
    \end{corollary}
    \begin{proof}
        Проще всего вывести эту формулу из синуса двойного угла: $$\cos z=\frac{\sin2z}{2\sin z}$$
    \end{proof}
    \begin{corollary}
        Упражнение читателю: написать, как раскладываются гиперболические синус и косинус.
    \end{corollary}
    \subparagraph{Разложение котангенса на простые дроби.}
    \begin{theorem}
        $$\cot x=\frac1x-\mathrm{v.p.}\sum\limits_{k=-\infty}^\infty\frac1{x-k\pi}$$
    \end{theorem}
    \begin{proof}
        Известно, что
        $$
        |\sin x|=|x|\prod\limits_{k=1}^\infty\left|1-\frac{x^2}{k^2\pi^2}\right|
        $$
        Прологарифмируем это:
        $$
        \ln|\sin x|=\ln|x|+\sum\limits_{k=1}^\infty\ln\left|1-\frac{x^2}{k^2\pi^2}\right|\qquad x\neq m\pi,m\in\mathbb Z
        $$
        А теперь мы хотим продифференцировать это:
        $$
        \cot x=\frac1x+\sum\limits_{k=1}^\infty\frac{-\frac{2x}{k^2\pi^2}}{1-\frac{x^2}{k^2\pi^2}}=\frac1x-\sum\limits_{k=1}^\infty\frac{2x}{k^2\pi^2-x^2}
        $$
        Но надо показать, что дифференцирование легально, то есть что ряд справа равномерно сходится хотя бы в окрестности каждой точки, где определён. То есть пусть $m\pi<a<x<b<(m+1)\pi$, и нам надо доказать, что ряд равномерно сходится на $[a;b]$. Для этого докажем, что остаток этого ряда равномерно сходится. Возьмём такое $M$, что $M\pi>\max\{|a|,|b|\}=A$, тогда все знаменатели положительны.\\
        Отсюда для $k>M$
        $$
        \left|\frac{2x}{k^2\pi^2-x^2}\right|\leqslant\frac{2A}{k^2\pi^2-A^2}
        $$
        А
        $$
        \sum\limits_{k=M+1}^\infty\frac{2A}{k^2\pi^2-A^2}<+\infty
        $$
        А отсюда остаток продифференцированного ряда сходится на $[a;b]$ по \hyperref[Признак Вейерштрасса]{признаку Вейерштрасса}. Правда, наша формула не содержит простых дробей, давайте упростим её:
        $$
        \cot x=\frac1x-\sum\limits_{k=1}^\infty\frac{2x}{k^2\pi^2-x^2}=\frac1x+\sum\limits_{k=1}^\infty\left(\frac1{x-k\pi}+\frac1{x+k\pi}\right)=\mathrm{v.p.}\sum\limits_{k=-\infty}^\infty\frac1{x-k\pi}
        $$
    \end{proof}
    \begin{corollary}
        Продифференцировав разложение котангенса, получим
        $$
        \frac1{\sin^2x}=\sum\limits_{k=-\infty}^\infty\frac1{(x-k\pi)^2}
        $$
        Дифференцировать можно по тем же причинам, что и можно было в доказательстве теоремы.
    \end{corollary}
    \begin{corollary}
        $$
        \tan x=-\cot\left(x-\frac\pi2\right)=-\mathrm{v.p.}\sum\limits_{k=-\infty}^\infty\frac1{x-\left(k+\frac12\right)\pi}
        $$
    \end{corollary}
    \begin{remark}
        Всё вышеописанное верно и для $x\in\mathbb C$.
    \end{remark}
    \begin{definition}
        Функция
        $$
        \zeta(s)=\sum\limits_{n=1}^\infty\frac1{n^s}\qquad s>1
        $$
        называется \textbf{$\zeta$-функцией Римана} (и вообще она определена для $\Re s>1$), но это нам не важно.
    \end{definition}
    \begin{theorem}
        $$
        -\frac{2\zeta(2k)}{\pi^{2k}}=(-1)^k\frac{2^{2k}B_{2k}}{(2k)!}
        $$
    \end{theorem}
    \begin{proof}
        $$
        z\cot z=1-\sum\limits_{n=1}^\infty\frac{2z^2}{n^2\pi^2-z^2}
        $$
        Но мы же уже получали разложение $z\cot z$ в ряд с числами Бернулли. Давайте вот это чудо разложим честно в степенной ряд и увидим, что получится.
        $$
        z\cot z=1-\sum\limits_{n=1}^\infty\frac{2z^2}{n^2\pi^2-z^2}=2\sum\limits_{n=1}^\infty\frac{\frac{z^2}{n^2\pi^2}}{1-\left(\frac{z^2}{n^2\pi^2}\right)}\underset{|z|<\pi}{=}2\sum\limits_{n=1}^\infty\sum\limits_{k=1}^\infty\left(\frac z{n\pi}\right)^{2k}=2\sum\limits_{k=1}^\infty\sum\limits_{n=1}^\infty\left(\frac z{n\pi}\right)^{2k}=2\sum\limits_{k=1}^\infty\left(\sum\limits_{n=1}^\infty\frac1{n^{2k}}\right)\frac{z^{2k}}{\pi^{2k}}
        $$
        Почему мы можем менять порядок суммирования? А потому что это можно интерпретировать как сумму семейства. А сумма модулей семейства у нас получается конечной, а значит всё можно.\\
        Итак, два разложения
        $$
        1-\sum\limits_{k=1}^\infty2\zeta(2k)\frac{z^{2k}}{\pi^{2k}}=\sum\limits_{k=0}^\infty(-1)^k\frac{2^{2k}B_{2k}}{(2k)!}z^{2k}
        $$
        А отсюда
        $$
        -\frac{2\zeta(2k)}{\pi^{2k}}=(-1)^k\frac{2^{2k}B_{2k}}{(2k)!}
        $$
    \end{proof}
    \begin{corollary}
        $$
        B_{2k}=(-1)^{k-1}\frac{(2k)!\zeta(2k)}{2^{2k-1}\pi^{2k}}
        $$
        А отсюда, во-первых, $B_{2k}$ чередуют знак, а, во-вторых, $B_{2k}\underset{k\to\infty}\longrightarrow\infty$ (из того, что $\zeta(2k)\to1$).
    \end{corollary}
    \begin{corollary}
        $$
        \zeta(2k)=(-1)^k\frac{2^{2k-1}\pi^{2k}B_{2k}}{(2k)!}
        $$
    \end{corollary}
    \begin{corollary}
        Зная $B_2=\frac16$, $B_4=-\frac1{30}$, $B_6=\frac1{42}$, получим
        $$
        \sum\limits_{n=1}^\infty\frac1{n^2}=\frac{\pi^2}6
        $$
        $$
        \sum\limits_{n=1}^\infty\frac1{n^4}=\frac{\pi^4}{90}
        $$
        $$
        \sum\limits_{n=1}^\infty\frac1{n^6}=\frac{\pi^6}{945}
        $$
    \end{corollary}
    \begin{corollary}
        $$
        \sum\limits_{n=0}^\infty\frac1{(2n+1)^2}=\sum\limits_{n=1}^\infty\frac1{n^2}-\sum\limits_{k=1}^\infty\frac1{(2k)^2}=\frac34\sum\limits_{n=1}^\infty\frac1{n^2}=\frac{\pi^2}8
        $$
    \end{corollary}
    \begin{remark}
        Способ, которым мы доказали знакочередование $B_{2k}$ явно не самый простой. Проще было бы взять $y=\tan x$ и решить диффур $y'=1+y^2$, рекуррентно выясняя его коэффициенты разложения в ряд.
    \end{remark}
    \begin{claim}[Связь $\zeta$-функции и простых чисел]
        Пусть $p_k$~--- $k$-тое простое число. (Т.е. $p_1=2$, $p_2=3$ и т.д.)
    \end{claim}
    \begin{proof}
        Рассмотрим
        $$
        \prod\limits_{k=1}^\infty\frac1{1-p_k^{-s}}\qquad s>1
        $$
        При $s>1$ произведение сойдётся. Для доказательства этого перейдём к логарифму:
        $$
        \sum\limits_{k=1}^\infty\underbrace{-\ln\left(1-\frac1{p_k^s}\right)}_{\sim\frac1{p_k^s}\leqslant\frac1{k^s}}
        $$
        Поскольку
        $$
        \frac1{1-z}=\sum\limits_{\nu=0}^\infty z^\nu\qquad |z|<1
        $$
        верно следующее:
        $$
        \frac1{1-p_k^{-s}}=\sum\limits_{\nu=0}^\infty p_k^{-s\nu}
        $$
        Рассмотрим частичные произведения
        $$
        \prod\limits_{k=1}^N\frac1{1-p_k^{-s}}=\prod\limits_{k=1}^N\sum\limits_{\nu=0}^\infty p_k^{-s\nu}
        $$
        Теперь что это такое вообще? Если взять это произведение из сумм и раскрыть в нём скобки, то получится сумма слагаемых какого-то такого вида:
        $$
        \frac1{\left(p_1^{\nu_1}\cdot\cdots\cdot p_N^{\nu_N}\right)^s}
        $$
        То есть сюда входят такие числа, что в их разложении на простые есть только первые $N$ простых (в каких-то степенях). Это как минимум первые $N$ натуральных чисел и ещё какие-то. То есть получим
        $$
        \sum\limits_{n=1}^N\frac1{n^s}+\underbrace{{\sum\limits_{n=N+1}^\infty}^*\frac1{n^s}}_{\text{какие-то слагаемые пропущены}}\underset{N\to\infty}\longrightarrow\sum\limits_{n=1}^\infty\frac1{n^s}
        $$
        А что при $s=1$? Там $\sum\limits_{n=1}^N\frac1{n^s}$ стремится к $+\infty$, а значит, $\prod\limits_{k=1}^\infty\frac1{1-p_k^{-1}}$, как строко больший его, расходится к $+\infty$, а отсюда и ряд обратных простых чисел расходится к $+\infty$.
    \end{proof}
    \begin{remark}
        Отсюда можно сделать вывод, что простые числа достаточно часто встречаются в натуральном ряде. Но как это <<достаточно часто>> оценить?
    \end{remark}
    \begin{definition}
        $\pi(x)$~--- количество простых чисел меньше либо равных $x$.
    \end{definition}
    \begin{theorem}
        $$
        \pi(x)\sim\frac x{\ln x}
        $$
    \end{theorem}
    \begin{remark}
        Вот эта теорема уже совсем сложная. Первый, кто что-то с этим сделал, был Чебышёв (он доказал, что $\pi(x)=\Theta\left(\frac x{\ln x}\right)$). А равносильность была доказана существенна позднее.
    \end{remark}
    \begin{remark}
        Вернёмся к $\zeta(s)$. Мы знаем, что
        $$
        \zeta(s)=\sum\limits_{n=1}^\infty\frac1{n^s}
        $$
        Мы знаем это для $s>1$, когда определим комплексную степень, выясним, что это верно при $\Re s>1$, а дальше она аналитически продолжается на $\mathbb C\setminus\{1\}$.\\
        После продолжения оказывается, что в точках $-2,-4,\ldots$ эта функция имеет нули (они называются \textbf{тривиальными нулями}), а гипотеза Римана заключается в том, что все нетривиальные нули лежат на прямой $\Re z=\frac12$.
    \end{remark}
    \paragraph{Многочлены Бернулли.}
    \begin{definition}
        $$
        \frac{ze^{xz}}{e^z-1}=\sum\limits_{k=0}^\infty\frac{\scriptB_k(x)}{k!}z^k\qquad |z|<2\pi
        $$
        Здесь $\scriptB$ называются \textbf{многочленами Бернулли}.
    \end{definition}
    \begin{theorem}
        Многочлены Бернулли действительно являются многочленами
    \end{theorem}
    \begin{proof}
        $$
        \frac{ze^{xz}}{e^z-1}=\sum\limits_{k=0}^\infty\frac{\scriptB_k(x)}{k!}z^k\qquad |z|<2\pi
        $$
        Что равносильно
        $$
        \left(\sum\limits_{k=0}^\infty\frac{x^kz^k}{k!}\right)\left(\sum\limits_{j=0}^\infty\frac{B_j}{j!}z^j\right)=\sum\limits_{k=0}^\infty\frac{\scriptB_k(x)}{k!}z^k\qquad |z|<2\pi
        $$
        А отсюда
        $$
        \sum\limits_{l=0}^k\frac{x^l}{l!}\frac{B_{k-l}}{(k-l)!}=\frac{\scriptB_k(x)}{k!}
        $$
        И это правда многочлены:
        $$
        \scriptB_k(x)=\sum\limits_{l=0}^k\Cnk klB_{k-l}x^l
        $$
    \end{proof}
    \begin{property}
        $$
        \scriptB_k(0)=B_k
        $$
    \end{property}
    \begin{property}
        $$
        \scriptB_k'(x)=k\scriptB_{k-1}(x)\qquad k\in\mathbb N
        $$
    \end{property}
    \begin{proof}
        $$
        \scriptB_k'(x)=\sum\limits_{l=1}^k\Cnk kl B_{k-l}lx^{l-1}\overset{l=j+1}=\sum\limits_{l=1}^k\Cnk k{j+1} B_{k-j-1}(j+1)x^j
        $$
        При этом $(j+1)\Cnk k{j+1}=k\Cnk{k-1}j$, а значит
        $$
        \scriptB_k'(x)=\sum\limits_{l=1}^kk\Cnk{k-1}jB_{k-j-1}x^j=k\scriptB_{k-1}(x)
        $$
    \end{proof}
    \begin{corollary}
        $$
        \scriptB_k(x)=B_k+k\int\limits_0^x\scriptB_{k-1}(t)~\mathrm dt
        $$
    \end{corollary}
    \begin{example}
        \begin{itemize}
            \item $\scriptB_0(x)=1$.
            \item $\scriptB_1(x)=x-\frac12$.
            \item $\scriptB_2(x)=x^2-x+\frac16$.
            \item $\scriptB_3(x)=x^3-\frac32x^2+\frac12x$.
            \item $\scriptB_4(x)=x^4-2x^3+x^2-\frac1{30}$.
            \item $\scriptB_5(x)=x^5-\frac52x^4+\frac53x^3-\frac16x$.
            \item $\scriptB_6(x)=x^6-3x^5+\frac52x^4-\frac12x^2+\frac1{42}$.
        \end{itemize}
    \end{example}
    \begin{property}
        $$
        \scriptB_k(1-x)=(-1)^k\scriptB_k(x)
        $$
    \end{property}
    \begin{proof}
        $$
        \frac{ze^{(1-x)z}}{e^z-1}=e^{-xz}\frac z{1-e^{-z}}=\frac{(-z)e^{x(-z)}}{e^{-z}-1}
        $$
        Запишем равенство коэффициентов при $x^k$:
        $$
        \frac{\scriptB_k(1-z)}{k!}=\frac{\scriptB_k(x)}{k!}(-1)^k
        $$
    \end{proof}
    \begin{property}
        $$\scriptB_k(1/2)=-\left(1-\frac1{2^{k-1}}\right)B_k\qquad k\in\mathbb Z_+$$
    \end{property}
    \begin{proof}
        $$
        \frac{ze^{z/2}}{e^z-1}=\frac{z(e^{z/2}+1)}{e^z-1}-\frac z{e^z-1}=\frac{z}{e^{z/2}-1}-\frac z{e^z-1}=2\frac{z/2}{e^{z/2}-1}-\frac z{e^z-1}
        $$
        Это (без учёта факториалов)
        $$
        \scriptB_k(1/2)=2B_k\frac1{2^k}-B_k=-\left(1-\frac1{2^{k-1}}\right)B_k
        $$
    \end{proof}
    \begin{property}[Нули и знаки $\scriptB_{2m+1}$]
        $$
        (-1)^m\scriptB_{2m+1}(x)\begin{cases}
            <0&x\in\left(0;\frac12\right)\\
            >0&x\in\left(\frac12;1\right)
        \end{cases}
        \qquad m\in\mathbb Z_+$$
        При этом если $m\in\mathbb N$, то $\scriptB_{2m+1}$ имеет своими нулями $0$, $\frac12$ и $1$ (и только их).
    \end{property}
    \begin{proof}
        Всё про нули следует из свойств 1, 3 и 4.\\
        Знаки докажем по индукции. База ($m=0$)~--- ясно. Переход $m-1\mapsto m\in\mathbb N$: продифференцируем $(-1)^m\scriptB_{2m+1}(x)$ дважды:
        $$
        (-1)^m(2m+1)2m\scriptB_{2m-1}(x)\begin{cases}
            >0&x\in\left(0;\frac12\right)\\
            <0&x\in\left(\frac12;1\right)
        \end{cases}
        $$
        Также мы уже знаем про нули, а значит нами получено, что $(-1)^m\scriptB_{2m+1}$ выпукла вниз на $\left[0;\frac12\right]$ и выпукла вверх $\left[\frac12;1\right]$. При этом на концах $0$, а определение выпуклости~--- график ниже/выше хорды.
    \end{proof}
    \begin{property}[Нули и знаки $Y_{2m}(x)=\scriptB_{2m}(x)-B_{2m}$]
        $$
        Y_{2m}(0)=Y_{2m}(1)=0\qquad \forall x\in(0;1)~(-1)^mY_{2m}(x)>0
        $$
    \end{property}
    \begin{proof}
        Нули~--- из свойств 1 и 3.\\
        Положительность: ну, давайте продиффаем что-ли.
        $$
        ((-1)^mY_{2m}(x))'=(-1)^m2m\scriptB_{2m-1}(x)\begin{cases}
            >0&x\in\left(0;\frac12\right)\\
            <0&x\in\left(\frac12;1\right)
        \end{cases}
        $$
        Ну, так и всё, как надо, она санчала возрастает, потом убывает. А на концах $0$.
    \end{proof}
    \begin{example}
        \begin{figure}[H]
            % TODO: fix
            \begin{tikzpicture}
                \begin{axis}[
                        width = 3cm,
                        height = 3cm,
                        grid = none,
                        xmin = 0,
                        xmax = 1,
                        ymin = -.5,
                        ymax = .5,
                        axis equal,
                        axis x line = middle,
                        axis y line = middle,
                        axis line style = {->},
                        xtick distance=0.5,
                        ytick distance=0.5
                    ]
                    \addplot[domain=0:1,samples=2]{x-0.5};
                \end{axis}
            \end{tikzpicture}
            \begin{tikzpicture}
                \begin{axis}[
                        width = 3cm,
                        height = 3cm,
                        grid = none,
                        xmin = 0,
                        xmax = 1,
                        ymin = -1/12,
                        ymax = 1/6,
                        axis x line = middle,
                        axis y line = middle,
                        axis line style = {->},
                        xtick distance=0.5,
                        ytick distance=1/12,
                        yticklabels = {,$-1/12$,0,$1/12$,$1/6$}
                    ]
                    \addplot[domain=0:1,samples=100]{x^2-x+1/6};
                \end{axis}
            \end{tikzpicture}
            \begin{tikzpicture}
                \begin{axis}[
                        width = 3cm,
                        height = 3cm,
                        grid = none,
                        xmin = 0,
                        xmax = 1,
                        ymin = -sqrt(3)/36,
                        ymax = sqrt(3)/36,
                        axis x line = middle,
                        axis y line = middle,
                        axis line style = {->},
                        xtick distance=0.5,
                        ytick distance=sqrt(3)/36,
                        yticklabels={,$\frac{-\sqrt3}{36}$,0,$\frac{\sqrt3}{36}$},
                    ]
                    \addplot[domain=0:1,samples=100]{x^3-3/2*x^2+x/2};
                \end{axis}
            \end{tikzpicture}
        \end{figure}
    \end{example}
    \begin{property}
        Без доказательства
        $$
        \scriptB_k(mx)=m^{k-1}\sum\limits_{j=0}^{m-1}B_k\left(x+\frac jm\right)\qquad k\in\mathbb Z_+,m\in\mathbb N
        $$
    \end{property}
    \begin{property}
        $$
        \scriptB_k(x+1)-\scriptB_k(x)=kx^{k-1}\qquad k\in\mathbb Z_+
        $$
    \end{property}
    \begin{proof}
        $$
        \frac{ze^{(x+1)z}}{e^z-1}-\frac{ze^{xz}}{e^z-1}=ze^{xz}=\sum\limits_{k=0}^\infty\frac{x^k}{k!}z^{k+1}=\sum\limits_{k=0}^\infty\frac{x^{k-1}}{(k-1)!}z^k=\sum\limits_{k=0}^\infty kx^{k-1}\frac{z^k}{k!}
        $$
    \end{proof}
    \begin{remark}
        Теперь к чему вообще Бернулли свои числа и многочлены придумал? А к тому, чтобы считать суммы степеней первых $n$ натуральных чисел.
    \end{remark}
    \begin{property}
        $$
        \sum\limits_{\nu=0}^{n-1}\nu^p=\frac{\scriptB_{p+1}(n)-B_{p+1}}{p+1}
        $$
    \end{property}
    \begin{proof}
        $$
        \sum\limits_{\nu=0}^{n-1}\nu^p=\sum\limits_{\nu=0}^{n-1}\frac{\scriptB_{p+1}(\nu+1)-\scriptB_{p+1}(\nu)}{p+1}=\frac{\scriptB_{p+1}(n)-B_{p+1}}{p+1}
        $$
    \end{proof}
    \begin{property}
        $$
        \sum\limits_{\nu=0}^{n-1}\nu^p=\frac1{p+1}\sum\limits_{k=1}^{p+1}\Cnk{p+1}kB_{p+1-k}n^k
        $$
    \end{property}
    \begin{theorem}[Разложение функции по многочленам Бернулли]
        \label{Разложение по многочленам Бернулли}
        Пусть $r\in\mathbb N$, $f\in C^{(r)}[a;b]$, $x\in[a;b]$. Тогда
        $$
        f(x)=\frac1{b-a}\int\limits_a^bf+\sum\limits_{k=1}^r\frac{(b-a)^{k-1}}{k!}f^{(k-1)}\bigg|_a^b\scriptB_k\left(\frac{x-a}{b-a}\right)-\frac{(b-a)^{r-1}}{r!}\int\limits_a^bf^{(r)}(t)\scriptB^*_r\left(\frac{x-t}{b-a}\right)~\mathrm dt
        $$
        где $\scriptB^*_r$~--- 1-периодическая функция, совпадающая с $\scriptB_r$ на $(0;1)$. (Как она определена на концах, не важно, ведь мы интегрируем.)
    \end{theorem}
    \begin{proof}
        Для начала сделаем линейную замену переменной, сведя $[a;b]$ к $[0;1]$. Была $f$, стала $\varphi$, была $x$, стала $\xi$, была $t$, стала $\tau$:
        $$
        x=a+(b-a)\xi\qquad\xi=\frac{x-a}{b-a}
        $$
        $$
        t=a+(b-a)\tau\qquad\tau=\frac{t-a}{b-a}\qquad\mathrm dt=(b-a)\mathrm d\tau
        $$
        $$
        f(x)=\varphi(\xi)
        $$
        Итого:
        $$
        \varphi(\xi)=\overbrace{\frac1{b-a}}^{\text{уходит из замены в интеграле}}\int\limits_a^bf+\sum\limits_{k=1}^r\frac{\overbrace{(b-a)^{k-1}}^{\text{уходит от производных}}}{k!}\varphi^{(k-1)}\bigg|_0^1\scriptB_k(\xi)-\frac{\overbrace{(b-a)^{r-1}}^{\substack{\text{уходит от производной,}\\\text{лишнее }(b-a)\text{ уходит в интеграл}}}}{r!}\int\limits_0^1f^{(r)}(\tau)\scriptB^*_r\left(\xi-\tau\right)~\mathrm d\tau
        $$
        Вернём обозначения:
        $$
        f(x)=\int\limits_0^1f+\sum\limits_{k=1}^r\frac1{k!}f^{(k-1)}\bigg|_0^1\scriptB_k(x)-\frac1{r!}\int\limits_0^1f^{(r)}(t)\scriptB^*_r(x-t)~\mathrm dt
        $$
        Пусть $r\geqslant 2$. Пусть
        $$
        \rho_r=\frac1{r!}\int\limits_0^1f^{(r)}(t)\scriptB_r^*(x-t)~\mathrm dt=\frac1{r!}f^{(r-1)}(t)\scriptB_r^*(x-t)\bigg|_{t=0}^1-\frac1{r!}\int\limits_0^1f^{(r-1)}(t)(\scriptB_r^*(x-t))'_t~\mathrm dt=\frac1{r!}f^{(r-1)}\bigg|_0^1\scriptB_r(x)+\rho_{r-1}
        $$
        Сделав это ещё кучу раз, получим
        $$
        \rho_r=\sum\limits_{k=2}^r\frac1{k!}f^{(k-1)}\bigg|_0^1\scriptB_k(x)+\rho_1
        $$
        Осталось посчитать $\rho_1$.
        \[
        \begin{split}
            \rho_1&=\int\limits_0^1f'(t)\scriptB_1^*(x-t)~\mathrm dt=\int\limits_0^xf'(t)\scriptB_1(x-t)~\mathrm dt+\int\limits_x^1f'(t)\scriptB_1(x-t+1)~\mathrm dt\overset{\scriptB_1(u)=u-\frac12}=\\
            &=f(t)\scriptB_1(x-t)\bigg|_{t=0}^x+\int\limits_0^xf+f(t)\scriptB_1(x-t+1)\bigg|_{t=x}^1+\int\limits_x^1f
        \end{split}
        \]
        Чтобы это красиво посчитать, надо подставлять в $\scriptB_1$ в одном месте 0, в другом~--- 1 (это даст нам $f\big|_0^1$), в потом в одном и в другом месте $x$. Итого
        $$
        \rho_1=f\bigg|_0^1\scriptB_1(x)-f(x)+\int\limits_0^1f
        $$
    \end{proof}
    \begin{remark}
        $r$-тое слагаемое в сумме можно включить в остаток, но это бывает удобно с переменным успехом. Получится:
        $$
        f(x)=\frac1{b-a}\int\limits_a^bf+\sum\limits_{k=1}^{r-1}\frac{(b-a)^{k-1}}{k!}f^{(k-1)}\bigg|_a^b\scriptB_k\left(\frac{x-a}{b-a}\right)-\frac{(b-a)^{r-1}}{r!}\int\limits_a^bf^{(r)}(t)\left(\scriptB^*_r\left(\frac{x-t}{b-a}\right)-\scriptB_r\left(\frac{x-a}{b-a}\right)\right)~\mathrm dt
        $$
    \end{remark}
    \begin{remark}
        Начальное слагаемое можно включить в сумму (в сумме получится двойная подстановка минус первой производной; не интеграл ли это). Опять же, не всегда нужно.
    \end{remark}
    \begin{corollary}
        \label{cor:разложение по бернулли,1}
        В условиях теоремы \ref{Разложение по многочленам Бернулли} при $r-1\in\mathbb N$.
        При $x=a$ формула обращается в
        $$
        %f(a)=\frac1{b-a}\int\limits_a^bf+\sum\limits_{k=1}^r\frac{(b-a)^{k-1}}{k!}f^{(k-1)}\bigg|_a^b\scriptB_k(0)-\frac{(b-a)^{r-1}}{r!}\int\limits_a^bf^{(r)}(t)\scriptB^*_r\underbrace{\left(\frac{a-t}{b-a}\right)}_{\scriptB_r\left(\frac{b-t}{b-a}\right)}~\mathrm dt
        \int\limits_a^bf=(b-a)\frac{f(b)+f(a)}2-\sum\limits_{k=2}^{r-1}\frac{(b-a)^kB_k}{k!}f^{(k-1)}\bigg|_a^b+\frac{(b-a)^r}{r!}\int\limits_a^bf^{(r)}(t)\left(\scriptB_r\left(\frac{b-t}{b-a}\right)-B_r\right)~\mathrm dt
        $$
    \end{corollary}
    \begin{remark}
        Настало время говорить о численном интегрировании. Самый простой способ~--- взять $x\in[a;b]$ и взять прямоугольник $f(x)(b-a)$. Но вот насколько это будет точно~--- мы можем посмотреть посмотреть на нашу формулу. В равенство это обращается для левого и правого прямоугольника на константах, а для среднего прямоугольника~--- на линейных функциях.\\
        Есть способ с трапецией: $(b-a)\frac{f(b)+f(a)}2$ (это уже то, что написано в следствии). И опять же оно обращается в равенство на линейный функциях. А значит остаток выражается через вторую производную (и мы даже видим, что это согласуется с формулой).\\
        А как бы построить формулу, которая обращается в равенство на многочленах более высокой степени? Первый способ~--- увеличить количество узлов и подбирать коэффициенты. Но у нас тут получился второй способ: не увеличивая количество узлов мы добавили что-то, зависящее от производной. И результат тот же: точная формула для многочленов $r$-той степени. Но есть ещё способ:...
    \end{remark}
    \begin{remark}
        Остаток можно записать в виде
        $$
        \frac{(b-a)^{r+1}}{r!}\int\limits_0^1f^{(r)}(a+(b-a)\tau)(\scriptB_r(1-\tau)-B_r)~\mathrm d\tau
        $$
    \end{remark}
    \begin{theorem}[Формула Эйлера~--- Маклорена]
        Пусть $r-1\in\mathbb N$, $f\in C^{(r)}[a;b]$, $n\in\mathbb N$. Пусть $h=\frac{b-a}n$. Тогда
        $$
        \int\limits_a^bf=h\left(\frac{f(a)}2+\sum\limits_{\nu=1}^{n-1}f(a+\nu h)+\frac{f(b)}2\right)-\sum\limits_{k=2}^{r-1}\frac{h^kB_k}{k!}f^{(k-1)}\bigg|_a^b+\frac{h^{r+1}}{r!}\int\limits_0^1(\scriptB_r(1-\tau)-B_r)\sum\limits_{\nu=0}^{n-1}f^{(r)}(a+\nu h+h\tau)~\mathrm d\tau
        $$
    \end{theorem}
    \begin{proof}
        Применить следствие \ref{cor:разложение по бернулли,1} с записью остатка из замечания выше выше к отрезам $[a+\nu h;a+(\nu+1)h]$ и сложить по $\nu\in[0:n-1]$.
    \end{proof}
    \begin{remark}
        Это~--- уточнение формулы трапеции.
    \end{remark}
    \begin{remark}
        Это чудо тоже позволяет приближённо вычислять интегралы. Но с другой стороны, мы можем прочитать равенство с обратной стороны. Это формула приближённого вычисления сумм: интеграл ведь проще суммы:
        $$
        \sum\limits_{\nu=0}^{n-1}f(a+\nu h)=\frac1h\int\limits_a^bf+\sum\limits_{k=1}^{r-1}\frac{h^{k-1}}{k!}B_kf^{(k-1)}\bigg|_a^b-\underbrace{\frac{h^r}{r!}\int\limits_0^1(\scriptB_r(1-\tau)-B_r)\sum\limits_{\nu=0}^{n-1}f^{(r)}(a+\nu h+h\tau)~\mathrm d\tau}_{R_r}
        $$
        Это чудо отличается от предыдущего тем, что мы добавили $\frac{f(a)}2$ и вычли $\frac{f(b)}2$, и оно дошло до $B_1h$.
    \end{remark}
    \begin{remark}
        Обычно это применяется при $r\divby2$. Как мы знаем, при таких $r$ функция $\scriptB_r(1-\tau)-B_r$ сохраняет знак, и с ней легче работать. Но давайте всё же полностью перепишем формулу при $r=2q$:
        $$
        \sum\limits_{\nu=0}^{n-1}f(a+\nu h)=\frac1h\int\limits_a^bf-\frac{f(b)-f(a)}2+\sum\limits_{k=1}^{q-1}\frac{h^{2k-1}}{k!}B_{2k}f^{(2k-1)}\bigg|_a^b-R_{2q}
        $$
    \end{remark}
    \begin{corollary}
        Пусть, $q\in\mathbb N$, $f\in C^{(2q+2)}[a;b]$. Пусть $f^{(2q)}$ и $f^{(2q+2)}$ нестрого одного знака. Тогда остаток совпадает по знаку с первом отброшенным членом и не превосходит его по модулю:
        $$
        \sign(-R_{2q})=(-1)^{q-1}\sign f^{(2q-1)}\bigg|_a^b\qquad\text{и}\qquad|R_{2q}|\leqslant\frac{h^{2q-1}|B_{2q}|}{(2q)!}\left|f^{(2q-1)}\bigg|_a^b\right|
        $$
    \end{corollary}
    \begin{proof}
        Почему так? Мы выводили, что
        $$
        \scriptB_{2q}(1-\tau)-B_{2q}=B_{2q}(\tau)-B_{2q}=Y_{2q}(\tau)
        $$
        А $(-1)^qY_{2q}(\tau)>0$ на $(0;1)$. Отсюда знаки $R_{2q}$ и $R_{2q+2}$ противоположны. При этом
        $$
        -R_{2q}+R_{2q+2}=\frac{h^{2q-1}B_{2q}}{(2q)!}f^{(2q-1)}\bigg|_a^b
        $$
        И отсюда, из-за того, что знаки $R_{2q+2}$ и $-R_{2q}$ совпадают, каждое по модулю не больше правой части.
    \end{proof}
    \begin{example}
        $$
        \pi^2=6\sum\limits_{\nu=1}^\infty\frac1{\nu^2}
        $$
        Пусть $f(x)=\frac1{x^2}$, $h=1$, $n,a\in\mathbb N$, их мы выберем какие-то потом, $b=a+n$. Тогда
        $$
        f^{(l)}=\frac{(-1)^l(l+1)!}{x^{l+2}}
        $$
        Действительно, все чётные производные положительны. То есть
        $$
        \sum\limits_{\nu=0}^{n-1}\frac1{(a+\nu)^2}=\int\limits_a^{a+n}\frac{\mathrm dx}{x^2}-\frac12\left(\frac1{(a+n)^2}-\frac1{a^2}\right)+\sum\limits_{k=1}^{q-1}\frac{B_{2k}}{(2k)!}(-(2k)!)\left(\frac1{(a+n)^{2k+1}}-\frac1{a^{2k+1}}\right)+\theta_nB_{2q}\left(\frac{-1}{(a+n)^{2q+1}}+\frac1{a^{2q+1}}\right)
        $$
        Где $\theta_n$~--- какое-то число $\in[0;1]$. Теперь устремим $n$ у бесконечности. И пусть $\theta_n$ имеет своим пределом $\theta\in[0;1]$. Что будет, когда устремим?
        $$
        \sum\limits_{\nu=0}^\infty\frac1{(a+\nu)^2}=\frac1a+\frac1{2a^2}+\sum\limits_{k=1}^{q-1}\frac{B_{2k}}{a^{2k+1}}+\theta\frac{B_{2q}}{a^{2q+1}}
        $$
        Пусть $a=q=10$. Получим
        $$
        \sum\limits_{l=1}^\infty\frac1{l^2}=\sum\limits_{l=1}^9\frac1{l^2}+\sum\limits_{\nu=0}^\infty\frac1{(10+\nu)^2}
        $$
        Оценив правую штуку 20 слагаемыми, получим, что точность у нас
        $$
        6\left|\frac{B_{2q}}{10^{2q+1}}\right|<\frac12\times10^{-17}
        $$
        Чтобы получить такую же точность, считая сумму ряда в лоб, надо взять сколько слагаемых? Ну, пусть $N$. Тогда
        $$
        6\sum\limits_{\nu=N+1}^{\infty}\frac1{\nu^2}<\frac12\times10^{-17}
        $$
        Но при этом
        $$
        6\sum\limits_{\nu=N+1}^{\infty}\frac1{\nu^2}>6\int\limits_{N+1}^{\infty}\frac{\mathrm dx}{x^2}=\frac6{N+1}
        $$
        $N>10^{18}$ получится.
    \end{example}
    \begin{corollary}
        Пусть $f\in C^{(2q+2)}[a;+\infty)$, $f^{(2k)}$ все одного знака, $f^{(2k-1)}(x)\underset{x\to+\infty}\longrightarrow0$. Тогда
        $$
        \sum\limits_{\nu=0}^{n-1}f(a+\nu h)=\frac1h\int\limits_a^bf+C(a,h)-\frac{f(b)}2+\sum\limits_{k=1}^{q-1}\frac{h^{2k-1}}{B_{2k}}{k!}f^{(2k-1)}(b)-\widetilde{R_{2q}}
        $$
        Где
        $$C(a;h)=\lim\limits_{n\to\infty}\sum\limits_{\nu=0}^{n-1}f(a+\nu h)-\frac1h\int\limits_a^bf+\frac{f(b)}2$$
        При этом
        $$
        |\widetilde{R_{2q}}|\leqslant\frac{h^{2q-1}|B_{2q}|}{(2q)!}\left|f^{(2q-1)}(b)\right|
        $$
    \end{corollary}
    \begin{proof}
        Вспомним выражение
        $$
        R_{2q}=\frac{h^{2q}}{(2q)!}\int\limits_0^1Y_{2q}(\tau)\left(\sum\limits_{\nu=0}^\infty-\sum\limits_{\nu=n}^\infty\right)f^{(2q)}(a+\nu h+h\tau)~\mathrm d\tau
        $$
        А давайте возьмём нашу запись
        $$
        \sum\limits_{\nu=0}^{n-1}f(a+\nu h)=\frac1h\int\limits_a^bf-\frac{f(b)-f(a)}2+\sum\limits_{k=1}^{q-1}\frac{h^{2k-1}}{B_{2k}}{k!}f^{(2k-1)}\bigg|_a^b-R_{2q}
        $$
        и в этой записи сгруппируем отдельно слагаемые с $a$ и слагаемые с $b$. Получим
        $$
        \sum\limits_{\nu=0}^{n-1}f(a+\nu h)=\frac1h\int\limits_a^bf+C_{2q}(a,h)-\frac{f(b)}2+\sum\limits_{k=1}^{q-1}\frac{h^{2k-1}}{B_{2k}}{k!}f^{(2k-1)}(b)-\widetilde{R_{2q}}
        $$
        $$
        \widetilde{R_{2q}}=\frac{h^{2q}}{(2q)!}\int\limits_0^1Y_{2q}(\tau)\sum\limits_{\nu=0}^\infty f^{(2q)}(b+\nu h+h\tau)~\mathrm d\tau
        $$
        И теперь в этой формулке тоже устремим $n$ к $\infty$ (оно же $b$ к $\infty$). Всё, что правее $\frac{f(b)}2$ устремилось к нулю. А отсюда $C_{2q}(a;h)$~--- предел $\sum\limits_{\nu=0}^{n-1}f(a+\nu h)-\frac1h\int\limits_a^bf+\frac{f(b)}2$.
        При этом $C_{2q}(a;h)$ не зависит от $q$ (потому что это предал чего-то, не зависящего от $q$).\\
        Тогда для $\widetilde{R_{2q}}$ сохраняется Лейбницевское свойство:
        $$
        \sign\widetilde{R_{2q}}=(-1)^{q-1}\sign f^{(2k-1)}(b)
        $$
        $$
        |\widetilde{R_{2q}}|\leqslant\frac{h^{2q-1}|B_{2q}|}{(2q)!}\left|f^{(2q-1)}(b)\right|
        $$
    \end{proof}
    \begin{example}
        Рассмотрим $f(x)=\ln x$, $a=1=h$. И ещё вместо $n$ возьмём $n-1$. Тогда
        $$
        \ln n!=\sum\limits_{\nu=1}^n\ln\nu=\sum\limits_{\nu=0}^{n-2}\ln(1+\nu)+\ln n=\underbrace{n\ln n-n}_{\int\limits_1^n\ln x\mathrm dx-1}+C_1+\frac12\ln n+\sum\limits_{k=1}^{q-1}\frac{B_{2k}}{(2k)!}\frac{(2k-2)!}{n^{2k-1}}+\widetilde{R_{2q}}
        $$
        То есть
        $$
        \ln n!=\left(n+\frac12\right)\ln n-n+\ln\sqrt{2n}+\sum\limits_{k=1}^{q-1}\frac{B_{2k}}{2k(2k-1)}\frac1{n^{2k-1}}+\widetilde{R_{2q}}
        $$
        $$
        \widetilde{R_{2q}}=\theta\frac{B_{2q}}{2q(2q-1)}\frac1{n^{2q-1}}\qquad\theta\in[0;1]
        $$
        Это чудо называется рядом Стирлинга, и если применить к этому чуду экспоненту, получится разложение факториала по какой-то ебале. И частным случаем этого является формула Стирлинга. И, кстати, в неё у нас откуда-то вылезала $\frac1{12}$, и это $\frac{B_2}2$.
    \end{example}
    \section{Криволинейные интегралы на плоскости.}
    \paragraph{Определение, простейшие свойства криволинейных интегралов.}
    \subparagraph{Интеграл комплекснозначной функции.}
    \begin{remark}
        Везде дальше $z=x+\im y$ обозначает $x=\Re z$, $y=\Im z$ и для функции $f\colon D\to\mathbb C$, $f=u+\im v$ обозначает $u=\Re f$, $v=\Im f$.
    \end{remark}
    \begin{definition}
        Пусть $f\colon[a;b]\to\mathbb C$. Положим
        $$
        \int\limits_a^bf=\lim\limits_{\lambda\to0}\sum\limits_{k=0}^{n-1}f(\theta_k)\Delta t_k
        $$
        где $a=t_0<t_1<\cdots<t_n=b$~--- дробление $[a;b]$, $\theta_k\in[t_k;t_{k+1}]$~--- оснащение $t_k$, $\lambda=\max\limits_{0<k<n-1}\Delta t_k$, $\Delta t_k=t_{k+1}-t_k$.\\
        Говорят, что $f\in R[a;b]$, если предел существует и конечен.\\
        Также считаем $\int\limits_a^af=0$, $\int\limits_b^af=-\int_a^bf$.
    \end{definition}
    \begin{property}
        Функция интегрируема тогда и только тогда, когда обе её координатные функции интегрируемы. При этом
        $$
        \int\limits_a^bf=\int\limits_a^bu+\im\int\limits_a^bv
        $$
    \end{property}
    \begin{proof}
        Смотри свойства предела.
    \end{proof}
    \begin{property}
        Переносятся свойства: линейность, аддитивность по отрезку, формула Ньютона~--- Лейбница, теорема Барроу, арифметические действия, интегрируемость модуля, формула $|\int\nolimits_a^bf|\leqslant\int\nolimits_a^b|f|$.
    \end{property}
    \begin{property}
        Теорема о среднем не обязательно верна.
    \end{property}
    \begin{example}
        $$
        \int\limits_{-\pi}^\pi e^{\im t}~\mathrm dt=\int\limits_{-\pi}^\pi \cos t+\im\sin t~\mathrm dt=0
        $$
        Что не равно $2\pi e^{\im c}$ ни для какого $c$.
    \end{example}
    \begin{remark}
        Определение не имело никакой специфики комплексных чисел, можно было точно также определить интеграл функции $\mathbb R\to\mathbb R^n$:
        $$
        \int\limits_a^bf=\left(\int\limits_a^bf_1;\ldots;\int\limits_a^bf_n\right)
        $$
    \end{remark}
    \begin{definition}
        Пусть $P,Q\colon\underset{D}{\subset\mathbb R^2}\to\mathbb R$ или $\mathbb C$. Тогда функция $\omega\colon\substack{D\times\mathbb R^2\to\mathbb R(\mathbb C)\\((x;y);(\mathrm dx;\mathrm dy))\mapsto P(x;y)\mathrm dx+Q(x;y)\mathrm dy}$ называется \textbf{вещественной дифференциальной формой}.
    \end{definition}
    \begin{remark}
        На то, что вторая пара аргументов обозначена $(\mathrm dx;\mathrm dy)$? Да просто так! Но потом мы поймём, почему это удобно.\\
        Также впоследствии краткости записи ради мы будем писать $\omega=P\mathrm dx+Q\mathrm dy$.
    \end{remark}
    \begin{definition}
        Пусть $f\colon\underset{D}{\subset\mathbb C}\to\mathbb C$. Тогда $\omega\colon\substack{D\times\mathbb C\to\mathbb C\\(z;\mathrm dz)\mapsto f(z)\mathrm dz}$
    \end{definition}
    \begin{claim}
        Всякая комплексная форма можем быть записана в вещественном виде:
        $$
        f\mathrm dz=(u+\im v)\mathrm dx+(\im u-v)\mathrm dy
        $$
        Обратное неверно.
    \end{claim}
    \begin{remark}
        Что такое линейная комплексная переменная? Это $z\mapsto Az$, где $z=x+\im y$, $A=a+\im b$, и $Az=(a+\im b)x+(\im a-b)y=\underbrace{ax-by}_\alpha+\im\underbrace{(bx+ay)}_\beta$. Пы получили, что у нас преобразование~--- это матрица $\matr{a&-b\\b&a}$. А произвольная вещественная форма~--- рандомная матрица, а не конкретно такого вида.
    \end{remark}
    \begin{definition}
        \label{dfn: Удобное определение интеграла вещественной формы}
        Пусть $\gamma(\varphi;\psi)$~--- путь $[a;b]\to\mathbb R^2(\mathbb C)$. Пусть $\gamma^*=\gamma([a;b])$. Пусть $P,Q\colon\gamma^*\to\mathbb R(\mathbb C)$. Пусть $\omega=P\mathrm dx+Q\mathrm dy$. Тогда \textbf{криволинейным интегралом второго рода} от формы $\omega$ по пути $\gamma$ называется
        $$
        \lim\limits_{\lambda\to0}\sum\limits_{k=0}^{n-1}\left(P(\xi_k;\eta_k)\Delta x_k+Q(\xi_k;\eta_k)\Delta y_k\right)
        $$
        Где
        $$
        a<t_0<\cdots<t_n=b\qquad\Delta t_k=t_{k+1}-t_k\qquad\lambda=\max\limits_{0<k<n-1}\Delta t_k
        $$
        $$
        x_k=\varphi(t_k)\qquad y_k=\psi(t_k)\qquad\Delta x_k=x_{k+1}-x_k\qquad\Delta y_k=y_{k+1}-y_k
        $$
        $$
        \theta_k\in[t_k;t_{k+1}]\qquad\xi_k=\varphi(\theta_k)\qquad\eta_k=\psi(\theta_k)
        $$
        Обозначения:
        $$
        \int_\gamma\omega\qquad\int_\gamma P\mathrm dx+Q\mathrm dy\qquad\int_\gamma P(x;y)\mathrm dx+Q(x;y)\mathrm dy
        $$
    \end{definition}
    \begin{definition}
        \label{dfn: Удобное определение интеграла комплексной формы}
        Пусть $\gamma$~--- путь $[a;b]\to\mathbb\mathbb C$. Пусть $f\colon\gamma^*\to\mathbb C$. Пусть $\omega=f\mathrm dz$. Тогда \textbf{криволинейным интегралом второго рода} от формы $\omega$ по пути $\gamma$ называется
        $$
        \lim\limits_{\lambda\to0}\sum\limits_{k=0}^{n-1}f(\zeta_k)\Delta z_k
        $$
        Где
        $$
        a<t_0<\cdots<t_n=b\qquad\Delta t_k=t_{k+1}-t_k\qquad\lambda=\max\limits_{0<k<n-1}\Delta t_k
        $$
        $$
        z_k=\gamma(t_k)\qquad\Delta z_k=z_{k+1}-z_k
        $$
        $$
        \theta_k\in[t_k;t_{k+1}]\qquad\zeta_k=\gamma(\theta_k)
        $$
        Обозначения:
        $$
        \int_\gamma\omega\qquad\int_\gamma f\qquad\int_\gamma f\mathrm dz\qquad\int_\gamma f(z)\mathrm dz
        $$
    \end{definition}
    \begin{definition}
        Пусть $\gamma=(\varphi;\psi)\colon[a;b]\to\mathbb R(\mathbb C)$, $\gamma\in C^{(1)}[a;b]$. Пусть $P,Q\colon\gamma^*\colon\mathbb R(\mathbb C)$, $P,Q\in C(\gamma^*)$, $\omega=P\mathrm dx+Q\mathrm dy$. Положим
        $$
        \int_\gamma\omega=\int_a^bP(\varphi;\psi)\varphi'+Q(\varphi;\psi)\psi'
        $$
    \end{definition}
    \begin{definition}
        Пусть $\gamma\colon[a;b]\to\mathbb C$, $\gamma\in C^{(1)}[a;b]$. Пусть $f\colon\gamma^*\colon\mathbb C$, $f\in C(\gamma^*\to\mathbb C)$, $\omega=f\mathrm dz$. Положим
        $$
        \int_\gamma\omega=\int_\gamma f=\int_a^b(f\circ\gamma)\gamma'
        $$
    \end{definition}
    \begin{remark}
        Некоторое время мы будем жить с этими определениями, потом расширим их на кусочно-гладкие функции, а затем докажем, что второе определения является расширением первого.
    \end{remark}
    \begin{example}
        $$
        \int_\gamma\mathrm dz=\int\limits_a^b\gamma'=\gamma(b)-\gamma(a)
        $$
    \end{example}
    \begin{example}
        Пусть $z_0\in\mathbb C$, $R>0$, $\gamma(t)=\gamma_{r,z_0}(t)=\gamma_r=re^{\im t}+z_0\mid t\in[-\pi;\pi]$.\\
        Пусть $f(z)=(z-z_0)^n\mid n\in\mathbb Z$.
        $$
        \int_{\gamma_{r,z_0}}(z-z_0)^n~\mathrm dz=\int\limits_{-\pi}^\pi r^ne^{\im nt}r\im e^{\im t}~\mathrm dt=\im r^{n+1}\int\limits_{-\pi}^\pi e^{\im(n+1)t}~\mathrm dt=\begin{cases}
            0&n\neq-1\\
            2\pi\im&n=-1
        \end{cases}
        $$
    \end{example}
    \begin{property}
        $$
        \int_{\gamma^-}\omega=-\int_\gamma\omega
        $$
        Где $\gamma^-(t)=\gamma(a+b-t)$
    \end{property}
    \begin{proof}
        $$
        \int_{\gamma^-}f(z)~\mathrm dz=\int\limits_a^bf(\gamma(a+b-t))(-1)\gamma'(a+b-t)~\mathrm dt\overset{a+b-t=\tau}=-\int\limits_a^bf(\gamma(\tau))\gamma'(\tau)~\mathrm dt-\int_\gamma\omega
        $$
    \end{proof}
    \begin{property}[Линейность]
        $$
        \int_\gamma\alpha\omega_1+\beta\omega_2=\alpha\int_\gamma\omega_1+\beta\int_\gamma\omega_2
        $$
        Доказательство остаётся читателю.
    \end{property}
    \begin{property}[Независимость от параметризации]
        \label{Независимость интеграла 2 рода от параметризации}
        Пусть $u\in C^{(1)}([a;b]\to[\alpha;\beta])$~--- возрастающая сюръекция. Пусть $\gamma=\tilde\gamma\circ u$. Тогда
        $$
        \int_\gamma\omega=\int_{\tilde\gamma}\omega
        $$
        В частности, интегралы по $C^{(1)}$-эквивалентным путям равны.
    \end{property}
    \begin{remark}
        Они по просто эквивалентным путям тоже равны, мы просто не хотим доказывать через интегральные суммы.
    \end{remark}
    \begin{proof}
        $$
        \int_{\tilde\gamma}f(z)\mathrm dz=\int\limits_\alpha^\beta f(\tilde\gamma(\tau))\tilde\gamma'(\tau)~\mathrm d\tau\overset{\tau=u(t)}=\int\limits_a^b f(\gamma(t))\tilde\gamma'(u(t))u'(t)~\mathrm dt=\int\limits_a^b f(\gamma(t))\gamma'(t)~\mathrm dt=\int_{\gamma}f(z)\mathrm dz
        $$
    \end{proof}
    \begin{remark}
        Поскольку мы теперь занем, что интеграл не зависит от параметризации, мы можем определить интеграл от кривой.\\
        В частности, можно считать, что все пути заданы на отрезке $[0;1]$, и интегралы всегда можно считать заданными на таких путях.
    \end{remark}
    \begin{property}[Аддитивность по пути]
        Пусть $a<c<b$, $\gamma_1=\gamma\big|_{[a;c]}$, $\gamma_2=\gamma\big|_{[c;b]}$. Тогда
        $$
        \int_\gamma\omega=\int_{\gamma_1}\omega+\int_{\gamma_2}\omega
        $$
    \end{property}
    \begin{remark}
        Во-первых, свойство также распространяется на любое количество подотрезков.\\
        Во-вторых, определения \ref{dfn: Удобное определение интеграла вещественной формы} и \ref{dfn: Удобное определение интеграла комплексной формы} также теперь распространяются на кусочно-гладкие пути.
    \end{remark}
    \begin{definition}
        Пусть $a<c<b$, $\gamma_1$, $\gamma_2$ заданы на $[a;c]$ и $[c;b]$ соотвественно. И пусть $\gamma_1(c)=\gamma_2(c)$. Тогда \textbf{соединением путей} $\gamma_1$ и $\gamma_2$ называется путь
        $$
        \gamma_1\vee\gamma_2(t)=\gamma(t)=\begin{cases}
            \gamma_1(t)&t\in[a;c]\\
            \gamma_2(t)&t\in[c;b]\\
        \end{cases}
        $$\\\\
        Пусть $\gamma_1$, $\gamma_2$ заданы на $[a;c]$ и $[d;b]$ соотвественно и $\gamma_1(c)=\gamma_2(d)$. Соединением таких путей называется
        $$
        \gamma_1\vee\gamma_2(t)=\gamma(t)=\begin{cases}
            \gamma_1(t)&t\in[a;c]\\
            \gamma_2(t-c+d)&t\in[c;c+b-d]\\
        \end{cases}
        $$
    \end{definition}
    \begin{remark}
        Если $\gamma_1$ и $\gamma_2$ кусочно-гладкие, то $\gamma_1\vee\gamma_2$ тоже обладает этим свойством.
    \end{remark}
    \begin{definition}
        Кусочно-гладкий замкнутый путь называется \textbf{контуром}.
    \end{definition}
    \begin{property}[Интеграл по контуру]
        Интеграл по контуру не зависит от выбора начальной (она же конечная) точки контура.\\
        Более формально: пусть $a<c<b$, $\gamma$ задан на $[a;b]$, $\gamma_1=\gamma\big|_{[a;c]}$, $\gamma_1=\gamma\big|_{[c;b]}$. Тогда $\gamma=\gamma_1\vee\gamma_2$, пусть $\tilde\gamma=\gamma_2\vee\gamma_1$. В таком случае
        $$
        \int_\gamma\omega=\int_{\tilde\gamma}\omega
        $$
    \end{property}
    \begin{proof}
        Напрямую следует из аддитивности.
    \end{proof}
    \begin{example}
        Пусть $[a;b]\times[c;d]$~--- прямоугольничек. Рассмотрим его контур. Тогда $\gamma$~--- путь по этому контуру~--- можно представить как соединение 4 путей: $\gamma_1$ по нижней стороне вправо, $\gamma_2$~--- по правой стороне вверх, $\gamma_3$~--- по верней стороне влево, $\gamma_4$~--- по лево стороне вниз. Или
        $$
        \gamma_1\colon \varphi(x)=x,\psi(y)=c,x\in[a;b]\qquad\qquad\gamma_2\colon \varphi(x)=b,\psi(y)=y,y\in[c;d]
        $$
        $$
        \gamma_3^-\colon \varphi(x)=x,\psi(y)=d,y\in[a;b]\qquad\qquad\gamma_4^-\colon \varphi(x)=d,\psi(y)=y,y\in[c;d]
        $$
        Тогда
        $$
        \int_\gamma P\mathrm dx+Q\mathrm dy=\int\limits_a^bP(x;c)\mathrm dx+\int\limits_c^dP(b;y)\mathrm dy-\int\limits_a^bP(x;d)\mathrm dx-\int\limits_c^dP(a;y)\mathrm dy
        $$
    \end{example}
    \begin{remark}
        Мы обычно будем выбирать такое направление обхода, когда ограничиваемая область всё время находится <<слева>> от кривой.
    \end{remark}
    \begin{property}[Предельный переход и почленное интегрирование рядов]
        Пусть $f_n\in C(\gamma^*)$, $f_n\toto f$ на $\gamma^*$. Тогда
        $$
        \int_\gamma f_n\rightarrow\int_\gamma f
        $$
        Равномерно сходящийся ряд непрерывных на $\gamma^*$ функций можно интегрировать почленно.
    \end{property}
    \begin{proof}
        Надо доказать лишь то, что
        $$
        (f_n\circ\gamma)\gamma'\toto(f\circ\gamma)\gamma'
        $$
        Но это верно, поскольку $\gamma'$ ограничена.
    \end{proof}
    \begin{definition}
        Пусть $\gamma$~--- кусочно гладкий путь в $\mathbb R^2$ или $\mathbb C$, заданный на $[a;b]$, $f\in C(\gamma^*)$. Криволинейным интегралом первого рода $f$ по пути $\gamma$~--- это
        $$
        \int\limits_a^b(f\circ\gamma)|\gamma'|\qquad\qquad \text{где }|\gamma'|=\sqrt{{\varphi'}^2+{\psi'}^2}
        $$
        Обозначения
        $$
        \int_\gamma f~\mathrm ds\qquad\qquad\int_\gamma f(z)~|\mathrm dz|
        $$
    \end{definition}
    \begin{remark}
        Сочетанию букв $\mathrm ds$ мы не придаём специального смысла. Но вообще мы используем $s$, потому что такой буквой мы обозначали длину пути.
    \end{remark}
    \begin{property}
        $$
        \int_{\gamma^-}f~\mathrm ds=\int_\gamma f~\mathrm ds
        $$
    \end{property}
    \begin{property}
        Остальные свойства интеграла 1 рода совпадают со свойствами интеграла 2 рода.
    \end{property}
    \begin{property}
        $\int_\gamma1~\mathrm ds=s_\gamma$
    \end{property}
    \begin{property}[Оценка интеграла]
        \label{Оценка криволинейного интеграла}
        $$
        \left|\int_\gamma f(z)~\mathrm dz\right|\leqslant\int_\gamma |f(z)|~|\mathrm dz|\leqslant \max\limits_{\gamma^*}|f|\cdot s_\gamma
        $$
    \end{property}
    \begin{proof}
        $$
        \left|\int_\gamma f(z)~\mathrm dz\right|=\left|\int\limits_a^b(f\circ\gamma)\gamma'\right|\leqslant\int\limits_a^b|f\circ\gamma||\gamma'|=\int_\gamma|f(z)|~|\mathrm dz|
        $$
        И
        $$
        \int_\gamma|f(z)|~|\mathrm dz|=\int\limits_a^b|f\circ\gamma||\gamma'|\leqslant\max\limits_{\gamma^*}|f|\int\limits_a^b|\gamma'|=\max\limits_{\gamma^*}|f|\cdot s_\gamma
        $$
    \end{proof}
    \begin{property}
        $$
        \int_\gamma f(z)~\mathrm dz=\lim\limits_{\lambda\to0}\sum\limits_{k=0}^{n-1}f(\zeta_k)\Delta z_k
        $$
    \end{property}
    \begin{proof}
        Докажем, что
        $$
        \int_\gamma f(z)~\mathrm dz-\sum\limits_{k=0}^{n-1}f(\zeta_k)\Delta z_k\longrightarrow0
        $$
        Пусть $\gamma_k=\gamma\big|_{[t_k;t_{k+1}]}$. Тогда
        $$
        \int_\gamma f(z)~\mathrm dz-\sum\limits_{k=0}^{n-1}f(\zeta_k)\Delta z_k=\sum\limits_{k=0}^{n-1}\int_{\gamma_k}f(z)-f(\zeta_k)~\mathrm dz=
        \sum\limits_{k=0}^{n-1}\int\limits_{t_k}^{t_{k+1}}f(\gamma(t))-f(\gamma(\theta_k))\gamma'(t)~\mathrm dt
        $$
        Теперь хотим доказать, что это стремится у нулю на $\varepsilon$-языке. Выберем $\varepsilon>0$. По теореме Кантора известно, что $f\circ\gamma$ равномерно непрерывна на $[a;b]$, а значит
        $$
        \exists\delta>0~\forall t',t''\in[a;b]:|t'-t''|<\delta~|f(\gamma(t'))-f(\gamma(t''))|<\frac\varepsilon{s_\gamma}
        $$
        Это верно, если $s_\gamma\neq0$. Если $s_\gamma=0$, всё и так понятно, $\int_\gamma f(z)~\mathrm dz=0=\sum\cdots$.\\
        Возьмём это самое $\delta$ как ранг дробления для $\varepsilon$. Тогда $\forall\tau:\lambda_\tau<\delta$ верно, что наша разность по модулю не больше
        $$
        \sum\limits_{k=0}^{n-1}\frac\varepsilon{s_\gamma}\int\limits_{t_k}^{t_{k+1}}|\gamma'|=\frac\varepsilon{s_\gamma}\int\limits_a^b|\gamma'|=\varepsilon
        $$
    \end{proof}
    \begin{remark}
        Аналогичное доказывается для $\omega=P\mathrm dx+Q\mathrm dy$ и для интегралов первого рода:
        $$
        \int_\gamma f~\mathrm ds=\lim\limits_{\gamma\to0}\sum\limits_{k=0}^{n-1}f(\zeta_z)\Delta s_k\qquad\qquad\text{где }\Delta s_k=s_{\gamma_k}
        $$
    \end{remark}
    \begin{remark}
        Предел интегральных сумм существует и конечен для интегралов от непрерывных функций по спрямляемым путям.\\
        Это мы доказывать не будем, это сложно.
    \end{remark}
    \begin{remark}
        Предыдущее свойство позволяет избавиться от гладкости допустимого преобразования параметра в свойстве \ref{Независимость интеграла 2 рода от параметризации}. Из этого следует, что интегралы $C$-эквивалентных путей равны.\\
        Это доказывать уже не так сложно, но мы всё равно не будем.
    \end{remark}
    \paragraph{Точные и замкнутые формы.}
    \begin{remark}
        Интеграл зависит от двух аргументов: дифференциальной формы и от пути. И как именно он зависит от каждого из них, мы и будем разбираться.
    \end{remark}
    \begin{definition}
        Напоминание. \textbf{Область}~--- открытое линейно связное множество.
    \end{definition}
    \begin{lemma}[Признак совпадения подобласти с областью]
        \label{Линейно связное пространство связно}
        Пусть $X$~--- метрическое пространство, $D$~--- область в $X$, $E\subset D$. Пусть
        \begin{enumerate}
            \item $E\neq\varnothing$.
            \item $E$ открыто в $X$.
            \item $E$ замкнуто в $D$.
        \end{enumerate}
        Тогда $E=D$.
    \end{lemma}
    \begin{remark}
        Так. Что такое условие 3? $E$ содержит все свои предельные точки из множества $D$. Может не содержать предельные точки их $X\setminus D$, но из $D$~--- обязано.\\
        Во втором свойстве не важно, где $E$ открыто: в $D$ ли или в $X$. Они (в условии того, что $D$ открыто в $X$) равносильны.
    \end{remark}
    \begin{proof}
        Докажем от противного. Пусть $D\neq E$. Тогда у нас $E\neq\varnothing$ и $D\setminus E\neq\varnothing$.\\
        Рассмотрим $A\in E$, $B\in D\setminus E$. Соединим их путём $\gamma$, раз уж они в $D$. Тогда $\gamma(a)=A$, $\gamma(b)=B$. Пусть $e=\gamma^{-1}(E)\subset[a;b]$. Заметим, что $a\in e$, $b\notin e$. Также нетрудно заметить, что $e$ открыто в $[a;b]$, поскольку $E$ открыто в $D$. Но в таком случае и $\gamma^{-1}(D\setminus E)=[a;b]\setminus e$ открыто в $[a;b]$. То есть $e$ открыто и замкнуто в $[a;b]$.\\
        Почему такого не бывает? Ну, пусть $c=\sup e\in[a;b]$. Поскольку $e$ замкнуто, $c\in e$, следовательно $c<b$. Но тогда $c$ содержится в $e$ без своей окрестности, что противоречит с открытостью $e$.
    \end{proof}
    \begin{definition}
        Метрическое пространство $X$ называется \textbf{связным}, если его нельзя разбить на два непустых открытых множества.
    \end{definition}
    \begin{remark}
        Разумеется, слово <<открытое>> можно заменить на слово <<замкнутое>>. Или можно переформулировать определение так: связное пространство~--- такое пространство, в котором нет открытого замкнутого непустого подпространства, не совпадающего с самим пространством.
    \end{remark}
    \begin{remark}
        Лемма \ref{Линейно связное пространство связно} говорит нам о том, что линейно связное пространство связно.
    \end{remark}
    \begin{claim}
        Обратное утверждение не верно (не всякое связное множество линейно связно).
    \end{claim}
    \begin{proof}
        Пусть
        $$
        D=\left\{(x;y)\mid 0<x\leqslant 1,y=\sin\frac1x\right\}\cup\left\{(0;y)\mid-1\leqslant y\leqslant 1\right\}
        $$
        Оно связно, но не линейно связно. Про второе ясно, а разбить его на два открытых непустых множества вы не сможете.
    \end{proof}    
    \begin{definition}
        \textbf{Компонентой связности} пространства называется максимальное по включению связное множество.\\
        \textbf{Компонентой линейной связности} пространства называется максимальное по включению линейно связное множество.
    \end{definition}
    \begin{claim}
        Нетрудно доказать, что в $\mathbb R$ связными являются промежутки и только они.
    \end{claim}
    \begin{claim}
        Также нетрудно доказать, что непрерывный образ связного множества связен.
    \end{claim}
    \begin{claim}
        В открытом подмножестве $\mathbb R^m$ связность равносильна линейной связности, а компоненты линейной связности совпадают с компонентами обычной.
    \end{claim}
    \begin{theorem}
        Любые две точки области в $\mathbb R^m$ можно соединить ломаной.
    \end{theorem}
    \begin{proof}
        Обозначим область буквой $D$, зафиксируем $A\in D$. Пусть $E$~--- множество точек $E$, которые можно соединить с $A$ ломаной в $D$. Давайте по лемме докажем, что $E=D$.
        \begin{enumerate}
            \item $A\in E\Rightarrow E\neq\varnothing$.
            \item Проверим, что $E$ открыто. Рассмотрим $B\in E$. По открытости $D$, $\exists V_B\subset D$. Но тогда любую точку $V_B$ можно соединить с $B$ отрезком, а значит можно соединить с $A$ ломаной.
            \item Проверим, что $E$ замкнуто в $D$. Рассмотрим последовательность точек $\{z_n\}\subset E:z_n\rightarrow z_0\in D$. Хм-м, $z_0\in D$, значит $\exists V_{z_0}\subset D$. Тогда начиная с некоторого $N\in\mathbb N$ все $z_{n\geqslant N}\in V_{z_0}$. Но на хватит и того, что $z_N\in E$, потому что тогда $z_N$ можно соединить отрезком с $z_0$, а значит $z_0\in E$.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Можно добиться, чтобы звенья ломаной были параллельны координатным осям.
    \end{remark}
    \begin{corollary}
        Любые две точки области можно соединить кусочно-гладким путём.
    \end{corollary}
    \begin{remark}
        А знаете ли вы, что ломаную можно параметризовать гладкими функциями? Рассмотрим ломаную, которая имеет два звена: $(0;1)\to(0;0)\to(1,0)$. Смотрите, как это делается:
        \begin{align*}
            \varphi(t)&=\begin{cases}
                0&t\in[-1;0]\\
                t^2&t\in[0;1]
            \end{cases}\\
            \psi(t)&=\begin{cases}
                t^2&t\in[-1;0]\\
                0&t\in[0;1]
            \end{cases}
        \end{align*}
        Отсюда $\gamma=(\varphi;\psi)$ гладкая.\\
        Но мы же видим излом на ломаной. В чём тут дело? А дело в том, что при $t=0$ обе производные обнуляются.
    \end{remark}
    \begin{definition}
        Путь называется \textbf{регулярным}, если $\forall t\in[a;b]~\gamma'(t)\neq\mathbb0$
    \end{definition}
    \begin{claim}
        Без доказательства: регулярный путь имеет носитель, в каждой точке которого есть касательная.
    \end{claim}
    \begin{remark}
        Напоминание: если $F=U+\im V$, то $F'_x=U'_x+\im V'_x$, $F'_y=U'_y+\im V'_y$.
    \end{remark}
    \begin{definition}
        Пусть $D$~--- открыто в $\mathbb R^2$ или $\mathbb C$, $P,Q\in C(D)$, $\omega=P\mathrm dx+Q\mathrm dy$.\\
        Функция $F\colon D\to\mathbb R(\mathbb C)$ называется первообразной $\omega$, если $F'_x=P$, $F'_y=Q$.
    \end{definition}
    \begin{remark}
        Везде дальше $D$~--- область, а не просто открытое множество.
    \end{remark}
    \begin{claim}
        $F\in C^{(1)}$, поскольку $P,Q\in C$.
    \end{claim}
    \begin{claim}
        Два равенства $F'_x=P$, $F'_y=Q$ можно записать как
        $$\mathrm dF=\omega$$
    \end{claim}
    \begin{claim}
        Если $f=u+\im v$, $\mathrm dz=\mathrm dx+\im\mathrm dy$,
        $$
        f\mathrm dz=(u+\im v)\mathrm dx+(-v+\im u)\mathrm dy
        $$
        Тогда
        $$
        \mathrm dF=\omega\Leftrightarrow\left\{\begin{aligned}
            F'_x&=u+\im v\\
            F'_y&=-v+\im u
        \end{aligned}\right.
        $$
    \end{claim}
    \begin{remark}
        Без доказательства: штука справа равносильна комплексной дифференцируемости $F$ и равенству $F'=f$.
    \end{remark}
    \begin{remark}
        Как мы знаем, в одномерном случае всякая непрерывная на промежутке функция имеет первообразную на нём. В двумерном случае это не так.
    \end{remark}
    \begin{definition}
        Форма $\omega$ называется \textbf{точной} в $D$, если она имеет первообразную в $D$.
    \end{definition}
    \begin{theorem}[Формула Ньютона~--- Лейбница для криволинейных интегралов]
        \label{Формула НЛ для криволинейных интегралов}
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$, $F\in C^{(1)}(D)$, $\gamma\in[a;b]\to D$~--- кусочно=гладкий путь. Тогда
        $$
        \int_\gamma\mathrm dF=F(\gamma(b))-F(\gamma(a))
        $$
    \end{theorem}
    \begin{proof}
        $$
        \int_\gamma\mathrm dF=\int_\gamma F'_x\mathrm dx+F'_y\mathrm dy=\int\limits_a^b(F'_x\circ\gamma)\varphi'+(F'_y\circ\gamma)\psi'=\int\limits_a^b(F\circ\gamma)'=F\circ\gamma\bigg|_a^b
        $$
    \end{proof}
    \begin{corollary}[Признак постоянства функции в области]
        \label{Признак постоянства функции в области}
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$.
        $$
        \mathrm dF\equiv 0\text{ в }D\Rightarrow F\text{ постоянна в }D
        $$
    \end{corollary}
    \begin{proof}
        Рассмотрим $A,B\in D$, соединим их кусочно-гладким путём $\gamma$ в $D$. Тогда
        $$0=\int_\gamma\mathrm dF=F(B)-F(A)\Leftrightarrow F(A)=F(B)$$
    \end{proof}
    \begin{corollary}[Единственность первообразной]
        Пусть $F$~--- первообразная $\omega$ в $D$. Тогда
        \begin{enumerate}
            \item $\forall C\in\mathbb R~F+C$~--- первообразная $\omega$ в $D$.
            \item Первообразных другого вида у $\omega$ нет.
        \end{enumerate}
    \end{corollary}
    \begin{proof}
        \begin{enumerate}
            \item Очевидно.
            \item Пусть $\Phi$~--- первообразная $\omega$. Тогда $\mathrm d(\Phi-F)=\omega-\omega=0$, а тогда по следствию \ref{Признак постоянства функции в области} $\Phi=F+\mathrm{const}$.
        \end{enumerate}
    \end{proof}
    \begin{definition}
        Если для любых двух кусочно-гладких путей $\gamma_1,\gamma_2\in D$ с общими концами
        $$\int_{\gamma_1}\omega=\int_{\gamma_2}\omega$$
        То говорят, что \textbf{$\int_\gamma\omega$ не зависит от пути}.
    \end{definition}
    \begin{theorem}[Точность формы и независимость интеграла от пути]
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$, $P,Q\in C(D)$, $\omega=P\mathrm dx+Q\mathrm dy$. Тогда следующие утверждения равносильны
        \begin{enumerate}
            \item $\omega$ точна в $D$.
            \item $\int_\gamma\omega$ не зависит от пути в $D$.
            \item $\forall\gamma$~--- контур в $D$~$\int_\gamma\omega=0$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item[$1\to2$] По \hyperref[Формула НЛ для криволинейных интегралов]{формуле Ньютона~--- Лейбница}.
            \item[$2\to1$] В одномерном случае мы строили интеграл с переменным верхним пределом. Тут будет некоторый его аналог. Пусть $A\in D$. Пусть $F(B)=\int_\gamma\omega$, где $\gamma$~--- произвольный кусочно-гладкий путь $A\to B$. Докажем, что $F$~--- искомая первообразная.\\
            Докажем, что $F'_x=P$ в некоторой точке $B(x_0;y_0)$. Пусть $\gamma_1$~--- горизонтальный отрезок из $(x_0;y_0)$ в $(x;y_0)$. И при этом $(x;y_0)$ лежит в той самой окрестности $B$, с которой она содержится в $D$. Тогда 
            $$
            F(x;y_0)=\int_{\gamma\wedge\gamma_1}\omega=F(B)+\int\limits_{x_0}^x P(t;y_0)~\mathrm dt
            $$
            По теореме Барроу $F'_x(x;y_0)=P(x;y_0)$ для всех $x\in V_{x_0}$ (в частности, $F'_x(B)=P(B)$). А поскольку $B$ была произвольной точкой, равенство $F'_x(B)=P(B)$ выполнено на всей области $D$. Аналогично $F'_y=Q$.
            \item[$2\to3$] Интеграл по контуру в силу независимости от пути совпадает с интегралом по вырожденному контуру (по точке), а значит равен нулю.
            \item[$3\to2$] Пусть $\gamma_1,\gamma_2$~--- два пути из $A$ в $B$. Тогда $\gamma_1\wedge\gamma_2^-$~--- контур, а значит интеграл по нему равен нулю.
            $$
            0=\int_{\gamma_1\wedge\gamma_2^-}\omega=\int_{\gamma_1}-\int_{\gamma_2}\omega
            $$
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Мы тут нашли формулу для первообразной. Вопрос лишь в том, насколько это удобно. Это зависит от $D$. Если область позволяет, берут отрезочек.
    \end{remark}
    \begin{remark}
        Очень весёлые условия для проверки точности формы, фиг вы их проверите, у вас очень много путей.
    \end{remark}
    \begin{lemma}
        Пусть $D$~--- открытый круг (например, плоскость). $P,Q\in C(D)$, $\omega=P\mathrm dx+Q\mathrm dy$. Тогда точность $\omega$ в $D$ равносильно тому, что $\int_\gamma\omega=0$ для любого прямоугольника $\gamma$ со сторонами, параллельными координатным осям. 
    \end{lemma}
    \begin{proof}
        Следствие вправо понятно, давайте обратно.\\
        Пусть $O$~--- центр круга, $B\in D$. Положим $A$ и $C$ вот такими точками:
        \begin{figure}[H]
            \begin{tikzpicture}
                \draw (0,0) circle (2) node[coordinate,midway,label={-135:$O$}] (O) {};
                \node[coordinate,label={45:$B$}] (B) at (1,1) {};
                
                \draw (B) -- (B |- O) node[coordinate,label={-45:$A$}] {} -- (O);
                \draw (B) -- (B -| O) node[coordinate,label={135:$C$}] {} -- (O);
            \end{tikzpicture}
        \end{figure}\noindent
        Положим $F(B)=\int_{OCB}\omega=\int_{OAB}\omega$. $F$~--- искомая первообразная. Почему? Чтобы проверить, что $F'_x=P$ надо делать приращение по горизонтали и пользоваться левым интегралом. Для проверки $F'_y=Q$~--- по вертикали и пользоваться вторым. Тогда получается то же самое, что и раньше.
    \end{proof}
    \begin{definition}
        Форма $\omega$ называется \textbf{замкнутой}, если она локально точна в $D$ (у любой точки $D$ есть окрестность, где $\omega$ точна).
    \end{definition}
    \begin{remark}
        Возникает резонный вопрос: можно ли склеить локальные интегралы в глобальный? Ответ зависит от $\omega$ и $D$.
    \end{remark}
    \begin{theorem}
        \label{Замкнутая в круге форма точна}
        Замкнутая в круге форма точна в нём.
    \end{theorem}
    \begin{proof}
        Пусть не так. Тогда найдётся прямоугольник $\gamma_0$, по которому интеграл не равен нулю.\\
        Побьём наш прямоугольник на 4 равных прямоугольника (каждая сторона делится пополам) и представим $\gamma_0$ как 4 контура: $\sigma_1$, $\sigma_2$, $\sigma_3$ и $\sigma_4$. Очевидно
        $$
        \int_{\gamma_0}\omega=\sum\limits_{j=1}^4\int_{\sigma_j}\omega
        $$
        Интеграл по какой-то из $\sigma_j$ не равен нулю. Возьмём любой из таких и повторим для него операцию. Получим последовательность $\{\gamma_k\}_{k=0}^\infty$. Пусть $F_k$~--- замкнутый прямоугольник, ограниченный $\gamma_k$. Тогда $F_{k+1}\subset F_k$, причём диагональ $F_{k+1}$ вдвое меньше диагонали $F_k$. Тогда
        $$\bigcap\limits_{k=0}^\infty F_k=\{z_0\}\qquad\qquad z_0\in D$$
        Но тогда $\exists r>0~B(z_0;r)\subset D$ и $\omega$ точна в $B(z_0;r)$. Ну, тогда уж $\exists N~F_N\subset B(z_0;r)$. Но тогда $\int_{\gamma_N}\omega=0$, противоречие.
    \end{proof}
    \begin{lemma}[Правило Лейбница дифференцирования интеграла по параметру]
        \label{Правило Лейбница дифференцирования интеграла по параметру}
        Пусть $f\in C([a;b]\times[c;d])$, $f$ дифференцируема по $y$ и $f'_y\in C([a;b]\times[c;b])$. Пусть $I(y)=\int\limits_a^bf(x;y)~\mathrm dx$. Тогда $I$ дифференцируема на $[c;d]$ и
        $$\forall y\in[c;d]~I'(y)=\int\limits_a^bf'_y(x;y)~\mathrm dx$$
    \end{lemma}
    \begin{proof}
        Будем считать, что $f$ вещественна (иначе можно отдельно рассматривать $\Re f$ и $\Im f$).\\
        Пусть $y\in[c;d]$. Докажем, что
        $$
        R=\frac{I(y+\Delta y)-I(y)}{\Delta y}-\int\limits_a^b f'_y(x;y)~\mathrm dx\underset{\Delta y\to0}\longrightarrow0
        $$
        Ну,
        \[
        \begin{split}
            R&=\int\limits_a^b\left(\frac{f(x;y+\Delta y)-f(x;y)}{\Delta y}-f'_y(x;y)\right)~\mathrm dx\overset{\text{теорема Лагранжа}}=\\
            &\overset{\exists\theta\in[0;1]}=\int\limits_a^b\left(f'_y(x;y+\theta\Delta y)-f'_y(x;y)\right)~\mathrm dx
        \end{split}
        \]
        Осталось доказать это на $\eps$-языке. По теореме Кантора $f'_y$ равномерно непрерывна на $[a;b]\times[c;d]$. То есть
        $$
        \exists\delta>0~\forall \overline x,\overline{\overline x}\in[a;b],\overline y,\overline{\overline y}\in[c;d]:|\overline x-\overline{\overline x}|<\delta,|\overline y-\overline{\overline y}|<\delta~|f'_y(\overline x;\overline y)-f'_y(\overline{\overline x};\overline{\overline y})|<\frac\eps{b-a}
        $$
        Поскольку $0<|\Delta y|<\delta$, верно $|R|<\int\limits_a^b\frac\eps{b-a}~\mathrm dx=\eps$.
    \end{proof}
    \begin{theorem}[Дифференциальные условия замкнутости формы]
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$. Пусть $P,Q\in C(D)$, $\exists P'_y,Q'_x\in C(D)$. Пусть $\omega=P\mathrm dx+Q\mathrm dy$. Тогда следующие утверждения равносильны:
        \begin{enumerate}
            \item $\omega$ замкнута в $D$.
            \item $P'_y=Q'_x$ в $D$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item[$1\to2$] Рассмотрим $(x^0;y^0)\in D$ и возьмём окрестность $V_{(x^0;y^0)}\subset D$ и $F$~--- первообразная $\omega$ в этой окрестности. Тогда $F'_x=P$, $F'_y=Q$. Тогда $F''_{xy}=P'_y$ и $F''_{yx}=Q'_x$. Но подождите. По теореме о независимости смешанных производных от очерёдности дифференцирования если функция ($F$) имеет две смешанные производные в окрестности некоторой точки ($(x^0;y^0)$), которые непрерывны в самой точке, то они совпадают.
            \item[$2\to1$] Нам достаточно проверить, что интеграл по любому прямоугольнику (лежащему в $D$ вместе со внутренностью) равен нулю. Потому что тогда мы докажем, что в любом круге в $D$ форма точна.\\
            Пусть $\gamma$ ограничивает $[a;b]\times[c;d]$. Тогда
            $$
            \int_\gamma P\mathrm dx+Q\mathrm dy=\int\limits_a^b P(x;c)~\mathrm dx+\int\limits_c^d Q(b;y)~\mathrm dy-\int\limits_a^b P(x;d)~\mathrm dx-\int\limits_c^d Q(a;y)~\mathrm dy
            $$
            Нам хочется доказать, что это ноль. Возьмём два слагаемых с $Q$ и преобразуем:
            \[
            \begin{split}
                \int\limits_c^d Q(b;y)~\mathrm dy-\int\limits_c^d Q(a;y)~\mathrm dy&\overset{\ref{Формула НЛ для криволинейных интегралов}}=\int\limits_c^d\int\limits_a^b Q'_x(x;y)~\mathrm dx~\mathrm dy=\\
                &=\int\limits_c^d\int\limits_a^b P'_y(x;y)~\mathrm dx~\mathrm dy\overset{\ref{Правило Лейбница дифференцирования интеграла по параметру}}=\int\limits_c^d\left(\int\limits_a^b P(x;y)~\mathrm dx\right)'_y~\mathrm dy=\\
                &\overset{\ref{Формула НЛ для криволинейных интегралов}}=\int\limits_a^b P(x;c)~\mathrm dx-\int\limits_a^b P(x;d)~\mathrm dx
            \end{split}
            \]
            Где-то мы это видели.
        \end{enumerate}
    \end{proof}
    \begin{example}
        Пример замкнутой не точной формы.\\
        Пусть
        $$D=\mathbb R^2\setminus\{(0;0)\}\qquad\qquad\omega=\frac{-y\mathrm dx+x\mathrm dy}{x^2+y^2}$$
        Тогда
        $$
        P=-\frac y{x^2+y^2}\qquad\qquad Q=\frac x{x^2+y^2}
        $$
        Несложно заметить, что
        $$
        P'_y=\frac{-x^2-y^2+y\cdot 2y}{(x^2+y^2)^2}=\frac{y^2-x^2}{(x^2+y^2)^2}=Q'_x
        $$
        То есть $\omega$ замкнута в $D$. А теперь докажем, что $\omega$ не точна. Для этого предъявим контур, интеграл по которому не ноль:
        $$
        \gamma_1(t)=(\cos t;\sin t)
        $$
        $$
        \int_{\gamma_1}\omega=\int\limits_{-\pi}^\pi\frac{\sin t(-\sin t)+\cos t\cdot\cos t}{\cos^2t+\sin^2t}~\mathrm dt=2\pi\neq0
        $$
    \end{example}
    \begin{remark}
        Технически этот пример~--- это мнимая часть $\omega_0=\frac{\mathrm dz}z$. И на самом деле $\omega_0$ тоже замкнута, но не точна, а неё нет первообразной (хотя хочется логарифм).
    \end{remark}
    \begin{definition}
        Пусть $(X;\rho)$~--- метрическое пространство, $E,F\subset X$. Тогда \textbf{расстоянием} между $E$ и $F$ называется величина
        $$
        \rho(E;F)=\inf\limits_{\substack{x\in E\\y\in F}}\rho(x;y)
        $$
    \end{definition}
    \begin{lemma}
        Пусть $K,F\subset\mathbb R^m$, $K$~--- компактно, $F$~--- замкнуто, $K\neq\varnothing\neq F$. Тогда
        $$
        \exists x^*\in K~\exists y^*\in F~\rho(K;F)=\rho(x^*;y^*)
        $$
    \end{lemma}
    \begin{proof}
        \begin{enumerate}
            \item Для начала пусть $F$ тоже компактно. Сначала докажем, что $K\times F$~--- компакт в $\mathbb R^{2n}$.\\
            Рассмотрим последовательность $\{(x_n;y_n)\}\subset K\times F$. Поскольку $K$ и $F$ секвенциально компактны, извлечём подпоследовательности $\{x_{n_k}\}$, сходящуюся в $K$ к $\tilde x$ и $\{y_{n_{k_j}}\}$, сходящуюся в $F$ к $\tilde y$. Тогда и $\{x_{n_{k_j}}\}$ сходится к $\tilde x$, а значит $\{(x_n;y_n)\}$ стремится к $\{(\tilde x;\tilde y)\}$ в $K\times F$, что означает секвенциальную компактность $K\times F$.\\
            Теперь докажем, что $\rho$ непрерывна на $\mathbb R^n\times\mathbb R^n$:
            $$
            |\rho(x;y)-\rho(x_0;y_0)|\leqslant|\rho(x;y)-\rho(x_0;y)|+|\rho(x_0;y)-\rho(x_0;y_0)|\leqslant\rho(x;x_0)+\rho(y;y_0) \to0
            $$
            Отсюда, по теореме Вейерштрасса $\rho$ достигает наименьшего значения на компакте $K\times F$, а значит нижняя грань в определении достигается.
            \item Пусть $F$~--- произвольное (непустое) замкнутое множество. Пусть $\rho(K;F)=\sigma<+\infty$. $K$ в силу компактности содержится в некотором шаре $\overline B(\mathbb O_m;R)$. Тогда, если $x\in K,y\in F$ и $|y|>R+\sigma+1$, то
            $$
            \rho(x;y)=|x-y|\geqslant R+\sigma+1-R>\sigma
            $$
            Поэтому
            $$
            \rho(K;F)=\rho(K;F\cap\overline B(\mathbb O_m;R+\sigma+1))
            $$
            А тут справа уже компакт.
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        Пусть $K,R\subset\mathbb R^m$, $K$~--- компактно, $F$~--- замкнуто и $K\cap F=\varnothing$, то $\rho(K;F)>0$.
    \end{corollary}
    \begin{corollary}
        В условиях следствия выше $\rho(K;F)=\rho(K;\partial F)$.
    \end{corollary}
    \begin{example}
        Между двумя замкнутыми множествами расстояние может быть равно нулю, даже если они не пересекаются.\\
        Рассмотрим одно множество~--- гиперболу $y=\frac1x$, а второе~--- прямая $y=0$.
    \end{example}
    \begin{definition}
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$, $\omega$~--- замкнутая форма в $D$, $\gamma\in C([a;b]\to D)$. \textbf{Первообразной} $\omega$ \textbf{вдоль пути} $\gamma$ называется такая $\Phi\in C[a;b]$, что
        $$
        \forall\tau\in[a;b]~\exists V_{\zeta}\subset D (\zeta=\gamma(\tau))~\exists F_\zeta\colon V_\zeta\to\mathbb R(\mathbb C)~
        $$
        \begin{enumerate}
            \item $F_\zeta$~--- первообразная $\omega$ в $V_\zeta$.
            \item $\exists V_\tau$~--- окрестность $\tau$ в $[a;b]~\forall t\in V_\tau~F_\zeta(\gamma(t))=\Phi(t)$.
        \end{enumerate}
    \end{definition}
    \begin{remark}
        Если $F$~--- первообразная $\omega$, то $F\circ\gamma$~--- первообразная $\omega$ вдоль $\gamma$.
    \end{remark}
    \begin{theorem}
        \label{Существование и единственность первообразной замкнутой формы вдоль пути}
        Первообразная замкнутой формы вдоль пути существует и единственна с точностью до постоянного слагаемого.
    \end{theorem}
    \begin{proof}
        Начнём с единственности. Пусть есть $\Phi_1$ и $\Phi_2$. Тогда для любой $\tau\in[a;b]$ у нас найдутся
        $$
        V_{\zeta,1},V_{\zeta,2},F_{\zeta,1},F_{\zeta,2},V_{\tau,1},V_{\tau,2}
        $$
        из определения. Тогда рассмотрим $V_{\zeta,1}\cup V_{\zeta,2}$. На этом множестве $F_{\zeta,1}$ и $F_{\zeta,2}$ отличаются на константу. Отсюда в $V_{\tau,1}\cap V_{\tau,2}$ $\Phi_1$ отличается от $\Phi_2$ на константу. То есть $\Phi_1$ и $\Phi_2$ отличаются на константу в окрестности каждой точки. И тут надо применить известный топологический факт о том, что наи связном множестве (отрезке) локально-постоянная функция равна константе. Но у нас отрезок, а значит мы можем вообще сказать, что в каждой точке $(\Phi_1-\Phi_2)'=0$, и отсюда различие на константу.\\
        Теперь существование. Рассмотрим $D\compl$ и $\gamma^*$. Первое замкнуто, второе компактно. А поскольку $\gamma$ действует в $D$, $D\compl\cap\gamma^*=\varnothing$. А значит $\sigma=\rho(\gamma^*;D\compl)>0$. По теореме Кантора
        $$
        \exists\delta>0~\forall t',t''\in[a;b]:|t'-t''|<\delta~|\gamma(t')-\gamma(t'')|<\sigma
        $$
        Тогда рассмотрим $\{t_k\}_{k=0}^n$~--- дробление $[a;b]$ ранга $<2\delta$. И возьмём ещё $t_{k+\frac12}=\frac{t_k+t_{k+1}}2$. Пусть $z_j=\gamma(t_j)$.\\
        Пусть $B_0=B(z_0;\sigma)\subset D$. Тогда по выбору $\delta$ верно, что $\gamma([t_0;t_{1/2}])\subset B_0$. Наша форма $\omega$ замкнута в $D$, а значит и в $B_0$, а в круге всякая замкнутая форма точна. Тогда у неё есть первообразная $F_0$. Тогда пусть $\Phi(t)=F_0(\gamma(t))$ на отрезке $t\in[t_0;t_{1/2}]$.\\
        Дальше у нас где-то есть точка $z_1$. Тогда мы можем выбрать $B_1=B(z_1;\sigma)\subset D$. Несложно заметить, что $[t_{1/2};t_{3/2}]\subset B_1$. Но самое интересное, что $\gamma\left(t_{\frac12}\right)$ лежит и в $B_0$, и в $B_1$. Тогда у неё есть первообразная $\tilde F_1$. Но у нас в $B_0\cap B_1$ завелось две первообразных $\omega$: $F_0$ и $\tilde F_1$, значит они на константу $C$ отличаются, так и пусть $F_1$~--- это $\tilde F_1-C$. Тогда пусть $\Phi(t)=F_1(\gamma(t))$ на отрезке $t\in[t_{1/2};t_{3/2}]$. И всё, сделав так ещё $n-1$ раз, построим первообразную функцию $\Phi$.
    \end{proof}
    \begin{corollary}[Формула Ньютона~--- Лейбница для первообразной вдоль пути]
        \label{Н-Л вдоль пути}
        Пусть $D$~--- область в $\mathbb R^2$ или $\mathbb C$, $\omega$~--- замкнутая форма в $D$, $\gamma\colon[a;b]\to D$~--- reсочно-гладкий путь, $\Phi$~--- первообразная $\omega$ вдоль $\gamma$. Тогда
        $$
        \int_\gamma\omega=\Phi(b)-\Phi(a)
        $$
    \end{corollary}
    \begin{proof}
        Это верно на $[t_0;t_{1/2}]$, на $[t_{1/2};t_{3/2}]$, остаётся только просуммировать.
    \end{proof}
    \begin{remark}
        Формулой Ньютона~--- Лейбница определяется интеграл замкнутой формы по любому (не обязательно кусочно-гладкому) пути.
    \end{remark}
    \paragraph{Гомотопные пути.}
    \begin{remark}
        В этом параграфе $D$~--- область в $\mathbb R^2$ или $\mathbb C$. Все пути заданы на отрезке $I=[0;1]$.
    \end{remark}
    \begin{definition}
        Два пути $\gamma_0,\gamma_1\colon I\to D$ с общими концами ($\gamma_0(0)=\gamma_(0)=A$, $\gamma_0(1)=\gamma_(1)=B$) называются \textbf{гомотопными как пути в общими (неподвижными) концами}, если
        $$
        \exists\Gamma\in C(I\times I\to D)
        $$
        \begin{enumerate}
            \item $$\forall t\in I~\Gamma(0,t)=\gamma_0(t)\land\Gamma(1,t)=\gamma_1(t)$$
            \item $$\forall s\in I~\Gamma(s,0)=A\land\Gamma(s,1)=B$$
        \end{enumerate}
        Отображение $\Gamma$ называется \textbf{гомотопией} или \textbf{непрерывной деформацией}.
    \end{definition}
    \begin{definition}
        Два замкнутых пути $\gamma_0,\gamma_1\colon I\to D$ называются \textbf{гомотопными как замкнутые пути}, если
        $$
        \exists\Gamma\in C(I\times I\to D)
        $$
        \begin{enumerate}
            \item $$\forall t\in I~\Gamma(0,t)=\gamma_0(t)\land\Gamma(1,t)=\gamma_1(t)$$
            \item $$\forall s\in I~\Gamma(s,0)=\Gamma(s,1)$$
        \end{enumerate}
        Отображение $\Gamma$ называется \textbf{гомотопией} или \textbf{непрерывной деформацией}.
    \end{definition}
    \begin{remark}
        Как понять, что тут происходит? Ну, смотрите. Мы трансформируем один путь в другой. И $\Gamma(s;\cdot)$~--- это путь в $D$, промежуточный между $\gamma_0$ и $\gamma_1$. Его обозначают даже $\gamma_s$.
    \end{remark}
    \begin{claim}
        Нетрудно доказать, что гомотопность~--- отношение эквивалентности.
    \end{claim}
    \begin{claim}
        Если $\gamma_1=\gamma_0\circ u$, где $u\in C(I\to I)$, то $\gamma_1$ гомотопно $\gamma_0$. В частности, эквивалентные пути гомотопны.
    \end{claim}
    \begin{proof}
        Предъявим промежуточные пути:
        $$
        \gamma_s(t)=\gamma_0(s\cdot u(t)+(1-s)t)
        $$
        Подходит для обоих определений.
    \end{proof}
    \begin{remark}
        Всё вышенаписанное можно считать $D\subset\mathbb R^m$.
    \end{remark}
    \begin{theorem}[Равенство интегралов по гомотопным путям]
        \label{Равенство интегралов по гомотопным путям}
        Пусть $\omega$~--- замкнутая форма в $D$, $\gamma_0,\gamma_1$~--- не важно как гомотопные пути. Тогда
        $$
        \int_{\gamma_0}\omega=\int_{\gamma_1}\omega
        $$
    \end{theorem}
    \begin{proof}
        Пусть $\Gamma$~--- гомотопия. Введём
        $$
        h(s)=\int_{\gamma_s}\omega
        $$
        Докажем, что $h=\mathrm{const}$. А точнее докажем, что $h$ локально постоянно, что даст нам тот же результат.\\
        $D\compl$ замкнуто, $\Gamma(I\times I)$~--- компакт (в силу непрерывности $\Gamma$ по теореме Вейерштрасса). При этом $\Gamma(I\times I)\subset D$, а значит $\Gamma(I\times I)\cap D\compl=\varnothing$. Значит
        $$\sigma=\rho(D\compl;\Gamma(I\times I))>0$$
        Воспользуемся равномерной непрерывностью $\Gamma$ и подберём такое $\delta>0$, что
        $$\forall\overline t,\overline{\overline t},\overline s,\overline{\overline s}\in I:|\overline t-\overline{\overline t}|<\delta\land|\overline s-\overline{\overline s}|<\delta~|\Gamma(\overline t;\overline s)-\Gamma(\overline{\overline t};\overline{\overline s})|<\sigma$$
        Давайте докажем, что если $|\overline s-\overline{\overline s}|<\delta$, то $h(\overline s)=h(\overline{\overline s})$. Для этого рассмотрим дробление $\{t_k\}_{k=0}^n$ отрезка $I$ с рангом меньше $\delta$. После этого для $k\in[0:n-1]$ рассмотрим замкнутые пути
        $$
        \delta_k = \gamma_{\overline s}\Big|_{[t_k,t_{k+1}]}
        \wedge\overline{\gamma_ {\overline s}(t_{k+1}),\gamma_{\overline{\overline s}}(t_{k+1})}
        \wedge\gamma_{\overline{\overline s}}\Big|_{[t_k,t_{k+1}]}
        \wedge\overline{\gamma_{\overline{\overline s}}(t_k),\gamma_{\overline s}(t_k)}
        $$
        \begin{figure}[H]
            \begin{tikzpicture}[scale=.05]
                %Curve Lines [id:da05603514022385436] 
                \draw    (263.8,140) .. controls (271.25,132.39) and (279.22,126.07) .. (287.54,120.99) .. controls (297.2,115.09) and (307.32,110.86) .. (317.61,108.26) .. controls (331.35,104.79) and (345.38,104.22) .. (359.02,106.41) .. controls (370.41,108.24) and (381.52,112) .. (391.94,117.61) .. controls (402.39,123.24) and (412.15,130.73) .. (420.8,140) ;
                %Curve Lines [id:da9801132549274962] 
                \draw    (420.8,140) .. controls (413.94,150.45) and (405.51,158.26) .. (396.14,163.89) .. controls (385.54,170.26) and (373.75,173.83) .. (361.67,175.27) .. controls (347.27,176.99) and (332.46,175.68) .. (318.82,172.46) .. controls (307.52,169.8) and (297.01,165.81) .. (288.19,161.16) .. controls (276.17,154.82) and (267.29,147.22) .. (263.8,140) ;
                %Straight Lines [id:da19796565996888638] 
                \draw    (288.19,161.16) -- (287.54,120.99) ;
                %Straight Lines [id:da024186579623517224] 
                \draw    (318.82,172.46) -- (317.61,108.26) ;
                \draw [shift={(318.17,137.76)}, rotate = 88.91] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ;
                %Straight Lines [id:da7048507735341965] 
                \draw    (359.02,106.41) -- (361.67,175.27) ;
                \draw [shift={(360.45,143.44)}, rotate = 267.79] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ;
                %Straight Lines [id:da5637069032761286] 
                \draw    (396.14,163.89) -- (391.94,117.61) ;
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (337.67,101.53) -- (344.51,104.96) -- (337.67,108.38) -- (341.09,104.96) -- cycle ;
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (347.62,179.27) -- (340.78,175.84) -- (347.62,172.42) -- (344.2,175.84) -- cycle ;

                % Text Node
                \draw (315.61,104.86) node [anchor=south east] [inner sep=0.75pt]    {$\gamma_{\overline s}(t_k)$};
                % Text Node
                \draw (361.02,103.01) node [anchor=south west] [inner sep=0.75pt]    {$\gamma_{\overline s}(t_{k+1})$};
                % Text Node
                \draw (316.82,175.86) node [anchor=north east] [inner sep=0.75pt]    {$\gamma_{\overline{\overline s}}(t_k)$};
                % Text Node
                \draw (363.67,178.67) node [anchor=north west][inner sep=0.75pt]    {$\gamma_{\overline{\overline s}}(t_{k+1})$};
            \end{tikzpicture}
            \begin{tikzpicture}[scale=.03]
                %Shape: Ellipse [id:dp13000095485284113] 
                \draw   (250.32,127.84) .. controls (250.32,87.06) and (304.06,54) .. (370.35,54) .. controls (436.64,54) and (490.38,87.06) .. (490.38,127.84) .. controls (490.38,168.62) and (436.64,201.69) .. (370.35,201.69) .. controls (304.06,201.69) and (250.32,168.62) .. (250.32,127.84) -- cycle ;
                %Shape: Ellipse [id:dp0722364044949595] 
                \draw   (306.59,123.15) .. controls (306.59,107.16) and (328.84,94.2) .. (356.28,94.2) .. controls (383.72,94.2) and (405.96,107.16) .. (405.96,123.15) .. controls (405.96,139.14) and (383.72,152.11) .. (356.28,152.11) .. controls (328.84,152.11) and (306.59,139.14) .. (306.59,123.15) -- cycle ;
                %Straight Lines [id:da896443112609429] 
                \draw    (346.04,151.21) -- (335.81,198.64) ;
                \draw [shift={(340.37,177.47)}, rotate = 282.17] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ;
                %Straight Lines [id:da6218175152742196] 
                \draw    (250.32,127.84) -- (306.59,123.15) ;
                \draw [shift={(281.05,125.28)}, rotate = 175.24] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ;
                %Straight Lines [id:da5675576037044214] 
                \draw    (356.28,94.2) -- (339.64,56.61) ;
                %Straight Lines [id:da7355565548103296] 
                \draw    (399.74,109.06) -- (457.17,76.52) ;
                %Straight Lines [id:da6219852952867877] 
                \draw    (385.96,146.58) -- (452.57,181.8) ;
                %Shape: Arc [id:dp8290201160671316] 
                \draw  [draw opacity=0] (326.97,146.54) .. controls (314.61,141.27) and (306.59,132.76) .. (306.59,123.15) .. controls (306.59,123.12) and (306.59,123.08) .. (306.59,123.05) -- (356.28,123.15) -- cycle ; \draw    (324.09,145.21) .. controls (313.38,139.9) and (306.59,131.99) .. (306.59,123.15) .. controls (306.59,123.12) and (306.59,123.08) .. (306.59,123.05) ;  \draw [shift={(326.97,146.54)}, rotate = 209.67] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ;
                %Shape: Arc [id:dp4617006094090459] 
                \draw  [draw opacity=0] (335.73,198.57) .. controls (312.8,194.33) and (292.76,185.98) .. (277.87,174.92) -- (370.35,127.84) -- cycle ; \draw    (335.73,198.57) .. controls (313.95,194.54) and (294.78,186.81) .. (280.14,176.56) ; \draw [shift={(277.87,174.92)}, rotate = 33.76] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (7.14,-3.43) -- (0,0) -- (7.14,3.43) -- (4.74,0) -- cycle    ; 

                % Text Node
                \draw (239.99,127.84) node [anchor=east] [inner sep=0.75pt]    {$\gamma_{\overline s}(t_k)$};
                % Text Node
                \draw (335.81,206.12) node [anchor=north] [inner sep=0.75pt]    {$\gamma_{\overline s}(t_{k+1})$};
                % Text Node
                \draw (348.04,147.81) node [anchor=south] [inner sep=0.75pt]    {$\gamma_{\overline{\overline s}}(t_k)$};
                % Text Node
                \draw (308.59,123.05) node [anchor=west] [inner sep=0.75pt]    {$\gamma_{\overline{\overline s}}(t_{k+1})$};
            \end{tikzpicture}
        \end{figure}\noindent
        Тогда круг $B(\gamma_{\overline s}(t_k);\sigma)\subset D$ и $\delta_k^*\subset B(\gamma_{\overline s}(t_k);\sigma)$ (в силу выбора $\delta$ и дробления ранга $<\delta$). В этом самом круге форма $\omega$ замкнута, следовательно, точна. То есть
        $$
        \int_{\delta_k}\omega=0
        $$
        Сложив все интегралы, получим
        $$
        \sum\limits_{k=0}^{n-1}\int_{\delta_k}\omega=0
        $$
        Теперь у нас уже различные ситуации для по-разному гомотопных путей. Для путей с общими концами все <<перемычки>> уничтожатся (крайние вырождаются в точку, а остальные проходятся по разу в разных направлениях). Остаётся только $\gamma_{\overline s}$ и $\gamma_{\overline{\overline s}}$, которые мы проходим в разные стороны, получаем ноль, а значит $\int_{\gamma_{\overline s}}\omega=\int_{\gamma_{\overline{\overline s}}}\omega$.\\
        Для замкнутых путей получается то же самое (только нет крайних <<перемычек>>, все <<перемычки>> проходятся в разных направлениях).
    \end{proof}
    \begin{definition}
        Говорят, что замкнутый путь \textbf{стягивается в точку}, если он гомотопен постоянному пути (как замкнутый путь).
    \end{definition}
    \begin{definition}
        Область называется \textbf{односвязной}, если в ней всякий замкнутый путь в неё стягивается в точку. В противном случае область называется \textbf{многосвязной}.
    \end{definition}
    \begin{example}
        Всякая звёздная область односвязна (в частности, выпуклое множество односвязно).\\
        Почему? $\Gamma(s,t)=A+s(\gamma_1(t)-A)$~--- центральное подобие относительно такой точки, относительно которой область звёздная.
    \end{example}
    \begin{definition}
        Пусть
        $$
        0\leqslant r<R\leqslant+\infty\qquad z_0\in\mathbb C
        $$
        Тогда $K_{r,R}(z_0)=\{z\in\mathbb C\mid r<|z-z_0|<R\}$ называется \textbf{кольцом}. Замкнутое кольцо~--- то же самое, но неравенства нестрогие.
    \end{definition}
    \begin{example}
        Кольцо (не замкнутое) многосвязно. Почему? Ну, возьмём $\rho\in(r;R)$ и возьмём интеграл по окружности с центром в $z_0$ и радиусом $\rho$ от замкнутой формы $\frac1{z-z_0}$. Получим $2\pi\im$, а хочется ноль.
    \end{example}
    \begin{claim}
        В односвязной области любые два пути с общими концами гомотопны.
    \end{claim}
    \begin{proof}
        Идея доказательства такая: возьмём два пути с общими концами ($A$ и $B$), развернём второй, полученный замкнутый путь стянем в точку $C$. После этого проследим, как точка $A$ движется к $C$, и как точка $B$ это делает. Тогда понятно, что дальше использовать в качестве промежуточных путей: начало и конец идём по траекториям $A$ и $B$, а серединку~--- по промежуточному пути между ними.\\
        Точная формула достаточно непроста, и выводить нам её лень, желающие могут почитать учебник.
    \end{proof}
    \begin{claim}
        Нетрудно доказать, что верно и обратное.
    \end{claim}
    \begin{claim}
        Пусть $D$~--- ограниченная область в $\mathbb R^2$ или $\mathbb C$. Тогда следующие утверждения равносильны.
        \begin{enumerate}
            \item $D$ односвязна.
            \item $\partial D$ связна.
            \item $D\compl$ связно.
        \end{enumerate}
        Это уже что-то глубоко топологическое и за рамки курса выходит, поэтому доказывать мы его не будем.
    \end{claim}
    \begin{theorem}
        Замкнутая в односвязной области форма точна в ней.
    \end{theorem}
    \begin{proof}
        Поскольку форма замкнута в односвязной области, интеграл по любому замкнутому пути равен нулю. Всё.
    \end{proof}
    \begin{claim}
        Без доказательства: если в области $D$ всякая замкнутая форма точна, то $D$ односвязна.
    \end{claim}
    \begin{definition}
        Пусть $G$~--- такая область в $\mathbb R^2$ или $\mathbb C$, что
        $$\partial G=\bigsqcup\limits_{k=0}^m\gamma_k^*$$
        Где $\gamma_k$~--- простые регулярные контуры и при обходе каждого контура $G$ остаётся слева. В таком случае
        \begin{itemize}
            \item набор $\{\gamma_k\}_{k=0}^m$ называется \textbf{ориентированной границей} $G$.
            \item $G$ называется \textbf{областью с ориентированной границей}.
            \item \textbf{Интеграл по ориентированной границе} равен сумме интегралов по каждому контуру:
            $$
            \int_{\partial G}\omega=\sum\limits_{k=0}^m\int_{\gamma_k}\omega
            $$
        \end{itemize}
    \end{definition}
    \begin{remark}
        Что такое <<область остаётся слева>>?
        $$
        \forall t\in[0;1]:\exists\gamma'(t)~\exists\delta>0~\forall\tau\in(0;\delta)~\gamma(t)+\im\tau\gamma'(t)\in G
        $$
    \end{remark}
    \begin{example}
        Интеграл по границе невырожденного кольца есть разность двух интегралов: по большой окружности берётся с плюсом, по маленькой~--- с минусом.
    \end{example}
    \begin{theorem}[Интеграл по ориентированной границе области]
        \label{Интеграл по ориентированной границе}
        Пусть $\omega$~--- замкнутая форма в области $D$. Пусть $G$~---  ограниченная область с ориентированной границей, $\overline G\subset D$. Тогда
        $$
        \int_{\partial G}\omega=0
        $$
    \end{theorem}
    \begin{proof}
        Идея доказательства:\\
        Давайте в $G$ проведём попарно непересекающиеся разрезы $\{\lambda_k^*\}_{k=1}^m$, соединяющие $\gamma_0^*$ и $\gamma_1^*$, $\gamma_1^*$ и $\gamma_2^*$, ..., $\gamma_{m-1}^*$ и $\gamma_m^*$. Образовался новый контур
        $$\Lambda=\bigwedge_{k=0}^m\gamma_k\wedge\bigwedge_{k=1}^m\lambda_k^{\pm}$$
        С точностью до порядка слагаемых. Утверждается, что $\Lambda$ стягивается в точку в $D$. (Доказывать это мы не будем.) А если так, то
        $$
        0=\int_\Lambda\omega=\sum_{k=0}^m\int_{\gamma_k}\omega+\cancel{\sum_{k=1}^m\int_{\lambda_k}\omega}+\cancel{\sum_{k=1}^m\int_{\lambda_k^-}\omega}=\int_{\partial G}\omega
        $$
        \begin{figure}[H]
            \begin{tikzpicture}[yscale=-.04,xscale=.04]
                %\path (0,300); %set diagram left start at 0, and has height of 300
                
                %Shape: Polygon Curved [id:ds47300739108333434] 
                \draw  [darkgreen] (242.16,62.22) .. controls (280.16,48.22) and (487.16,25.22) .. (456.16,89.22) .. controls (425.16,153.22) and (553.16,185.22) .. (546.16,233.22) .. controls (539.16,281.22) and (282.16,275.22) .. (228.16,243.22) .. controls (174.16,211.22) and (204.16,76.22) .. (242.16,62.22) -- cycle ;
                %Shape: Polygon Curved [id:ds6444563251158499] 
                \draw  [darkgreen] (298.16,134.22) .. controls (314.16,125.22) and (324.16,146.22) .. (309.16,152.22) .. controls (294.16,158.22) and (323.16,176.22) .. (291.16,168.22) .. controls (259.16,160.22) and (282.16,143.22) .. (298.16,134.22) -- cycle ;
                %Shape: Polygon Curved [id:ds06130421489404325] 
                \draw  [darkgreen] (420.16,205.22) .. controls (430.16,201.22) and (401.16,178.22) .. (440.16,191.22) .. controls (479.16,204.22) and (394.16,228.22) .. (394.16,209.22) .. controls (394.16,190.22) and (410.16,209.22) .. (420.16,205.22) -- cycle ;
                %Shape: Polygon Curved [id:ds8509240807584013] 
                \draw  [red] (289.16,76.22) .. controls (387.16,79.22) and (342.16,141.22) .. (378.16,108.22) .. controls (414.16,75.22) and (496.16,166.22) .. (497.16,220.22) .. controls (498.16,274.22) and (317.16,263.22) .. (255.16,230.22) .. controls (193.16,197.22) and (191.16,73.22) .. (289.16,76.22) -- cycle ;
                %Shape: Polygon Curved [id:ds6853435084854276] 
                \draw  [red] (267.16,151.22) .. controls (269.16,203.22) and (319.16,175.22) .. (329.16,155.22) .. controls (339.16,135.22) and (265.16,99.22) .. (267.16,151.22) -- cycle ;
                %Shape: Polygon Curved [id:ds8496655760582439] 
                \draw  [red] (380.16,217.22) .. controls (411.16,195.22) and (387.16,144.22) .. (422.16,163.22) .. controls (457.16,182.22) and (450.16,213.22) .. (478.16,215.22) .. controls (506.16,217.22) and (349.16,239.22) .. (380.16,217.22) -- cycle ;
                %Straight Lines [id:da5663573294381974] 
                \draw    (329.16,155.22) -- (354.66,186.22) -- (380.16,217.22) ;
                %Straight Lines [id:da4039015697762305] 
                \draw    (422.16,163.22) -- (400.16,135.72) -- (378.16,108.22) ;
                
                % Text Node
                \draw (240.16,58.82) node [anchor=south east] [inner sep=0.75pt]  [darkgreen]  {$D$};
                % Text Node
                \draw (291.16,72.82) node [anchor=south west] [inner sep=0.75pt]  [red]  {$G$};
                % Text Node
                \draw (352.66,189.62) node [anchor=north east] [inner sep=0.75pt]    {$\lambda _{1}$};
                % Text Node
                \draw (265.16,151.22) node [anchor=east] [inner sep=0.75pt]  [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,opacity=1 ]  {$\gamma _{0}$};
                % Text Node
                \draw (424.16,159.82) node [anchor=south west] [inner sep=0.75pt]  [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,opacity=1 ]  {$\gamma _{1}$};
                % Text Node
                \draw (499.16,220.22) node [anchor=west] [inner sep=0.75pt]  [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,opacity=1 ]  {$\gamma _{2}$};
                % Text Node
                \draw (398.16,139.12) node [anchor=north east] [inner sep=0.75pt]    {$\lambda _{2}$};
            \end{tikzpicture}
        \end{figure}
        \begin{remark}
            Эта теорема допускает обобщение, как и определение области с ориентированной границей (например, можно доопределить ориентированную границу для двух окружностей, касающихся внутренним образом). Несмотря на то, что наше определение имеет проблемы с тем, чтобы область <<находилась слева>>, для такой области теорема верна.\\
            эИ верна для намного более хитрых областей. Можно отрезок пройти в одну сторону, потом обратно, можно так сделать с более сложным множеством, можно отказаться от кусочной гладкости (но тогда будет непонятно, что такое <<слева>>).
        \end{remark}
    \end{proof}
    \section{Функции комплексной переменной.}
    \paragraph{Комплексная дифференцируемость.}
    \begin{definition}
        Пусть $f\colon \underset{\subset\mathbb C}D\to\mathbb C$, $z_0\in\Int D$. Если
        $$\exists A\in\mathbb C~f(z)=f(z_0)+A(z-z_0)+o(z-z_0)\qquad z\to z_0$$
        То $f$ называется \textbf{дифференцируемой в точке} $z_0$, а $A$ называется её \textbf{производной в точке} $z_0$ (и обозначается $f'(z_0)$).
    \end{definition}
    \begin{theorem}[Условия комплексной дифференцируемости]
        \label{Условия комплексной дифференцируемости}
        $f\colon \underset{\subset\mathbb C}D\to\mathbb C$, $f=u+\im v$. $z_0=x_0+\im y_0\in\Int D$. Тогда дифференцируемость $f$ в точке $z_0$ равносильна следующему утверждению:\\
        $u$ и $v$ дифференцируемы в $(x_0;y_0)$ и $u'_x(x_0;y_0)=v'_y(x_0;y_0)$ и $u'_y(x_0;y_0)=-v'_x(x_0;y_0)$.
    \end{theorem}
    \begin{remark}
        Условия $u'_x(x_0;y_0)=v'_y(x_0;y_0)$ и $u'_y(x_0;y_0)=-v'_x(x_0;y_0)$ называются либо условиями Коши~--- Римана, либо условиями Д'Аламбера~--- Эйлера.\\
        Условие <<$u$ и $v$ дифференцируемы в $(x_0;y_0)$>> называется вещественной дифференцируемостью $f$.
    \end{remark}
    \begin{proof}
        \begin{itemize}
            \item Следствие <<вниз>>:\\
            Пусть $A=a+\im b$, $z-z_0=\Delta z=\Delta x+\im\Delta y$. Тогда перепишем определение дифференцируемости $f$:
            $$
            f(z_0+\Delta z)=f(z_0)+A\Delta z+\gamma(\Delta z)|\Delta z|,\qquad\gamma(\Delta z)\underset{\Delta z\to0}\longrightarrow0,\gamma=\alpha+\im\beta
            $$
            Распишем это через вещественную и мнимую часть
            \[\begin{split}
                u(x_0&+\Delta x;y_0+\Delta y)+\im v(x_0+\Delta x;y_0+\Delta y)=\\
                &=u(x_0;y_0)+\im v(x_0;y_0)+(a+\im b)(\Delta x+\im\Delta y)+(\alpha(\Delta x;\Delta y)+\im\beta(\Delta x;\Delta y))\sqrt{\Delta x^2+\Delta y^2}
            \end{split}\]
            Запишем это как два равенства (отдельно вещественную и мнимую часть):
            $$
            u(x_0+\Delta x;y_0+\Delta y)=u(x_0;y_0)+a\Delta x-b\Delta y+\alpha(\Delta x;\Delta y)\sqrt{\Delta x^2+\Delta y^2}
            $$
            $$
            v(x_0+\Delta x;y_0+\Delta y)=v(x_0;y_0)+a\Delta y+b\Delta x+\beta(\Delta x;\Delta y)\sqrt{\Delta x^2+\Delta y^2}
            $$
            Это и есть дифференцируемость $u$ и $v$, причём мы ещё знаем что-то об их производных (у нас есть коэффициенты), которые и дают нам условия Коши~--- Римана.
            \item Следствие <<вверх>>~--- прочитайте то же самое в обратном направлении.
        \end{itemize}
    \end{proof}
    \begin{example}
        $$f(z)=\overline z$$
        Тогда $u=x$, $v=y$, $u'_x=1$, $u'_y=0$, $v'_x=0$, $v'_y=-1$. Первое условие Коши~--- Римана не выполнено нигде, а значит $\overline z$ не дифференцируема нигде.
    \end{example}
    \begin{example}
        $$f(z)=|z|$$
        Тут $u=\sqrt{x^2+y^2}$, $v=0$, и мы получаем, что везде, кроме $z=0$, не выполнено первое условие Коши~--- Римана, а в $z=0$ вещественной дифференцируемости нет.
    \end{example}
    \begin{example}
        $$f(z)=|z|^2$$
        Тут $u=\sqrt{x^2+y^2}$, $v=0$, $u'_x=2x$, $u'_y=2y$, $v'_x=v'_y=0$. Отсюда $f'$ дифференцируемо только в нуле, и производная там равна нулю.
    \end{example}
    \begin{remark}
        Так сложилось, что в комплексном анализе дифференцируемые функции также называют голоморфными, аналитическими, регулярными и моногенными. Они имеют разное происхождение, и сейчас мы их обсудим.
    \end{remark}
    \begin{definition}
        Пусть $f\colon\underset{\subset\mathbb C}D\to\mathbb C$. $f$ называется \textbf{дифференцируемой на открытом множестве} $D$, если она дифференцируема в каждой его точке.
    \end{definition}
    \begin{definition}
        $f\colon\underset{\subset\mathbb C}D\to\mathbb C$ называется \textbf{голоморфной в точке} $z_0\in\Int D$, если она дифференцируема в некоторой окрестности $z_0$.
    \end{definition}
    \begin{definition}
        $f\colon\underset{\subset\mathbb C}D\to\mathbb C$ называется \textbf{голоморфной на открытом множестве} $D$, если она голоморфна в каждой его точке. Множество таки функций обозначается $\scriptA(D)$
    \end{definition}
    \begin{remark}
        Далее в той главе, если не оговорено обратное, $D$~--- область.
    \end{remark}
    \begin{theorem}
        Пусть $f$ голоморфна в $D$. Если $\Re f=\mathrm{const}$ ИЛИ $\Im f=\mathrm{const}$ ИЛИ $|f|=\mathrm{const}$, то $f=\mathrm{const}$.
    \end{theorem}
    \begin{proof}
        Пусть $f=u+iv$.
        \begin{enumerate}
            \item Известно, что $u'_x=u'_y=0$, по условиям Коши~--- Римана $v'_x=v'_y=0$, отсюда $v=\mathrm{const}$.
            \item Аналогично предыдущему.
            \item $|f|^2=u^2+v^2=\mathrm{const}$. Если это равно нулю, ясно, иначе продифференцируем это по $x$ и $y$ и поделим на 2:
            $$
            uu'_x+vv'_x=0
            $$
            $$
            uu'_y+vv'_y=0
            $$
            Подставим в условие Коши~--- Римана?
            $$
            \left\{\begin{aligned}
                uu'_x-vu'_y&=0\\
                uu'_y+vu'_x&=0
            \end{aligned}\right.
            $$
            Это система уравнений с неизвестными $u'_x$ и $u'_y$. Определитель системы равен $u^2+v^2\neq0$, значит они имеет только тривиальное решение: $u'_x=u'_y=0$.
        \end{enumerate}
    \end{proof}
    \begin{theorem}[Интегральная теорема Коши]
        \label{Интегральная теорема Коши}
        Если $f\in\scriptA(D)$, то форма $f\mathrm dz$ замкнута в $D$.
    \end{theorem}
    \begin{proof}
        Это доказательство будет при дополнительном условии: $f\in C^{(1)}(D)$. Тогда эта теорема нам уже известна, но сказана иначе.\\
        Пусть $f=u+\im v$, $\mathrm dz=\mathrm dx+\im\mathrm dy$. Тогда
        $$
        f\mathrm dz=(u+\im v)(\mathrm dx+\im\mathrm dy)=\underbrace{(u+\im v)}_P\mathrm dx+\underbrace{(-v+\im u)}_Q\mathrm dy
        $$
        Тогда нам нужно проверить равенство $P'_y=Q'_x$, при этом $P'_y=u'_y+\im v'_y$, $Q'_y=-v'_x+\im u'_x$. Ну так это равенство совпадает с условиями Коши~--- Римана.
    \end{proof}
    \begin{claim}
        $F$~--- первообразная формы $\omega=f\mathrm dz$ тогда и только тогда, когда $F$~--- первообразная $f$ (в смысле комплексной дифференцируемости).
    \end{claim}
    \begin{proof}
        Пусть $F=U+\im V$, $f=u+\im v$. Что значит, что $F$~--- первообразная $\omega$? То, что
        $$
        \left\{\begin{aligned}
            F'_x&=P\\
            F'_y&=Q
        \end{aligned}\right.\Leftrightarrow
        \left\{\begin{aligned}
            U'_x+\im V'_x&=u+\im v\\
            U'_y+\im V'_y&=-v+\im u
        \end{aligned}\right.
        $$
        Отсюда для $F$ выполнены условия Коши~--- Римана, значит у неё есть производная, и она равна, разумеется, $f$. Верно и обратное.
    \end{proof}
    \begin{lemma}[Лемма Гурса]
        \label{Лемма Гурса}
        Если $f$ голоморфна в $D$, то интеграл от неё по любому прямоугольнику, лежащему вместе с внутренностью в $D$, равен нулю.
    \end{lemma}
    \begin{proof}
        Пусть существует прямоугольник $\gamma_0$ (такой что условие выше), по которому интеграл не равен нулю. Пусть
        $$
        M=\left|\int_{\gamma_0}f(z)~\mathrm dz\right|
        $$
        А дальше давайте поделим на прямоугольник на 4 равные части $\sigma_1$, $\sigma_2$, $\sigma_3$ и $\sigma_4$ (как мы делали в теореме \ref{Замкнутая в круге форма точна}), и тогда в некотором прямоугольнике $\sigma_j$
        $$
        \left|\int_{\sigma_j}f(z)~\mathrm dz\right|\geqslant\frac M4
        $$
        Это самое $\sigma_j$ обозначим за $\gamma_1$ и продолжим делать это бесконечно.\\
        В итоге получим $\{\gamma_k\}_{k=0}^\infty$. Пусть $F_k$~--- замкнутый прямоугольник, ограниченный $\gamma_k$. Пусть $p_k$~--- длина $\gamma_k$ (или периметр $F_k$). У всех прямоугольников есть общая точка $z_0\in D$.\\
        Ну, хорошо. Запишем дифференцируемость $f$ в $z_0$:
        $$
        f(z)=f(z_0)+f'(z_0)(z-z_0)+\alpha(z)(z-z_0)
        $$
        Где $\alpha$ бесконечно мала при $z\to z_0$.\\
        Ну, а раз бесконечно мала,
        $$
        \exists r>0~B(z_0;r)\subset D\land\forall z\in B(z_0;r)~|\alpha(z)|<\frac{M}{2p_0^2}
        $$
        Но тогда $\exists N~F_N\subset B(z_0;r)$. Выпишем интеграл по $\gamma_N$:
        $$
        \int_{\gamma_N}f(z)~\mathrm dz=\int_{\gamma_N}f(z_0)~\mathrm dz+\int_{\gamma_N}f'(z_0)(z-z_0)~\mathrm dz+\int_{\gamma_N}\alpha(z)(z-z_0)~\mathrm dz
        $$
        Первые два интеграла~--- от точных форм, значит равны нулю. А значит
        $$
        \left|\int_{\gamma_N}f(z)~\mathrm dz\right|=\left|\int_{\gamma_N}\alpha(z)(z-z_0)~\mathrm dz\right|\leqslant p_N\frac{M}{2p_0^2}p_N\overset{p_N=2^{-N}p_0}=\frac M{2\cdot 4^N}
        $$
        А мы строили наши прямоугольники так, что
        $$
        \left|\int_{\gamma_k}f(z)~\mathrm dz\right|\geqslant\frac M{4^k}
        $$
        Значит противоречие.
    \end{proof}
    \begin{corollary}
        Если $f\in\scriptA(D)$, а $\gamma_0$ и $\gamma_1$ гомотопны в $D$, то
        $$
        \int_{\gamma_0}f=\int_{\gamma_1}f
        $$
    \end{corollary}
    \begin{corollary}
        Если $f\in\scriptA(D)$, а $\gamma$ стягивается в точку в $D$, то
        $$
        \int_\gamma f=0
        $$
    \end{corollary}
    \begin{corollary}
        Если $f\in\scriptA(D)$, $D$ односвязна, а $\gamma$~--- замкнутый путь в $D$, то
        $$
        \int_{\gamma}f=0
        $$
    \end{corollary}
    \begin{corollary}
        Если $f\in\scriptA(D)$, то локально $f$ имеет первообразную в $D$.
    \end{corollary}
    \begin{corollary}
        Если $f\in\scriptA(D)$, $D$ односвязна, то $f$ имеет первообразную в $D$.
    \end{corollary}
    \begin{corollary}
        Если $f\in\scriptA(D)$, $G$~--- ограниченная область с ориентированной границей, $\overline G\subset D$. Тогда
        $$
        \int_{\partial G}f=0
        $$
    \end{corollary}
    \begin{remark}
        В последнем достаточно $f\in\scriptA(G)$ и $f\in C(\overline G)$. Почему? Можно построить последовательность областей $G_n:\overline{G_n}\subset G$ так чтобы $\int_{\partial G_n}f\to\int_{\partial G}f$.
    \end{remark}
    \begin{proof}
        Второе доказательство \hyperref[Интегральная теорема Коши]{интегральной теоремы Коши} следует из леммы \ref{Лемма Гурса}. Из леммы форма точна в любом круге в $D$, и тем самым замкнута в $D$.
    \end{proof}
    \paragraph{Интегральная формула Коши и её следствия.}
    \begin{theorem}[Интегральная формула Коши]
        \label{Интегральная формула Коши}
        Пусть $f\in\scriptA(D)$, $G$~--- ограниченная область с ориентированной границей, $\overline G\subset D$. Тогда
        $$
        \frac1{2\pi\im}\int_{\partial G}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta=\begin{cases}
            f(z)&z\in G\\
            0&z\notin\overline G
        \end{cases}
        $$
    \end{theorem}
    \begin{remark}
        Интеграл в левой части формулы называется интегралом Коши.
    \end{remark}
    \begin{remark}
        Если $z\in\partial G$, то интеграл Коши теряет смысл (знаменатель обращается в ноль).
    \end{remark}
    \begin{remark}
        В левой части участвуют значения функции только на границе, а справа имеется значение в области. И как бы да, так и должно быть, значения голоморфной функции в области определяется её значениями на границе.
    \end{remark}
    \begin{proof}
        Пусть
        $$
        g(\zeta)=\frac{f(\zeta)}{\zeta-z}
        $$
        Где голоморфна $g$? Там же, где $f$, кроме, возможно, $\zeta=z$.\\
        Итак, рассматриваем случаи
        \begin{itemize}
            \item[$z\notin\overline G$] Тогда $\overline G\subset D\setminus\{z\}$, и тогда просто работает \hyperref[Интегральная теорема Коши]{интегральная теорема Коши}.
            \item[$z\in G$] Возьмём круг достаточно малого радиуса и удалим его из $G$:
            $$
            \exists r>0~\overline B(z;r)\subset G
            $$
            Пусть $\rho\in(0;r]$, $G_\rho=G\setminus\overline B(z;\rho)$. $G_\rho$~--- это тоже область с ориентированной границей. И к области $G_\rho$ можно применить \hyperref[Интегральная теорема Коши]{интегральную теорему Коши}:
            $$
            0=\int_{\partial G_\rho}g(\zeta)~\mathrm d\zeta=\int_{\partial G}g(\zeta)~\mathrm d\zeta-\int_{\gamma_{\rho,z}}g(\zeta)~\mathrm d\zeta
            $$
            Ну, хорошо, тогда
            $$
            \int_{\partial G}g(\zeta)~\mathrm d\zeta=\int_{\gamma_{\rho,z}}g(\zeta)~\mathrm d\zeta=\int_{\gamma_{\rho,z}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta=f(z)\underbrace{\int_{\gamma_{\rho,z}}\frac{\mathrm d\zeta}{\zeta-z}}_{2\pi i}+\int_{\gamma_{\rho,z}}\frac{f(\zeta)-f(z)}{\zeta-z}~\mathrm d\zeta
            $$
            То есть нам надо доказать, что $\int_{\gamma_{\rho,z}}\frac{f(\zeta)-f(z)}{\zeta-z}~\mathrm d\zeta=0$. Обозначим подинтегральное выражение как $h(\zeta)$. И доопределим её по непрерывности:
            $$
            h(\zeta)=\begin{cases}
                \frac{f(\zeta)-f(z)}{\zeta-z} & \zeta\in\dot{\overline{B}}(z;r)\\
                f'(z)&\zeta=z
            \end{cases}
            $$
            То есть $h$ непрерывна в $\overline{B}(z;r)$, а значит по теореме Вейерштрасса ограничена:
            $$\exists M>0~\forall\zeta\in\overline B(z;r)~|h(\zeta)|\leqslant M$$ 
            Тогда
            $$
            \left|\int_{\gamma_{\rho,z}}h(z)~\mathrm dz\right|\leqslant2\pi\rho M\underset{\rho\to0+}\longrightarrow0
            $$
            При этом интеграл слева никак не зависит от $\rho$ (так как равен разности $\int_{\partial G}g(\zeta)~\mathrm d\zeta-f(z)2\pi\im$), а значит тупо равен нулю.
        \end{itemize}
    \end{proof}
    \begin{corollary}[Теорема о среднем для голоморфных функций]
        \label{Теорема о среднем для голоморфных функций}
        Пусть $f\in\scriptA(D)$, $z_0\in\mathbb C$, $r\in(0;+\infty)$, $\overline B(z_0;r)\subset D$. Тогда
        $$
        f(z_0)=\frac1{2\pi}\int\limits_{-\pi}^\pi f(z_0+re^{\im t})~\mathrm dt
        $$
    \end{corollary}
    \begin{proof}
        $$f(z)=\frac1{2\pi\im}\int_{\gamma_{r,z_0}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta$$
        Осталось параметризовать окружность $\gamma_{r,z_0}$ как $\zeta=z_0+re^{\im t}$, $\mathrm d\zeta=r\im e^{\im t}~\mathrm dt$. Тогда распишем и получим то, что нам надо.
    \end{proof}
    \begin{theorem}[Аналитичность голоморфной функции]
        \label{Голоморфная функция аналитична}
        Пусть $z_0\in\mathbb C$, $R\in(0;+\infty]$, $f\in\scriptA(B(z_0;R))$. Тогда $f$ в этом круге раскладывается в степенной ряд с центром в $z_0$.
    \end{theorem}
    \begin{proof}
        Рассмотрим $z\in B(z_0;R)$. Существует $r>0~|z-z_0|<r<R$.
        $$
        f(z)=\frac1{2\pi\im}\int_{\gamma_{r,z}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta
        $$
        Давайте разложим подинтегральную функцию по степеням $z-z_0$, после чего проинтегрируем ряд почленно и получим искомое разложение:
        $$
        \frac{f(\zeta)}{\zeta-z}=f(\zeta)\frac1{\zeta-z_0}\frac1{1-\frac{z-z_0}{\zeta-z_0}}
        $$
        В силу того, что $\left|\frac{z-z_0}{\zeta-z_0}\right|=\left|\frac{z-z_0}r\right|<1$ штука сверху равна
        $$
        \frac{f(\zeta)}{\zeta-z_0}\sum\limits_{k=0}^\infty\left(\frac{z-z_0}{\zeta-z_0}\right)^k
        $$
        По \hyperref[Признак Вейерштрасса]{признаку Вейерштрасса} ряд равномерно сходится $\gamma^*_{r;\zeta_0}$, а умножение на ограниченную функцию $\zeta\mapsto\frac{f(\zeta)}{\zeta-z_0}$ (знаменатель равен $r$, числитель непрерывен, следовательно, ограничен) не нарушает равномерной сходимости. Отсюда
        $$
        f(z)=\sum\limits_{k=0}^\infty\underbrace{\left(\frac1{2\pi\im}\int_{\gamma_{r,z_0}}\frac{f(\zeta)}{(z-z_0)^{k+1}}~\mathrm d\zeta\right)}_{c_k}(z-z_0)^k
        $$
        Нам нужно лишь доказать, что $c_k$ не зависит от $z$. А по построению зависит, так как $r$ зависит от $z$.\\
        Хм-м, ну, окружности с разными радиусами гомотопны в $\dot B(z_0;R)$, а $\zeta\mapsto\frac{f(\zeta)}{(\zeta-z_0)^{k+1}}$ голоморфна в $\dot B(z_0;R)$, значит коэффициенты равны.
    \end{proof}
    \begin{corollary}
        Пусть $f\in\scriptA(D)$, $z\in D$. Тогда $f$ раскладывается в степенной ряд в круге $B(z_0;\rho(z_0;\partial D))$.
    \end{corollary}
    \begin{remark}
        Но вообще радиус сходимости может быть и больше.
    \end{remark}
    \begin{corollary}
        Голоморфная функция бесконечно дифференцируема.
    \end{corollary}
    \begin{corollary}
        Все производные голоморфной функции голоморфны.
    \end{corollary}
    \begin{corollary}
        Если $f$ имеет первообразную в $D$, то она голоморфна в $D$.
    \end{corollary}
    \begin{corollary}
        \label{cor:Замкнутая форма голоморфна}
        Если $f\mathrm dz$ замкнута, то $f$ голоморфна в $D$.
    \end{corollary}
    \begin{corollary}[Теорема Морера]
        \label{Теорема Морера}
        Если $f\in C(D)$ и $\int_\gamma f=0$ для любого прямоугольника $\gamma$, лежащего в $D$ вместе с внутренностью, то $f\in\scriptA(D)$.
    \end{corollary}
    \begin{remark}
        Непрерывность $f$ существенна, контрпример: $f=0$ всюду, кроме одной точки, в которой $f=1$.
    \end{remark}
    \begin{theorem}[Свойства, равносильные голоморфности]
        Пусть $D$~--- область в $\mathbb C$, $f\colon D\to\mathbb C$. Тогда следующие утверждения равносильны.
        \begin{enumerate}
            \item $f$ голоморфна в $D$.
            \item $f$ аналитична в $D$.
            \item Локально $f$ имеет первообразную в $D$.
            \item Форма $f\mathrm dz$ замкнута в $D$.
            \item $f\in C(D)$ и $\int_\gamma f=0$ для любого прямоугольника $\gamma$, лежащего в $D$ вместе с внутренностью/
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item[$1\to2$] \hyperref[Голоморфная функция аналитична]{Аналитичность голоморфной функции}.
            \item[$2\to1$] \hyperref[Дифференцирование степенных рядов]{Дифференцирование степенных рядов}.
            \item[$1\to4$] \hyperref[Интегральная теорема Коши]{Интегральная теорема Коши}.
            \item[$3\leftrightarrow4$] Замечание к \hyperref[Интегральная теорема Коши]{теореме Коши}.
            \item[$4\to1$] Следствие \ref{cor:Замкнутая форма голоморфна} из \hyperref[Голоморфная функция аналитична]{аналитичности голоморфной функции}.
            \item[$1\to5$] \hyperref[Лемма Гурса]{Лемма Гурса}.
            \item[$5\to1$] \hyperref[Теорема Морера]{Теорема Морера}.
        \end{itemize}
    \end{proof}
    \begin{remark}
        $$
        c_k=\frac1{2\pi\im}\int_{\gamma_{r,z_0}}\frac{f(\zeta)}{(\zeta-z_0)^{k+1}}~\mathrm d\zeta
        $$
        При этом, из того, что $f\in\scriptA(D)$, следует, что $\gamma_{r,z_0}$ можно заменить на любой гомотопный уме путь в $D\setminus\{z_0\}$.
    \end{remark}
    \begin{claim}
        $$c_k=\frac{f^{(k)}(z_0)}{k!}$$
        Отсюда
        $$\frac{f^{(k)}(z)}{k!}=\frac1{2\pi\im}\int_{\gamma_{r,z}}\frac{f(\zeta)}{(\zeta-z)^{k+1}}~\mathrm d\zeta$$
    \end{claim}
    \begin{claim}
        $f\in\scriptA(D)$, $G$~--- ограниченная область с ориентированной границей, $\overline G\subset D$, $z\in G$, $k\in\mathbb Z_+$
        $$
        f^{(k)}(z)=\frac{k!}{2\pi\im}\int_{\partial G}\frac{f(\zeta)}{(\zeta-z)^{k+1}}~\mathrm d\zeta
        $$
    \end{claim}
    \begin{lemma}[Неравенства Коши для коэффициентов степенного ряда]
        \label{Неравенства Коши для коэффициентов степенного ряда}
        Пусть $z_0\in\mathbb C$, $R\in(0;+\infty]$,
        $$
        f(z)=\sum\limits_{k=0}^\infty c_k(z-z_0)^k\qquad |z-z_0|<R
        $$
        Тогда
        $$
        \forall k\in\mathbb Z~\rho\in(0;R)~|c_k|\leqslant\frac{M_f(\rho)}{\rho^k}
        $$
        Где
        $$
        M_f(\rho)=\max\limits_{|z-z_0|=\rho}|f(z)|
        $$
    \end{lemma}
    \begin{proof}
        $$
        |c_k|=\left|\frac1{2\pi\im}\int_{\gamma_{r,z_0}}\frac{f(\zeta)}{(\zeta-z_0)^{k+1}}~\mathrm d\zeta\right|\leqslant=\frac1{2\pi}\cdot2\pi\rho\cdot\frac{M_f(\rho)}{\rho^{k+1}}=\frac{M_f(\rho)}{\rho^k}
        $$
    \end{proof}
    \begin{definition}
        Функция, голоморфная во всей $\mathbb C$, называется \textbf{целой}.
    \end{definition}
    \begin{theorem}[Теорема Лиувилля]
        \label{Теорема Лиувилля}
        Целая ограниченная функция постоянна.
    \end{theorem}
    \begin{proof}
        Пусть $M>0$~--- та константа, которой ограничена наша функция: $\forall z\in\mathbb C~|f(z)|\leqslant M$.\\
        $f$ целая, следовательно
        $$
        \forall z\in\mathbb C~f(z)=\sum\limits_{k=0}^\infty c_kz^k
        $$
        Оценим \hyperref[Неравенства Коши для коэффициентов степенного ряда]{по Коши} коэффициенты $c_k$:
        $$
        \forall\rho\in(0;\infty)~|c_k|\leqslant\frac{M_f(\rho)}{\rho^k}\leqslant\frac M{\rho^k}
        $$
        Устремим $\rho$ к $+\infty$. Тогда $\forall k\in\mathbb N~c_k=0$. То есть $f(z)=c_0=\mathrm{const}$.
    \end{proof}
    \begin{theorem}[Основная теорема высшей алгебры]
        \label{Основная теорема высшей алгебры}
        Всякий многочлен положительной степени имеет корень в $\mathbb C$.
    \end{theorem}
    \begin{proof}
        Обозначим многочлен буквой $p$, а степень его~--- буквой $n$.\\
        Пусть не так (т.е. $\forall z\in\mathbb C~p(z)\neq0$). Рассмотрим
        $f=\frac1p$. Получается целая функция. Также $p(z)\underset{z\to\infty}\longrightarrow\infty$. Отсюда $f$ ограничена:
        $$
        \exists R>0~\forall z:|z|>R~|f(z)|<1
        $$
        А в круге $\overline B(0;R)$ $f$ ограничена по теореме Вейерштрасса. Тогда $f$ ограничена максимумом из $R$ и 1. По \hyperref[Теорема Лиувилля]{теореме Лиувилля} $f=\mathrm{const}$. Поскольку она стремится к 0 при $z\to\infty$, $f\equiv0$, противоречие.
    \end{proof}
    \begin{lemma}
        Пусть $f\in\scriptA(D)$. Тогда следующие утверждения равносильны:
        \begin{enumerate}
            \item $\exists z_0\in D~\forall k\in\mathbb Z_+~f^{(k)}(z)=0$.
            \item $f\equiv0$ в некотором круге $B\subset D$.
            \item $f\equiv0$ в $D$.
        \end{enumerate}
    \end{lemma}
    \begin{proof}\mbox{}\\
        \begin{itemize}
            \item[$3\to2$] Очевидно.
            \item[$2\to1$] Очевидно.
            \item[$1\to3$] Пусть
            $$
            E=\{z\in D\mid \exists V_z~f\equiv0\text{ в }V_z\}
            $$
            Хочется доказать, что $E=D$. Для этого хочется воспользоваться \hyperref[Линейно связное пространство связно]{признаком совпадения подобласти с областью}. Для этого надо доказать, что $E$ не пусто, открыто и замкнуто в $D$.
            \begin{itemize}
                \item[$E\neq\varnothing$] $\forall z\in V_{z_0}$
                $$
                f(z)=\sum\limits_{k=0}^\infty\frac{f^{(k)}}{k!}(z-z_0)^k=0
                $$
                Отсюда $z_0\in E$.
                \item[$E$ открыто] Тривиально.
                \item[$E$ замкнуто в $D$] Рассмотрим последовательность $\{z_n\}\subset D:z_n\to z^*\in D$. Проверим, что $z^*\in E$. Ну,
                $$
                \forall k\in\mathbb Z_+~\forall n\in\mathbb N~f^{(k)}(z_n)=0
                $$
                Устремив тут $n$ к бесконечности, получим $f^{(k)}(z^*)=0$, что значит $z^*\in E$ (аналогично $E\neq\varnothing$).
            \end{itemize}
        \end{itemize}
    \end{proof}
    \begin{theorem}[Изолированность нулей голоморфной функции]
        \label{Изолированность нулей голоморфной функции}
        Пусть $f\in\scriptA(D)$, $f\not\equiv0$. Пусть $z_0\in D,f(z_0)=0$. Тогда
        $$\exists M\in\mathbb N~\exists g\in\scriptA(D)~g(z_0)\neq0\land\forall z\in D~f(z)=(z-z_0)^mg(z)$$
        В частности, $f$ не обращается в ноль в некоторой проколотой окрестности $z_0$.
    \end{theorem}
    \begin{proof}
        Пусть
        $$
        m=\min\{k\in\mathbb N\mid f^{(k)}\neq0\}
        $$
        Это определение $m$ корректно (в силу леммы выше оно не пусто).\\
        Теперь разложим $f$ в степенной ряд в некоторой окрестности $z_0$:
        $$
        f(z)=\sum\limits_{k=m}^\infty\frac{f^{(k)}(z_0)}{k!}(z-z_0)^k\underset{l=k-m}=(z-z_0)^m\underbrace{\sum\limits_{l=0}^\infty\frac{f^{(m+l)}(z_0)}{(m+l)!}(z-z_0)^l}_{g(z)}\qquad z\in U_{z_0}
        $$
        Пока что $g$ определена (и голоморфна) в $U_{z_0}$. $g(z_0)$ не равно нулю, потому что $f^{(m)}(z_0){m!}\neq0$ в силу выбора $m$.\\
        Положим $g(z)=\frac{f(z)}{(z-z_0)^m}$ при $z\in D\setminus U_{z_0}$. Тогда тождество будет выполнено на всём множестве $D$ и $g$ будет аналитично в $D$.
    \end{proof}
    \begin{definition}
        Число $m$ из теоремы \ref{Изолированность нулей голоморфной функции} называется \textbf{кратностью/порядком нуля/корня} $z_0$.
    \end{definition}
    \begin{claim}
        Пусть
        $$
        m=\min\{k\in\mathbb N\mid f^{(k)}\neq0\}
        $$
        $$
        M=\max\{l\in\mathbb N\mid \frac{f(z)}{(z-z_0)^l}\in\scriptA(D)\}
        $$
        Тогда $m=M$.
    \end{claim}
    \begin{proof}
        Из доказательства теоремы \ref{Изолированность нулей голоморфной функции} мы уже знаем, что $m\leqslant M$. Докажем обратное неравенство.\\
        Пусть
        $$f(z)=(z-z_0)^lg(z)$$
        По правилу Лейбница $\forall k\in[0:l-1]~f^{(k)}(z_0)=0$. Отсюда как раз $M\leqslant m$.
    \end{proof}
    \begin{corollary}
        Если $fg\in\scriptA(D)$ и $fg\equiv0$, то одна из функций тождественна равна нулю.
    \end{corollary}
    \begin{remark}
        Для вещественных функций из $C^{(\infty)}$ это не так. Ведь там у нас есть весёлая функция, у которой все производные равны нулю, а сама она~--- не тождественный ноль.
    \end{remark}
    \begin{theorem}[Теорема единственности для голоморфных функций]
        \label{Теорема единственности для голоморфных функций}
        Пусть $f,g\in\scriptA(D)$, множество
        $$
        E=\{z\in D\mid f(z)=g(z)\}
        $$
        имеет предельную точку. Тогда $f\equiv g$.
    \end{theorem}
    \begin{proof}
        Пусть $h=f-g\in\scriptA(D)$, $\{z_n\}\subset E$, $z_n\to z^*\in E$. Так, ну, $h(z_n)=0$, а $h$ голоморфна и тем более непрерывна, поэтому $h(z^*)$~--- неизолированный ноль $h$ в $D$. Значит $h\equiv0$.
    \end{proof}
    \begin{remark}
        В качестве $E$ может выступать промежуток на прямой, участок кривой и уж тем более область. Да и вообще любое несчётное множество годится (проверьте это сами).
    \end{remark}
    \begin{example}
        $E\subset D$, $E$~--- невырожденный промежуток $\mathbb R$. Тогда $z\mapsto\sum\limits_{k=0}^\infty\frac{z^k}{k!}$~--- единственный способ продолжить экспоненту с $\mathbb R$ на $\mathbb C$ с сохранением дифференцируемости (аналогично $\sin$ и $\cos$).
    \end{example}
    \begin{example}
        $\sin^2z+\cos^2z=1$, что на $\left(0;\frac\pi2\right)$~--- теорема Пифагора. А во всех остальных точках~--- теорема о единственности, и можно ничего не делать: не манипулировать рядами и не раскладывать через экспоненту.
    \end{example}
    \begin{example}
        Функции, равные в счётном количестве точек, могут быть не равны ($\sin x$ и $0$ равны в бесконечном количестве точек).\\
        $\sin\frac1z$ имеет своими нулями $\{\frac1{k\pi}\mid k\in\mathbb Z\setminus\{0\}\}$, и это множество уже имеет предельную точку (ноль), но тут тоже не работает теорема о единственности, потому что $\sin\frac1z$ не голоморфна в нуле.
    \end{example}
    \begin{definition}
        Если $f(z_0)=A$, то $z_0$ называется \textbf{$A$-точкой} функции $f$.
    \end{definition}
    \begin{claim}
        $A$-точки голоморфной функции $f\not\equiv A$ изолированы.
    \end{claim}
    \begin{proof}
        Следствие из теоремы \ref{Изолированность нулей голоморфной функции}.
    \end{proof}
    \begin{theorem}[Принцип максимума модуля]
        \label{Принцип максимума модуля}
        Пусть $f\in\scriptA(D)$, $z_0\in D$, $|f(z_0)|=\max\limits_{z\in D}|f(z)|$. Тогда $f=\mathrm{const}$.
    \end{theorem}
    \begin{proof}
        Пусть $M=|f(z_0)|$, $B(z_0;r)\subset D$, $\rho\in(0;\rho)$. Запишем \hyperref[Теорема о среднем для голоморфных функций]{теорему о среднем}:
        $$
        M=|f(z_0)|=\left|\frac1{2\pi}\int\limits_{-\pi}^\pi f(z_0+\rho e^{\im t})~\mathrm dt\right|\leqslant\frac1{2\pi}\int\limits_{-\pi}^\pi|f(z_0+\rho e^{\im t})|~\mathrm dt\leqslant M
        $$
        Значит везде по пути были равенства, а значит
        $$
        \frac1{2\pi}\int\limits_{-\pi}^\pi M-|f(z_0+\rho e^{\im t})|~\mathrm dt=0
        $$
        А подинтегральная функция у нас всюду неотрицательна (и, разумеется, непрерывна). Значит она равна нулю. То есть
        $$\forall t\in[-\pi;\pi]~|f(z_0)+\rho e^{\im t}|=M$$
        И в силу произвольности $\rho$ $|f|=M$ на всём $B(z_0;r)$, а у нас была теорема о том, что если модуль голоморфной функции постоянен, то она тоже. А отсюда $f=\mathrm{const}$ в $D$.
    \end{proof}
    \begin{corollary}
        Если $f\in\scriptA(D)$, $f\neq\mathrm{const}$, то $|f|$ не имеет максимума в $D$, даже локального.
    \end{corollary}
    \begin{corollary}
        Пусть $D$~--- ограниченная область в $\mathbb C$, $f\in C(\overline D)\cap\scriptA(D)$. Тогда $\max\limits_{\overline D}|f|=\max\limits_D|f|$.
    \end{corollary}
    \begin{corollary}
        Пусть $f\in\scriptA(D)$, $f$ не имеет нулей в $D$, $f\neq\mathrm{const}$. Тогда $|f|$ не имеет минимума в $D$ (даже локального).
    \end{corollary}
    \begin{proof}
        Рассмотрим $\frac1f$. Всё.
    \end{proof}
    \paragraph{Ряды Лорана и вычеты.}
    \begin{remark}
        Договоримся, что $\sum\limits_{k=-\infty}^{-m}a_k$ равно $\sum\limits_{k=m}^\infty a_{-k}$.
    \end{remark}
    \begin{definition}
        \textbf{Рядом Лорана} называется ряд вида
        $$
        \sum\limits_{k=-\infty}^\infty c_k(z-z_0)^k
        $$
        При этом ряд
        $$
        \sum\limits_{k=0}^\infty c_k(z-z_0)^k
        $$
        называется \textbf{правильной частью} ряда Лорана, а ряд
        $$
        \sum\limits_{k=-\infty}^{-1}c_k(z-z_0)^k
        $$
        --- \textbf{главной частью} ряда Лорана.\\
        Тогда говорят, что \textbf{ряд Лорана сходится}, если сходятся его главная и правильная части. Ряду Лорана присваивается значение, равной сумме главной и правильной части.
    \end{definition}
    \begin{property}[Множество сходимости ряда Лорана]
        Существуют такие $r,R\in[0;+\infty]$, что
        \begin{enumerate}
            \item $\forall z:r<|z-z_0|<R$ ряд Лорана абсолютно сходится.
            \item $\forall z:|z-z_0|<r\lor|z-z_0|>R$ ряд Лорана расходится.
        \end{enumerate}
    \end{property}
    \begin{proof}
        Пусть $R$~--- радиус сходимости правильной части. Теперь пусть $w=\frac1{z-z_0}$, тогда главная часть равна
        $$
        \sum\limits_{k=1}^\infty c_{-k}w^k
        $$
        У этого чуда есть радиус сходимости $\rho$. Тогда при $\left|\frac1{z-z_0}\right|<\rho$ ряд абсолютно сходится, при $\left|\frac1{z-z_0}\right|>\rho$~--- расходится. Тогда в качестве $r$ будет выступать $\frac1\rho$.
    \end{proof}
    \begin{remark}
        Итого имеем несколько случаев
        \begin{enumerate}
            \item $r>R$~--- не интересно, везде расходится.
            \item $r=R$~--- вообще содержательный случай, но не в смысле комплексной дифференцируемости, так как мы получаем окружность (её часть, точнее), а мы хотим область.
            \item $r<R$~--- содержательный случай: ряд сходится в открытом кольце и, возможно, в каких-то точках его границы.
        \end{enumerate}
    \end{remark}
    \begin{property}[Равномерная сходимость ряда Лорана]
        \label{Равномерная сходимость ряда Лорана}
        Пусть $0\leqslant r<R\leqslant +\infty$. Тогда
        $$
        \forall r_1,R_1:r<r_1<R_1<R~\text{ряд Лорана равномерно сходится в замкнутом кольце }\overline K_{r_1,R_1}(z_0)
        $$
    \end{property}
    \begin{proof}
        См. соответствующий результат о степенных рядах.
    \end{proof}
    \begin{property}[Дифференцирование рядов Лорана]
        \label{Дифференцирование рядов Лорана}
        Пусть $0\leqslant r<R\leqslant+\infty$. $f(z)=\sum\limits_{k=-\infty}^\infty c_k(z-z_0)^k$ в $r<|z-z_0|<R$. Тогда $f\in\scriptA(K_{r,R}(z_0))$ и ряд можно дифференцировать почленно любое число раз.
    \end{property}
    \begin{proof}
        Рассмотрим правильную и главную часть отдельно. Правильную можно дифференцировать в круге сходимости любое количество раз, это мы знаем. Поэтому разберёмся с главной частью:
        $$
        g(z)=h(w)=\sum\limits_{k=1}^\infty c_{-k}w^k\qquad w=\frac1{z-z_0}
        $$
        Понятно, что $h$ дифференцируемо в круге сходимости, а значит и $g$~--- тоже по правилу дифференцирования композиции:
        $$
        g'(z)=h'(w)\frac{-1}{(z-z_0)^2}=\sum\limits_{k=1}^\infty kc_{-k}w^{k-1}\frac{-1}{(z-z_0)^2}=\sum\limits_{k=1}^\infty (-k)c_{-k}(z-z_0)^{-k-1}=\sum\limits_{k=-\infty}^{-1}kc_k(z-z_0)^{k-1}
        $$
    \end{proof}
    \begin{property}[Единственность коэффициентов Лорана]
        Пусть $0\leqslant r<R\leqslant+\infty$,
        $$
        f(z)=\sum\limits_{k=-\infty}^\infty c_k(z-z_0)^k\qquad r<|z-z_0|<R
        $$
        Тогда $c_k$ определяется единственным образом формулой
        $$
        c_k=\frac1{2\pi\im}\int_{\gamma_{\rho,z_0}}\frac{f(\zeta)}{(\zeta-z_0)^{k+1}}~\mathrm d\zeta
        $$
        Где $\rho\in(r;R)$.
    \end{property}
    \begin{proof}
        По свойству \ref{Равномерная сходимость ряда Лорана} на $\gamma^*_{\rho,z_0}$ ряд равномерно сходится. Функция $\zeta\mapsto\frac1{(\zeta-z_0)^{k+1}}$ ограничена на $\gamma^*_{\rho,z_0}$, а значит равномерная сходимость сохраняется при умножении на неё:
        $$
        \frac1{2\pi\im}\int_{\gamma_{\rho,z_0}}\frac{f(\zeta)}{(\zeta-z_0)^{k+1}}~\mathrm d\zeta=
        \frac1{2\pi\im}\int_{\gamma_{\rho,z_0}}\sum\limits_{n=-\infty}^\infty c_n(\zeta-z_0)^{n-k-1}~\mathrm d\zeta=
        \sum\limits_{n=-\infty}^\infty c_n\underbrace{\frac1{2\pi\im}\int_{\gamma_{\rho,z_0}}(\zeta-z_0)^{n-k-1}~\mathrm d\zeta}_{\delta_{nk}}=c_k
        $$
    \end{proof}
    \begin{property}[Неравенства Коши для коэффициентов ряда Лорана]
        \label{Неравенства Коши для коэффициентов ряда Лорана}
        Пусть $0\leqslant r<R\leqslant+\infty$,
        $$
        f(z)=\sum\limits_{k=-\infty}^\infty c_k(z-z_0)^k\qquad r<|z-z_0|<R
        $$
        Тогда
        $$
        \forall k\in\mathbb Z~\forall\rho\in(r;R)~|c_k|\leqslant\frac{M_f(\rho)}{\rho^k}
        $$
        Где
        $$
        M_f=\max\limits_{|z-z_0|=\rho}|f(z)|
        $$
    \end{property}
    \begin{proof}
        Оценка интеграла как для степенного ряда.
    \end{proof}
    \begin{theorem}[Теорема Лорана о разложении голоморфной функции в ряд Лорана]
        \label{Теорема Лорана}
        Пусть $z_0\in\mathbb C$, $0\leqslant r<R\leqslant+\infty$. $f\in\scriptA(K_{r,R}(z_0))$. Тогда $f$ раскладывается в ряд Лорана в $K_{r,R}(z_0)$.
    \end{theorem}
    \begin{proof}
        Пусть $z\in K_{r,R}(z_0)$, пусть $r_1,R_1$~--- такие числа, что
        $$
        r<r_1<|z-z_0|<R_1<R
        $$
        Тогда $\overline K_{r_1,R_1}(z_0)\subset K_{r,R}(z_0)$. По интегральной формуле Коши.
        $$
        f(z)=\frac1{2\pi\im}\int_{\partial K_{r_1,R_1}(z_0)}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta
        $$
        Граница кольца состоит из двух окружностей:
        $$
        f(z)=\frac1{2\pi\im}\int_{\gamma_{R_1}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta-\frac1{2\pi\im}\int_{\gamma_{r_1}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta
        $$
        Сейчас мы увидим, что первое нам даст правильную часть, а второе~--- главную. Ну, пусть $\zeta\in\gamma_{R_1}$. Тогда
        $$\left|\frac{z-z_0}{\zeta-z_0}\right|=\frac{|z-z_0|}{R_1}<1$$
        $$
        \frac1{\zeta-z}=\frac1{\zeta-z_0-(z-z_0)}=\frac1{\zeta-z_0}\frac1{1-\frac{z-z_0}{\zeta-z_0}}=\frac1{\zeta-z_0}\sum\limits_{k=0}^\infty\frac{(z-z_0)^k}{(\zeta-z_0)^k}
        $$
        По признаку Вейерштрасса выше ряд равномерно сходится относительно $\zeta$ на $\gamma^*_{R_1}$, а $\frac{f(\zeta)}{\zeta-z_0}$ ограничена. Тогда один из интегралов равен ровно тому,ч то мы хотели.\\
        Теперь посмотрим на
        $$
        -\frac1{2\pi\im}\int_{\gamma_{r_1}}\frac{f(\zeta)}{\zeta-z}~\mathrm d\zeta
        $$
        Тут
        $$
        \left|\frac{\zeta-z_0}{z-z_0}\right|=\frac{r_1}{z-z_0}<1
        $$
        $$
        \frac{-1}{\zeta-z}=\frac1{\zeta-z_0-(z-z_0)}=\frac1{z-z_0}\frac1{1-\frac{\zeta-z_0}{z-z_0}}=\sum\limits_{k=0}^\infty\frac{(\zeta-z_0)^k}{(z-z_0)^{k+1}}=\sum\limits_{k=-\infty}^{-1}\frac{(z-z_0)^k}{(\zeta-z_0)^{k+1}}
        $$
        И опять получаем то, что хотели, по равномерной сходимости.
    \end{proof}
    \begin{definition}
        Если $f\in\scriptA(\dot V_{z_0})$, то $z_0$ называется \textbf{особой точкой} (или \textbf{изолированной особой точкой однозначного характера}) $f$.\\
        При этом, если $\exists\lim\limits_{z\to z_0}f(z)\in\mathbb C$, то $z_0$ называется \textbf{устранимой особой точкой} $f$, если $\exists\lim\limits_{z\to z_0}f(z)=\infty$, то $z_0$ называется \textbf{полюсом} $f$, а если $\nexists\lim\limits_{z\to z_0}f(z)$, то $z_0$ называется \textbf{существенной особой точкой} $f$.
    \end{definition}
    \begin{theorem}[Характеристика устранимых особых точек]
        Пусть $z_0\in\mathbb C$, $f\in\scriptA(\dot V_{z_0})$. Тогда следующие утверждения равносильны:
        \begin{enumerate}
            \item $z_0$~--- устранимая особая точка $f$.
            \item $f$ ограничена в некоторой проколотой окрестности $z_0$ ($U_{z_0}$).
            \item $f$ аналитически продолжимо в $V_{z_0}$ (т.е. $\exists g\in\scriptA(V_{z_0})~\forall z\in\dot V_{z_0}~f(z)=g(z)$).
            \item В главной части ряда Лорана $f$ все коэффициенты равны нулю.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item[$4\to3$] Очевидно (запишем разложение $f$ в ряд Лорана, и там будет сумма начинаться с нуля, получится сумма степенного ряда, это и будет $g$).
            \item[$3\to1$] Очевидно ($\lim\limits_{z\to z_0}f(z)=\lim\limits_{z\to z_0}g(z)=g(z_0)$).
            \item[$1\to2$] Очевидно (если функция имеет в точке конечный предел, она ограничена в проколотой окрестности этой точки).
            \item[$2\to4$] Пусть $U_{z_0}=B(z_0;r)$. Тогда
            $$
            \exists M>0~\forall z\in\dot U_{z_0}~|f(z)|\leqslant M
            $$
            Воспользуемся неравенствами Коши:
            $$
            \forall\rho\in(0;r)~\forall k\in\mathbb Z~|c_k|\leqslant\frac{M_f(\rho)}{\rho^k}\leqslant\frac M{\rho^k}
            $$
            Устремим $\rho$ к $0+$. При $-k\in\mathbb N$ правая часть стремится к нулю.
        \end{itemize}
    \end{proof}
    \begin{remark}
        Далее можно не считать устранимые особые точки особыми, вместо этого будем их устранять , получая голоморфные функции.
    \end{remark}
    \begin{theorem}[Характеристика полюсов]
        \label{Характеристика полюсов}
        Пусть $z_0\in\mathbb C$, $f\in\scriptA(\dot V_{z_0})$. Тогда следующие утверждения равносильны:
        \begin{enumerate}
            \item $z_0$~--- полюс $f$.
            \item $\exists m\in\mathbb N~\exists\varphi\in\scriptA(V_{z_0})~\varphi(z_0)\neq0\land \forall z\in\dot V_{z_0}~f(z)=\frac{\varphi(z)}{(z-z_0)^m}$.
            \item В главной части ряда Лорана $f$ отлично от нуля натуральное число коэффициентов.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item[$1\to2$] раз предел бесконечен, в некоторой $\dot U_{z_0}~\forall z\in\dot U_{z_0}~|f(z)|>1$. Рассмотрим $g=\frac1f$. Тогда $z_0$~--- устранимая особая точка $g$ (предел равен нулю). Доопределим её там нулём. $g$ в $z_0$ имеет изолированный ноль. По \hyperref[Изолированность нулей голоморфной функции]{теореме об изолированности нулей голоморфной функции} существуют такие $m\in\mathbb N$ и $\psi\in\scriptA(U_{z_0})~\psi(z_0)\neq0$, что $g(z)=(z-z_0)^m\psi(z)$. Обозначим $\varphi(z)=\frac1{\psi(z)}$. Получим $\varphi(z)$, но на окрестности $U_{z_0}$, а хочется $V_{z_0}$. Ну, в $V_{z_0}\setminus U_{z_0}$ положим $\varphi(z)=(z-z_0)^mf(z)$.
            \item[$2\to3$] Разложим $\varphi$ в ряд Тейлора:
            $$
            \varphi(z)=\sum\limits_{\nu=0}^\infty d_\nu(z-z_0)^\nu
            $$
            Тогда
            $$
            f(z)=\sum\limits_{k=-m}^\infty d_{m+k}(z-z_0)^k
            $$
            \item[$3\to1$] Запишем разложение $f$ в ряд Лорана:
            $$
            f(z)=\sum\limits_{k=-m}^\infty c_k(z-z_0)^k
            $$
            Где $c_{-m}\neq0$. Тогда
            $$
            f(z)=\frac1{(z-z_0)^m}\sum\limits_{k=-m}^\infty c_k(z-z_0)^{k+m}=\frac1{(z-z_0)^m}\sum\limits_{\nu=0}^\infty c_{\nu-m}(z-z_0)^{\nu}
            $$
            Мы имеем произведение двух штук, первая стремится к $\infty$, вторая~--- к $c_{-m}\neq0$.
        \end{itemize}
    \end{proof}
    \begin{definition}
        Число $m$ из теоремы \ref{Характеристика полюсов} называется \textbf{характеристикой полюса}.
    \end{definition}
    \begin{remark}
        $m$ является одновременно кратностью нуля $\frac1f$ (доопределённого в $z_0$), числом $m$ из утверждения 2 и $-\min\{k\in\mathbb Z\mid c_k\neq0\}$.
    \end{remark}
    \begin{definition}
        Функция $f$ называется \textbf{мероморфной} в области $D$, если она не имеет в $D$ особенностей, кроме полюсов (то есть она голоморфна в множестве $D$ без её полюсов).
    \end{definition}
    \begin{example}
        Простейшие примеры~--- рациональные дроби (частное двух многочленов), $\tan$, $\cot$, а вот что не мероморфно в $\mathbb C$~--- это $\frac1{\sin\frac\pi z}$. У неё в нуле не полюс, а кринж какой-то.
    \end{example}
    \begin{property}
        Если $f$ и $g$ мероморфны в $D$, то $f+g$, $f-g$, $fg$, $\frac fg$ (если $g\not\equiv0$) и $f'$ также мероморфны в $D$.\\
        Доказательство остаётся читателю как несложное упражнение.
    \end{property}
    \begin{claim}
        Частное двух голоморфных функций мероморфно, но, что более интересно (и не является несложным упражнением), верно и обратное: любая мероморфная функция представима как частное двух голоморфных.
    \end{claim}
    \begin{corollary}
        $z_0$ является существенно особой точкой $f$ тогда и только тогда, когда в главной части $f$ есть бесконечное число ненулевых слагаемых.
    \end{corollary}
    \begin{theorem}[Теорема Сахотского]
        Пусть $z_0\in\mathbb C$, $f\in\scriptA(\dot V_{z_0})$, $z_0$~--- существенно особая точка $f$. Тогда
        $$
        \forall A\in\overline{\mathbb C}~\exists\{z_n\}_{n=1}^\infty\subset\dot V_{z_0}~z_n\to z_0\land f(z_n)\to A
        $$
    \end{theorem}
    \begin{remark}
        То есть для особой точки либо есть предел (конечный или бесконечный), либо частичные пределы могут давать всё $\overline{\mathbb C}$.
    \end{remark}
    \begin{proof}
        Для начала $A=\infty$. $f$ не ограничена ни в какой окрестности $U_{z_0}$ (иначе устранимая особая точка), а значит
        $$
        \forall n\in\mathbb N~\exists z_n~0<|z_n-z_0|<\frac1n\land|f(z_n)|>n
        $$
        Теперь пусть $A\in\mathbb C$. Рассмотрим $E$~--- множество $A$-точек $f$~--- и зададимся вопросом: $z_0$~--- предельная точка $E$ или нет? Если да, можно построить искомую последовательность по определению. Если нет, то возьмём $g=\frac1{f-A}\in\scriptA(\dot U_{z_0})$. $z_0$~--- особая точка $g$. Какого типа? Ну, объективно, существенно особая, иначе был бы предел и $\lim f$ можно было бы выразить через $\lim g$. А тогда применим тот фрагмент доказательства, где $A=\infty$:
        $$
        \exists\{z_n\}_{n=1}^\infty\subset\dot U_{z_0}~z_n\to z_0\land g(z_n)\to\infty
        $$
        А последнее просто равносильно тому, что $f(z_n)\to A$.
    \end{proof}
    \begin{theorem}[Теорема Пикара]
        Пусть $V_{z_0}=B(z_0;r)$, $f\in\scriptA(\dot V_{z_0})$, $z_0$~--- существенно особая точка $f$. Тогда
        $$
        \forall\delta\in(0;r)~f(\dot B(z_0;\delta))=\mathbb C\text{ или }\mathbb C\text{ без одной точки}
        $$
        Без доказательства.
    \end{theorem}
    \begin{definition}
        Пусть $f\in\scriptA(\dot V_{z_0})$, тем самым раскладываясь в ряд Лорана на $\dot V_{z_0}$. \textbf{Вычетом} $f$ в точке $z_0$ называется $c_{-1}$. Он обозначается $\operatorname*{res}_{z_0}f$ или $\operatorname*{res}_{z=z_0}f(z)$.
    \end{definition}
    \begin{remark}
        Вычет $f$ в $z_0$ равен
        $$
        \frac1{2\pi\im}\int_{\gamma_{\rho,z_0}}f(\zeta)~\mathrm d\zeta\qquad \dot V_{z_0}=\dot B(z_0;R),\rho\in(0;R)
        $$
    \end{remark}
    \begin{theorem}[Теорема Коши о вычетах]
        \label{Теорема Коши о вычетах}
        Пусть $f\in\scriptA(D\setminus E)$, где $E$~---множество изолированных особых точек $f$. Пусть $G$~--- ограниченная область с ориентированной границей, $\overline G\subset D$, $\partial G\cap E=\varnothing$. Тогда
        $$
        \int_{\partial G}f=2\pi\im\sum\limits_{z_k\in E\cap G}\operatorname*{res}_{z_k}f
        $$
    \end{theorem}
    \begin{proof}
        Для начала докажем, что $E\cap G$ конечно. Ну, пусть это не так. $\overline G$~--- компакт, а значит $\exists\{z_n\}_{n=1}^\infty\subset E\cap G~z_n\neq z^*\land z_n\to z^*\in\overline G$. Да это же неизолированная особая точка $f$ в $D$!\\
        Хорошо, пусть $E\cap G=\{z_1,\ldots,z_N\}$. Существует такое $r>0$, что $\overline B(z_k,r)$ лежат в $G$ и дизъюнктны. Пусть $\rho\in(0;r]$. Пусть $G_\rho=G\setminus\bigsqcup\limits_{k=1}^N\overline B(z_k;\rho)$. Поскольку $\overline G_\rho\subset G\setminus E$, $f\in\scriptA(\overline G_\rho)$, а значит по интегральной теореме Коши
        $$
        0=\int_{\partial G_\rho}f=\int_{\partial G}f-\sum\limits_{k=1}^N\int_{\gamma_{\rho,z_k}}f=\int_{\partial G}f-2\pi\im\sum\limits_{k=1}^N\operatorname*{res}_{z_k}f
        $$
    \end{proof}
    \begin{remark}
        Правила вычисления вычетов:
        \begin{enumerate}
            \item В устранимой особой точке вычет равен нулю.
            \item Для существенно особой точки рецепта не будет.
            \item В полюсе кратности 1 (ещё говорят, простом полюсе) пишем
            $$
            f(z)=c_{-1}(z-z_0)^{-1}+\sum\limits_{k=0}^\infty c_k(z-z_0)^k
            $$
            И тут всё очень просто: умножим $f$ на $z-z_0$ и перейдём к пределу $z\to z_0$.\\
            Есть ещё вариация этой формулы. Пусть $f=\frac PQ$, $P(z_0)\neq0$, $Q(z_0)=0$, $Q'(z_0)\neq0$. Тогда
            $$
            \lim\limits_{z\to z_0}(z-z_0)f(z)=\lim\limits_{z\to z_0}P(z)\frac{z-z_0}{Q(z)-Q(z_0)}=\frac{P(z_0)}{Q'(z_0)}
            $$
            \item А что делать в полюсах большей кратности? Ну,
            $$
            f(z)=c_{-m}(z-z_0)^{-m}+\cdots+c_{-1}(z-z_0)^{-1}+\sum\limits_{k=0}^\infty c_k(z-z_0)^k
            $$
            Ну, тут что, возьмём $(z-z_0)^mf(z)\in\scriptA(V_{z_0})$, после чего это надо дифференцировать $m-1$ раз:
            $$
            \operatorname*{res}_{z_0}f=\frac1{(m-1)!}\left((z-z_0)^mf(z)\right)^{(m-1)}\bigg|_{z=z_0}
            $$
        \end{enumerate}
    \end{remark}
    \begin{example}
        Пример формулы с $f=\frac PQ$~--- котангенс, у него во всех полюсах вычет равен единице.
    \end{example}
    \begin{example}
        $$
        \int\limits_{-\infty}^\infty\frac{\mathrm dx}{(x^2+1)^{n+1}}
        $$
        Пусть $f(z)=\frac1{(z^2+1)^{n+1}}$. Посчитать интеграл можно двумя способами. С одной стороны, это предел $\int\limits_{-R}^R\frac{\mathrm dz}{(z^2+1)^{n+1}}$ при $R\to\infty$. С другой, рассмотрим верхнюю полуокружность радиуса $R>1$ с центром в нуле и посчитаем интеграл по ней.
        $$
        \int_{C_R}\frac{\mathrm dz}{(z^2+1)^{n+1}}
        $$
        Где $C_R$~--- полуокружность.
        Этот интеграл можно оценить:
        $$
        \left|\int_{C_R}\frac{\mathrm dz}{(z^2+1)^{n+1}}\right|\leqslant\frac{\pi R}{(R^2-1)^{n+1}}
        $$
        Это чудо стремится к нулю.\\
        При этом если соединить полуокружность и отрезок $[-R;R]$, получится контур, в котором есть один полюс ($\im$) и можно воспользоваться вычетом для подсчёта интеграла по нему:
        \[\begin{split}
            2\pi\im\operatorname*{res}_{z=i}\frac1{(z^2+1)^{n+1}}&=2\pi\im\frac1{n!}\left(\frac1{(z+\im)^{n+1}}\right)^{(n)}\bigg|_{z=\im}=2\pi\im\frac{(-1)^n}{n!}\frac{(n+1)\cdot\cdots\cdot 2n}{(z+\im)^{2n+1}}\bigg|_{z=\im}=\\
            &=2\pi\frac{(2n)!}{(n!)^22^{2n+1}}=\pi\frac{(2n)!}{((2n)!!)^2}=\pi\frac{(2n-1)!!}{(2n)!!}
        \end{split}\]
        Отсюда $I=\pi\frac{(2n-1)!!}{(2n)!!}$.
    \end{example}
    \begin{remark}
        Таким же способом можно посчитать интегралы дробно-рациональных функций (отношение многочленов), если они не имеют полюсов на вещественной прямой и степень числителя меньше степени знаменателя хотя бы на два. Ответом будет следующее:
        $$
        \int\limits_{-\infty}^\infty\frac PQ=2\pi\im\sum\limits_{\substack{Q(z_k)=0\\\Im z_k>0}}\operatorname*{res}_{z_k}\frac PQ
        $$
    \end{remark}
    \begin{lemma}[Лемма Жордана]
        \label{Лемма Жордана}
        Пусть $\Delta>0$, $f\in C\left\{z\in\mathbb C~\middle|~\Im z\geqslant0,|z|\geqslant\Delta\right\}$. Пусть $\lambda>0$. Пусть $C_R(t)=Re^{\im t}\mid t\in[0;\pi]$, $f(z)\underset{z\to\infty}\rightarrow0$. Тогда
        $$
        \int_{C_R}f(z)e^{\im\lambda z}~\mathrm dz\underset{z\to\infty}\longrightarrow0
        $$
    \end{lemma}
    \begin{remark}
        Лемма тривиальна при $f=o\left(\frac1z\right)$. Пусть $z=x+\im y$, тогда
        $$
        |e^{\im\lambda z}|=|e^{\im\lambda x}e^{-\lambda y}|<1
        $$
        А значит
        $$
        \left|\int_{C_R}f(z)e^{\im\lambda z}~\mathrm dz\right|<\pi R\max\limits_{\substack{|z|=R\\\Im z\geqslant 0}}|f(z)|=\pi Ro\left(\frac1R\right)\underset{R\to+\infty}\longrightarrow0
        $$
    \end{remark}
    \begin{proof}
        Пусть
        $$M(R)=\max\limits_{\substack{|z|=R\\\Im z\geqslant 0}}|f(z)|$$
        По условию $M(R)$ стремится к нулю при $R\to+\infty$. Теперь оценим интеграл
        $$
        \left|\int_{C_R}f(z)e^{\im\lambda z}~\mathrm dz\right|=\left|\int\limits_0^\pi f(Re^{\im t})Re^{\im\lambda}e^{\im\lambda(\cos t+\im\sin t)}~\mathrm dz\right|\leqslant M(R)R\int\limits_0^\pi e^{-\lambda R\sin t}~\mathrm dt=2M(R)R\int\limits_0^{\pi/2}e^{-\lambda R\sin t}~\mathrm dt
        $$
        Поскольку $\sin t\geqslant\frac2\pi t$,
        $$
        2M(R)R\int\limits_0^{\pi/2}e^{-\lambda R\sin t}~\mathrm dt\leqslant 2M(R)R\int\limits_0^{+\infty}e^{\frac{\lambda R2}\pi r}~\mathrm dt=\frac{2M(R)R\pi}{\lambda R2}=\frac{\pi M(R)}\lambda
        $$
        Что стремится у нулю.
    \end{proof}
    \begin{example}
        $$
        \int\limits_0^{+\infty}\frac{\cos\lambda x}{1+x^2}~\mathrm dx
        $$
        Обозначим это за $I$. При $\lambda=0$ мы знаем $I=\frac\pi2$. А ещё этот интеграл чётен по $\lambda$, а значит можно рассматривать только $\lambda>0$.\\
        Рассмотрим тот же контур $\Gamma_R$, который сначала идёт из $R+0\im$ в $-R+0\im$ по полуокружности, а потом по отрезку возвращается.\\
        Пусть $f(z)=\frac{e^{\im\lambda z}}{1+z^2}$. Тогда
        $$
        \int\limits_{-R}^R\frac{e^{\im\lambda z}}{1+z^2}~\mathrm dz=\int\limits_{-R}^R\frac{\cos\lambda z}{1+z^2}~\mathrm dz\rightarrow2I
        $$
        $$
        \int_{C_R}\frac{e^{\im\lambda z}}{1+z^2}~\mathrm dz\longrightarrow0
        $$
        А теперь посчитаем интеграл по $\Gamma_R$:
        $$
        \int_{\Gamma_R}\frac{e^{\im\lambda z}}{1+z^2}~\mathrm dz=2\pi\im\operatorname*{res}_{z=i}\frac{e^{\im\lambda z}}{1+z^2}=2\pi\im\frac{e^{-\lambda}}{2\im}=\pi e^{-\lambda}
        $$
        Итого
        $$
        \int\limits_0^{+\infty}\frac{\cos\lambda x}{1+x^2}~\mathrm dx=\frac\pi2 e^{-|\lambda|}
        $$
    \end{example}
    \begin{remark}
        Аналогично считается интеграл
        $$
        \int\limits_0^{+\infty}\frac{x\sin\lambda x}{1+x^2}~\mathrm dx=\frac\pi2(\sign\lambda)e^{-|\lambda|}
        $$
    \end{remark}
    \begin{definition}
        Интегралы
        $$
        \int\limits_0^{+\infty}\frac{\cos\lambda x}{1+x^2}~\mathrm dx\qquad\qquad\int\limits_0^{+\infty}\frac{x\sin\lambda x}{1+x^2}~\mathrm dx
        $$
        называются \textbf{интегралами Лапласа}.
    \end{definition}
    \begin{remark}
        Этим же способом обслуживаются интегралы
        $$
        \int\limits_{-\infty}^{+\infty}\frac{P(x)}{Q(x)}e^{\im\lambda x}~\mathrm dx
        $$
        Где $\frac PQ$~--- правильная рациональная дробь без полюсов на $\mathbb R$, $\lambda>0$.
        $$
        \int\limits_{-\infty}^{+\infty}\frac{P(x)}{Q(x)}e^{\im\lambda x}~\mathrm dx=2\pi\im\sum\limits_{\substack{Q(z_k)=0\\\im z_k>0}}\operatorname*{res}_{z=z_k}\frac{P(z)}{Q(z)}e^{\im\lambda z}
        $$
    \end{remark}
    \begin{example}
        $$
        \int\limits_0^{+\infty}\frac{\sin x}x~\mathrm dx
        $$
        Обозначим интеграл за $I$. Пусть
        $$
        f(z)=e^{\im z}2
        $$
        Но при замене синуса на экспоненту получим особенность в нуле, и её надо обойти:
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 10cm,
                    height = 5cm,
                    grid = none,
                    xmin = 0,
                    xmax = 3,
                    ymin = -3,
                    ymax = 3,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    xtick = \empty,
                    ytick = \empty,
                    xlabel = \empty,
                    ylabel = \empty,
                    ]
                    \addplot[domain=-.5:.5,samples=20,red,thick]{sqrt(.25-x^2)};
                    \addplot[domain=-3:3,samples=100,red,thick]{sqrt(9-x^2)};
                    \addplot[domain=-3:-.5,samples=100,red,thick]{0};
                    \addplot[domain=.5:3,samples=2,red,thick]{0};
                \end{axis}
            \end{tikzpicture}
        \end{figure}\noindent
        Пусть радиус большой полуокружности~--- $R$, малой~--- $r$, $0<r<R$.
        $$
        \left(\int\limits_{-R}^{-r}+\int\limits_r^R\right)\frac{e^{\im z}}z~\mathrm dz=\left(\int\limits_{-R}^{-r}+\int\limits_r^R\right)\frac{\im\sin z}z~\mathrm dz\longrightarrow2\im I
        $$
        $$
        \int_{C_R}\frac{e^{\im z}}z~\mathrm dz\rightarrow 0
        $$
        по \hyperref[Лемма Жордана]{лемме Жордана}.
        $$
        \int_{\Gamma}\frac{e^{\im z}}z~\mathrm dz=0
        $$
        По \hyperref[Интегральная теорема Коши]{интегральной теореме Коши} или \hyperref[Теорема Коши о вычетах]{теореме Коши о вычетах}.
        $$
        \int_{C_r^-}\frac{e^{\im z}}z~\mathrm dz=\int_{C_r^-}\frac{e^{\im z}-1}z~\mathrm dz+\int_{C_r^-}\frac{\mathrm dz}z
        $$
        Второе слагаемое:
        $$
        \int_{C_r^-}\frac{\mathrm dz}z=-\int\limits_0^\pi\frac{r\im e^{\im t}}{re^{\im t}}~\mathrm dt=-\pi\im
        $$
        В первом функция $z\mapsto\frac{e^{\im z}-1}z$ голоморфна на $\mathbb C$, а значит ограничена в окрестности нуля. А значит
        $$
        \exists M>0~\forall z:|z|\leqslant 1~\left|\frac{e^{\im z}-1}z\right|\leqslant M
        $$
        А тогда
        $$
        \left|\int_{C_r^-}\frac{e^{\im z}-1}z\right|\leqslant M\pi r\rightarrow 0
        $$
        Отсюда
        $$
        \int\limits_0^{+\infty}\frac{\sin x}x~\mathrm dx=\frac\pi2
        $$
    \end{example}
    \begin{remark}
        Напоминание:
        $$
        \operatorname{Si}x=\int\limits_0^x\frac{\sin t}t~\mathrm dt
        $$
        называется \textbf{интегральным синусом}. Сейчас мы узнали, что
        $$
        \operatorname{Si}x\underset{x\to+\infty}\longrightarrow\frac\pi2
        $$
    \end{remark}
    \begin{example}
        $$
        \int\limits_0^{+\infty}\frac{\sin^2x}{x^2}~\mathrm dx=\int\limits_0^{+\infty}\sin^2x\mathrm d\left(-\frac1x\right)=\int\limits_0^{+\infty}\frac{2\sin x\cos x}x~\mathrm dx=\int\limits_0^{+\infty}\frac{\sin 2x}x~\mathrm dx\underset{2x=t}=\int\limits_0^{+\infty}\frac{\sin t}t~\mathrm dt=\frac\pi2
        $$
    \end{example}
    \begin{definition}
        $\infty$ является \textbf{особой точкой} $f$, если $f\in\scriptA(\dot V_\infty)$, где
        $$
        \dot V_\infty=\{z\in\mathbb C\mid |z|>R\}
        $$
        Классификация особых точек сохраняется.
    \end{definition}
    \begin{definition}
        В случае бесконечно удалённой точки в разложении в ряд Лорана
        $$
        f(z)=\sum\limits_{k=-\infty}^\infty c_kz^k\qquad |z|>R
        $$
        можно провести замену $z=\frac1w$,
        $$
        g(w)=f\left(\frac1w\right)=\sum\limits_{k=-\infty}^\infty c_{-k}w^k\qquad0<|w|<\frac1R
        $$
        Тогда \textbf{главной частью ряда Лорана для бесконечно удалённой точки} называется главная часть ряда для $g$:
        $$
        \sum\limits_{k=1}^\infty c_kz^k
        $$
        А \textbf{основной частью}~--- основная часть:
        $$
        \sum\limits_{k=-\infty}^0 c_kz^k
        $$
        \textbf{Вычетом} на $\infty$ называется $-c_{-1}$.
    \end{definition}
    \begin{remark}
        Почему? Потому что
        $$
        \operatorname*{res}_\infty f=\frac1{2\pi\im}\int_{\gamma_\rho^-}f(z)~\mathrm dz
        $$
        Короче, из-за того, что мы должны в другом направлении обходить окружность, чтобы \textit{внешняя часть} оставалась слева.
    \end{remark}
    \begin{remark}
        Из того, что $\infty$~--- устранимая особая точка $f$ не следует, что $\operatorname*{res}_\infty f=0$, простой пример: $f(z)=\frac1z$.
    \end{remark}
    \begin{theorem}[О полной сумме вычетов]
        Пусть $f\in\scriptA(\mathbb C\setminus E)$, $E\cup\{\infty\}$~--- множество изолированных особых точек $f$. Тогда
        $$
        \sum\limits_{z_k\in E\cup\{\infty\}}\operatorname*{res}_{z_k}f=0
        $$
    \end{theorem}
    \begin{proof}
        Возьмём круг настолько большого радиуса $R$, что в его внешности и на границе нет особых точек (кроме $\infty$). По теореме Коши о вычетах
        $$
        \int_{\gamma_R}f=2\pi\im\sum\limits_{z_k\in E}\operatorname*{res}_{z_k}f
        $$
        По определению вычета на бесконечности
        $$
        \int_{\gamma_R}f=-2\pi\im\operatorname*{res}_\infty f
        $$
    \end{proof}
    \section{Мера и интеграл.}
    \paragraph{Мера в абстрактных множествах.}
    \begin{remark}
        Напоминание: $2^X$~--- множество всех подмножеств $X$.
    \end{remark}
    \begin{remark}
        В этом разделе периодически будут встречаться словосочетания вида <<система множеств>> или <<семейство множество>> и все они будут значит не более, чем <<множество множеств>>, просто так говорить неудобно.
    \end{remark}
    \begin{definition}
        Семейство $\mathbb P$ подмножеств множества $X$ (которое в данном разделе называется \textbf{пространством}) называется \textbf{полукольцом}, если выполнены \textbf{аксиомы полукольца}.
        \begin{enumerate}
            \item $\varnothing\in\mathbb P$.
            \item Если $A,B\in\mathbb P$, то $A\cap B\in\mathbb P$.
            \item Если $A,B\in\mathbb P$ и $B\subset A$, то $A\setminus B$ представляется в виде конечного количества дизъюнктных множеств из полукольца:
            $$
            A\setminus B=\bigsqcup\limits_{k=1}^NC_k\mid C_k\in\mathbb P
            $$
        \end{enumerate}
    \end{definition}
    \begin{remark}
        Здесь и далее в обозначениях $\{A_k\}_k$, $\bigcup\limits_kA_k$, $\sum\limits_kA_k$ имеется ввиду конечное или счётное семейство (во втором и третьем обозначениях его объединение и сумма).
    \end{remark}
    \begin{example}
        Например, $\{\varnothing\}$ или $2^X$ являются отличными полукольцами.
    \end{example}
    \begin{example}
        Множество ограниченных множеств в метрическом пространстве является полукольцом.
    \end{example}
    \begin{example}
        Множество промежутков в $\mathbb R$ также является полукольцом.
    \end{example}
    \begin{property}
        \label{prop:1 полукольца}
        Если $A,A_1,\ldots,A_n\in\mathbb P$, то $A\setminus\bigcup\limits_{k=1}^nA_k=\bigsqcup\limits_{i=1}^N C_i\mid C_i\in\mathbb P$
    \end{property}
    \begin{proof}
        Индукция по $n$. База: $n=1$. Пусть $B=A\cup A_i\in\mathbb P$. Тогда по аксиоме 3 $A\setminus B$ представимо в требуемом виде.\\
        Переход: $n\mapsto n+1$.
        $$
        A\setminus\bigcup_{k=1}^{n+1}A_k=\left(A\setminus\bigcup_{k=1}^nA_k\right)\setminus A_{n+1}\overset{\text{и.п.}}=\left(\bigsqcup\limits_{i=1}^N C_i\right)\setminus A_{n+1}=\bigsqcup\limits_{i=1}^N(C_i\setminus A_{n+1})\overset{\text{база}}=\bigcup\limits_{i=1}^N\bigcup\limits_{j=1}^{M_i}D_{ij}
        $$
        При этом все $D_{ij}$ также дизъюнктны ($D_{i_1j}$ и $D_{i_2j}$ непересекаются по сохранению этого свойства для $C_{i_1}$ и $C_{i_2}$, а если отличается второй индекс, то изначально в базе индукции мы раскладывали на диъюнктные множества).
    \end{proof}
    \begin{property}
        \label{prop:2 полукольца}
        Если $\{A_k\}_k$ не более чем счётно, $A_k\in\mathbb P$, то $$\bigcup\limits_kA_k=\bigcup\limits_k\bigcup\limits_{i=1}^{N_k}C_{ki}$$
        Где $C_{ki}$ все дизъюнктны и лежат в $\mathbb P$ и $C_{ki}\subset A_k$.
    \end{property}
    \begin{proof}
        $A_k$ сами не обязаны быть дизъюнктными, поэтому сначала добьёмся их дизъюнктности:
        $$
        B_k=A_k\setminus\bigcup\limits_{j=1}^{n-1}A_j
        $$
        $B_k$ уже необязательно лежат в $\mathbb P$, но
        $$\bigcup\limits_k A_k=\bigsqcup\limits_k B_k\overset{\text{1}}=\bigcup\limits_k\bigcup\limits_{i=1}^{N_k} C_{ki}$$
        И вот $C_{ki}$ уже $\in\mathbb P$ и дизъюнктны.
    \end{proof}
    \begin{definition}
        Непустое семейство $\mathbb A$ подмножеств $X$ (которое тут также называется \textbf{пространством}) называется \textbf{$\sigma$-алгеброй}, если выполнены аксиомы $\sigma$-алгебры:
        \begin{enumerate}
            \item Если $A\in\mathbb A$, то $A\compl\in\mathbb A$.
            \item Если $\{A_k\}_{k=1}^\infty$~--- такое семейство, что $A_k\in\mathbb A$, то $\bigcup\limits_{k=1}^\infty A_k\in\mathbb A$.
        \end{enumerate}
    \end{definition}
    \begin{example}
        Простейший пример: $\{\varnothing,X\}$. Ещё один простой пример: $2^X$. И ещё: семейство не более чем счётных подмножеств $X$ и их дополнений.
    \end{example}
    \begin{remark}
        Если есть полукольцо, то должно быть и кольцо. И если есть $\sigma$-алгебра, то должна быть и просто алгебра. И такие структуры и правда есть, но мы рассмотрим только алгебру.\\
        $\sigma$~--- это про счётность. Просто алгебра должна быть не про счётной.
    \end{remark}
    \begin{definition}
        Если $\mathbb A$~--- такое семейство подмножеств $X$, что для него выполнена первая аксиома $\sigma$-алгебры, а вторая аксиома верна только для конечных семейств (неизвестно, выполнена ли для счётных), то $\mathbb A$ называется \textbf{алгеброй}.
    \end{definition}
    \begin{example}
        Существует алгебра, не являющаяся $\sigma$-алгеброй. Например, семейство ограниченных в $\mathbb R$ множеств. Объединение конечного количества ограниченных множеств ограничено, но
        $$
        \bigcup\limits_{k=0}^\infty [k;k+1)=\mathbb R_+
        $$
    \end{example}
    \begin{property}
        Пусть $\mathbb A$~--- алгебра над $X$. Тогда
        $$
        \forall\{A_k\}_{k=1}^n\subset\mathbb A~\bigcap\limits_{k=1}^nA_k\in\mathbb A
        $$
        Для $\sigma$-алгебр это верно и для счётных семейств
    \end{property}
    \begin{proof}
        $$
        \bigcap\limits_{k=1}^nA_k=\left(\bigcap\limits_{k=1}^nA_k\compl\right)\compl
        $$
        Дальше сами
    \end{proof}
    \begin{property}
        Если $A,B\in\mathbb A$, то $A\setminus B\in\mathbb A$.
    \end{property}
    \begin{proof}
        Тривиально из первого.
    \end{proof}
    \begin{property}
        Всякая алгебра является полукольцом.
    \end{property}
    \begin{proof}
        Аксиомы 2 и 3 мы проверили выше, аксиома 1. Поскольку $\mathbb A$ непусто, в нём есть $A$. А значит есть и $A\compl$. Тогда $A\cap A\compl\in\mathbb A$.
    \end{proof}
    \begin{claim}
        Пусть $X$~--- пространство, $T\neq\varnothing$, $\{\mathbb A_t\}_{t\in T}$~--- семейство $\sigma$-алгебр над $X$. Тогда
        $$
        \mathbb A=\bigcap_{t\in T}\mathbb A_t
        $$
        также является $\sigma$-алгеброй.
    \end{claim}
    \begin{proof}
        Выше мы уже узнали, что $\varnothing\in\mathbb A_t$, а значит $\mathbb A\neq\varnothing$. Теперь давайте проверять аксиомы:
        $$
        A\in\mathbb A\Leftrightarrow\forall t\in T~A\in A_t\Leftrightarrow\forall t\in T~A\compl\in A_t\Leftrightarrow A\compl\in\mathbb A
        $$
    \end{proof}
    \begin{remark}
        Аналогично со счётным объединением.
    \end{remark}
    \begin{definition}
        Пусть $M$~--- семейство подмножеств $X$. Наименьшая по включению $\sigma$-алгебра, содержащая $M$, называется $\sigma$-алгеброй, \textbf{порождённой} $M$ или \textbf{натянутой на} $M$ или \textbf{борелевской оболочкой} $M$.
    \end{definition}
    \begin{remark}
        Такое существует и равно пересечению всех $\sigma$-алгебр, содержащих $M$.
    \end{remark}
    \begin{definition}
        Пусть $X$~--- топологическое (для вас~--- метрической) пространство, $\sigma$-алгебра, порождённая топологической структурой (множеством всех открытых множеств) на нём называется \textbf{борелевской $\sigma$-алгебра}, а её элементы~--- \textbf{борелевскими множествами}.\\
        $\mathbb B_n$~--- борелевская $\sigma$-алгебра в $\mathbb R^n$.
    \end{definition}
    \begin{property}
        Там есть все открытые множества, все открытые, счётные пересечения всех открытых и счётные объединения всех замкнутых. И ещё какой-то кринж.
    \end{property}
    \begin{definition}
        \textbf{Множеством типа $G_\delta$} называется множество, являющееся счётным пересечением открытых множеств.\\
        \textbf{Множеством типа $F_\sigma$} называется множество, являющееся счётным объединением замкнутых множеств.
    \end{definition}
    \begin{remark}
        Но это не всё, что есть в борелевской $\sigma$-алгебре, потому что ещё же можно счётно объединять $G_\delta$. Получатся множества типа $G_{\delta\sigma}$. И также можно получить $F_{\sigma\delta}$. Так можно сделать сколько угодно раз, но это всё равно не все множества борелевской $\sigma$-алгебры, ведь мы можем объединять и пересекать множества разных <<уровней>>. Короче, много чего интересного есть в борелевской $\sigma$-алгебре.
    \end{remark}
    \begin{claim}
        $$\operatorname{card}\mathbb B_n=\operatorname{card}\mathbb R^n$$
        Без доказательства.
    \end{claim}
    \begin{claim}
        Борелевская $\sigma$-алгебра равна $\sigma$-алгебре, порождённой замкнутыми множествами.
    \end{claim}
    \begin{proof}
        Тривиально.
    \end{proof}
    \begin{definition}
        \textbf{Мерой} называется неотрицательная счётно-аддитивная функция, заданная на полукольце и равная нулю на пустом множестве.\\
        Иначе говоря, $\mu\colon\mathbb P\to[0;+\infty]$ называется мерой, если $\mu\varnothing=0$ и
        $$
        \{A_k\}_{k=1}^\infty:A_k\in\mathbb P,\bigsqcup\limits_{k=1}^\infty A_k\in\mathbb P\Rightarrow\mu A=\sum\limits_{k=1}^\infty\mu A_k
        $$
    \end{definition}
    \begin{definition}
        Если в определении меры заменить счётную аддитивность на конечную, получится функция, котрая называется \textbf{объёмом}.
    \end{definition}
    \begin{claim}
        Если $\mu$ не равна тождественно $+\infty$ и конечно-аддитивна/счётно-аддитивна, то $\mu\varnothing=0$.
    \end{claim}
    \begin{proof}
        Рассмотрим множество $A\mid\mu A\neq+\infty$. Тогда
        $$
        \mu A=\mu(A\sqcup\varnothing)=\mu A+\mu\varnothing\Rightarrow\mu\varnothing=0
        $$
        Это было для конечной аддитивности, вот для счётной:
        $$
        \mu A=\mu\left(A\sqcup\bigsqcup\limits_{k=1}^\infty\varnothing\right)=\mu A+\sum\limits_{k=1}^\infty\mu\varnothing\Rightarrow\mu\varnothing=0
        $$
    \end{proof}
    \begin{claim}
        Счётная аддитивность влечёт конечную.
    \end{claim}
    \begin{proof}
        Добавим к счётному семейству счётное количество пустых множеств. Тогда либо из предыдущего значение суммы $\mu$ не изменится, либо $\mu\equiv+\infty$, и мы суммируем несколько $+\infty$ а обоих случаях.
    \end{proof}
    \begin{example}
        Обратное неверно:\\
        $$
        \mu\colon e^{\mathbb R^n}\to[0;+\infty]
        $$
        $$
        \mu A=\begin{cases}
            0 & A\text{ ограничено}\\
            +\infty & \text{иначе}
        \end{cases}
        $$
    \end{example}
    \begin{remark}
        И дело тут не в том, что мы разрешили значение $+\infty$, просто пока нам лень приводить примеры, где $+\infty$ нет, там надо будет что-то доказывать.
    \end{remark}
    \begin{property}[Сильная монотонность]
        \label{Сильная монотонность меры}
        Пусть $\mu$~--- объём. Пусть $\{A_k\}_k$~--- не более чем счётный набор дизъюнктных множеств полукольца, $A\in P$ и $\bigsqcup\limits_kA_k\subset A$. Тогда
        $$
        \sum\limits_k\mu A_k\leqslant\mu A
        $$
    \end{property}
    \begin{proof}
        Сначала пусть набор конечен. Возьмём разность $A\setminus\bigsqcup\limits_{k=1}^nA_k$. Её по свойству \ref{prop:1 полукольца} полукольца она представима в виде $\bigsqcup\limits_{i=1}^NC_i\mid C_i\in\mathbb P$. Тогда
        $$
        A=\bigsqcup\limits_{k=1}^nA_k\cup\bigsqcup\limits_{i=1}^NC_i
        $$
        Все множества справа непересекаются, а значит $A$ мы представили в виде объединения дизъюнктных множеств полукольца. Отсюда по счётной аддитивности
        $$
        \mu A=\sum\limits_{k=1}^n\mu A_k+\sum\limits_{i=1}^N\mu C_i\geqslant\sum\limits_{k=1}^n\mu A_k
        $$
        Для счётных семейств. Устремим $n$ к бесконечности в неравенстве
        $$
        \mu A=\geqslant\sum\limits_{k=1}^n\mu A_k
        $$
    \end{proof}
    \begin{property}[Конечная полуаддитивность]
        Пусть $\mu$~--- объём. Пусть $\{A_k\}_{k=1}^n\subset\mathbb P$, $A\in\mathbb P$, $A\subset\bigcup\limits_{k=1}^nA_k$, тогда
        $$
        \mu A\leqslant\sum\limits_{k=1}^n\mu A_k
        $$
    \end{property}
    \begin{property}[Счётная полуаддитивность]
        Пусть $\mu$~--- мера. Пусть $\{A_k\}_k\subset\mathbb P$, $A\in\mathbb P$, $A\subset\bigcup\limits_kA_k$, тогда
        $$
        \mu A\leqslant\sum\limits_k\mu A_k
        $$
    \end{property}
    \begin{proof}
        $$
        A=A\cap\bigsqcup_kA_k=\bigsqcup_k\underbrace{A\cap A_k}_{B_k\in\mathbb P}\overset{\ref{prop:2 полукольца}}=\bigcup\limits_k\bigcup\limits_{i=1}^{N_k}C_{ki}
        $$
        Где $C_{kii}$ все дизъюнктны, лежат в $\mathbb P$ и $C_{ki}\subset A_k$.\\
        Тогда
        $$
        \mu A=\sum\limits_k\sum\limits_{i=1}^{N_k}\mu C_{ki}\overset{\ref{Сильная монотонность меры}}\leqslant\sum\limits_k\mu B_k\overset{\ref{Сильная монотонность меры}}\leqslant\sum\limits_k\mu A_k
        $$
    \end{proof}
    \begin{definition}
        Если $X\in\mathbb P$ и $\mu X<+\infty$, то мера $\mu$ называется \textbf{конечной}.\\
        Если $\mu X=1$, мера называется \textbf{вероятностной}.
    \end{definition}
    \begin{definition}
        Если $X$ представляется в виде $\bigcup\limits_{k=1}^\infty X_k$, где $X_k\in\mathbb P$ и $\mu X_k<+\infty$, то $\mu$ называется \textbf{$\sigma$-конечной}.
    \end{definition}
    \begin{example}
        $X=\mathbb R$, $\mathbb P$~--- множество промежутков, $\mu$~--- длина. То, что это мера, докажем позже (и сразу для многомерного случая). А сейчас заметим, что она $\sigma$-конечна:
        $$
        \mathbb R=\bigcup\limits_{k\in\mathbb Z}[k;k+1)
        $$
    \end{example}
    \begin{example}
        $X$~--- произвольное множество, $\mathbb P=2^X$, $\nu A=|A|$. (Считающая мера.)
    \end{example}
    \begin{example}
        $X$~--- произвольное множество, $\mathbb P=2^X$, $a\in X$. Тогда
        $$
        \delta_a A=\begin{cases}
            1&a\in A\\
            0&a\notin A
        \end{cases}
        $$
        Так и называется, $\delta$-мера. Или ещё называется единичной нагрузкой.\\
        Кстати,
        $$
        \chi_A a=\begin{cases}
            1&a\in A\\
            0&a\notin A
        \end{cases}
        $$
        называется характеристической функцией множества $A$.
    \end{example}
    \begin{example}
        $X$~--- произвольное множество, $\mathbb P=2^X$. Пусть $h\colon X\to[0;+\infty]$. Мы будем называть эту функцию числовым семейством и писать $\{h_x\}_{x\in X}$. Тогда
        $$
        \nu A=\sum\limits_{x\in A}h_x
        $$
        Дискретная мера, порождённая нагрузками $h_x$ в точках $x$. Счётная аддитивность следует из свойств суммы семейства (о суммировании группами).\\
        Она, кстати, через $\delta$-меры выражается:
        $$
        \mu A=\sum\limits_{x\in X}h_x\delta_xA
        $$
        $\mu A$ получается конечной, когда $\{x\in A\mid h_x>0\}$ не более чем счётно (опять же, по свойствам суммируемых семейств).\\
        При $h\equiv1$ получаем считающую меру.\\
        Типичная ситуация, когда задано $\{a_k\}\subset X$~--- не более чем счётный набор, $h_k\in(0;+\infty]$, $\mu A=\sum\limits_{k:a_k\in A}h_k$.
    \end{example}
    \begin{theorem}[Непрерывность меры]
        \label{Непрерывность меры}
        \begin{enumerate}
            \item Пусть $\{A_k\}_{k=1}^\infty\subset\mathbb P$, $A_k\subset A_{k+1}$,
            $$
            A=\bigcup\limits_{k=1}^\infty A_k
            $$
            И пусть $A\in\mathbb P$. Тогда
            $$
            \mu A_n\underset{k\to\infty}\longrightarrow\mu A
            $$
            \item Пусть $\{A_k\}_{k=1}^\infty\subset\mathbb P$, $A_k\supset A_{k+1}$,
            $$
            A=\bigcap\limits_{k=1}^\infty A_k
            $$
            Пусть $A\in\mathbb P$ и пусть $\mu A_1<+\infty$. Тогда
            $$
            \mu A_n\underset{k\to\infty}\longrightarrow\mu A
            $$
        \end{enumerate}
        Первое свойство называется непрерывностью меры снизу, второе~--- сверху.
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item
            Если с $\exists A_n$ с бесконечной мерой, то, тривиально, и предел и $\mu A$ равны бесконечности. Далее рассмотрим иной случай.\\
            Нарежем $A$ на слои:
            $$
            A=A_1\sqcup\bigsqcup\limits_{k=1}^\infty(A_{k+1}\setminus A_k)
            $$
            Каждая разность по \hyperref[prop:1 полукольца]{свойствам полукольца} представляется как объединение:
            $$
            A_{k+1}\setminus A_k=\bigsqcup\limits_{i=1}^{N_k}C_{ki}\mid C_{ki}\in\mathbb P
            $$
            отсюда
            $$
            A_{k+1}=A_k\sqcup\bigsqcup\limits_{i=1}^{N_k}C_{ki}
            $$
            Следовательно
            $$
            \mu A_{k+1}=\mu A_k+\sum\limits_{i=1}^{N_k}\mu C_{ki}
            $$
            Поскольку $\mu A_k<+\infty$,
            $$
            \mu A_{k+1}-\mu A_k=\sum\limits_{i=1}^{N_k}\mu C_{ki}
            $$
            Итого
            $$
            A=A_1\cup\bigcup\limits_{k=1}^\infty\bigcup\limits_{i=1}^{N_k}C_{ki}
            $$
            И всё тут дизъюнктно, то есть
            $$
            \mu A=\mu A_1+\sum\limits_{k=1}^\infty\sum\limits_{i=1}^{N_k}\mu C_{ki}=\mu A_1+\sum\limits_{k=1}^\infty(\mu A_{k+1}-\mu A_k)=\mu A_1+\lim_{n\to\infty}\sum\limits_{k=1}^n(\mu A_{k+1}-\mu A_k)=\lim_{n\to\infty}\mu A_n
            $$
            \item Если $\mu A_1<+\infty$, значит мера всех $A_k$ конечна.\\
            Теперь нарежем слоями $A_1$, а не $A$.
            $$
            A_1=A\sqcup\bigsqcup\limits_{k=1}^\infty A_k\setminus A_{k+1}
            $$
            Дальше в общем-то то же самое, что и раньше.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Требовалось, чтобы $\mu A_1$ была конечна. Разумеется, достаточно, чтобы мера хотя бы какого-то из $A_m$ была конечной.
    \end{remark}
    \begin{remark}
       Условие на конечность $\mu A_1$ существенно.\\
       Пусть $X=\mathbb R$, $\mu$~--- долина, $A_k=[k;+\infty)$. Тогда $A=\varnothing$, и предел не равен $\mu A$.
    \end{remark}
    \begin{remark}
        Посмотрим вот на что: у нас есть, скажем прямоугольники и мы знаем их площадь. А нам хочется измерять другие объекты. Как это можно сделать?
    \end{remark}
    \begin{definition}
        Пусть $\mu_0$~--- мера. Пусть $E\subset X$. \textbf{Внешней мерой} $E$, порождённой $\mu_0$ называется такая величина:
        $$\mu^*E=\inf\limits_{\substack{\{A_k\}\subset\mathbb P\\\bigcup\limits_kA_k\supset E}}\sum\limits_k\mu_0A_k$$
        Если таких $\{A_k\}$ не существует, $\mu^*E=+\infty$.
    \end{definition}
    \begin{property}
        Если $A\in\mathbb P$, то $\mu^*A=\mu_0A$.
    \end{property}
    \begin{proof}
        Докажем как систему двух неравенств.\\
        Поскольку $A\subset A$ $\mu^*A\leqslant\mu_0A$.\\
        Если $A\subset\bigcup\limits_kA_k$, то по полуаддитивности $\mu_0$
        $$
        \mu_0A\leqslant\sum\limits_k\mu_0A^k
        $$
        То есть $\mu_0A$~--- какая-то нижняя граница $\sum\limits_k\mu_0A^k$. А $\mu^*A$~--- точная нижняя граница, то есть $\mu_0A\leqslant\mu^*A$.
    \end{proof}
    \begin{property}
        Внешняя мера счётно-полуаддитивна:
        $$
        \forall\{E_k\}\subset X~\forall E\subset\bigcup\limits_kE_k~\mu^*E\leqslant\sum\limits_k\mu^kE_k
        $$
    \end{property}
    \begin{proof}
        Если $\exists k~\mu^* E_k=+\infty$, то доказывать нечего.\\
        Далее рассматриваем обратное. Докажем неравенство с точностью до $\varepsilon$, потом устремим его к нулю.\\
        Для каждого $k$ покроем $E_k$ счётным набором множество полукольца, так что зазор будет меньше $\frac\eps{2^k}$:
        $$
        \forall k~\exists\{A_{ki}\}_i\subset P:E_k\subset\bigcup\limits_iA_{ki}~\sum\limits_i\mu_0A_{ki}<\mu^*E_k+\frac\eps{2^k}
        $$
        Тогда $E\subset\bigcup\limits_kE_k\subset\bigcup\limits_{k,i}A_{ki}$. Тогда
        $$
        \mu^*E\leqslant\sum\limits_{k,i}\mu_0A_{ki}
        $$
        Второе можно записать как повторный предел, потому что семейство неотрицательное.
        $$
        \mu^*E\leqslant\sum\limits_k\sum\limits_i\mu_0A_{ki}\leqslant\sum\limits_k\left(\mu^*E_k+\frac\eps{2^k}\right)=\sum\limits_k\mu^*E_k+\eps
        $$
        Устремив $\eps$ к $0+$, получим то, что хотим.
    \end{proof}
    \begin{corollary}[Монотонность внешней меры]
        \label{Монотонность внешней меры}
        $$
        E\subset E_1\Rightarrow\mu^*E\leqslant\mu^* E_1
        $$
    \end{corollary}
    \begin{definition}
        Пусть $X$~--- множество. \textbf{Внешней мерой} в $X$ называется функция $\tau\colon 2^X\to[0;+\infty]$, равная нулю на пустом множестве и счётно-полуаддитивная.
    \end{definition}
    \begin{remark}
        Внешняя мера может быть не мерой (даже конечно-аддитивной она может не быть). И этого, конечно, не хочется. Поэтому откажемся от некоторых множеств так, чтобы на оставшихся внешняя мера была счётно-аддитивна.
    \end{remark}
    \begin{definition}
        Пусть $\tau$~--- внешняя мера в $X$, $A,E\subset X$. Говорят, что $A$ \textbf{аддитивно разбивает} $E$, если
        $$
        \tau E=\tau(E\cap A)+\tau(E\cap A\compl)
        $$
        Если $A$ аддитивно разбивает всякое $E\subset X$, то $A$ называется $\tau$-\textbf{измеримым}.
    \end{definition}
    \begin{remark}
        Неравенство
        $$
        \tau E\leqslant\tau(E\cap A)+\tau(E\cap A\compl)
        $$
        верно всегда, достаточно проверять обратное.
    \end{remark}
    \begin{remark}
        Если $\tau E=+\infty$, неравенство вше верно автоматически (а значит и равенство тоже). А значит неравенство
        $$
        \tau E\geqslant\tau(E\cap A)+\tau(E\cap A\compl)
        $$
        Имеет смысл проверять только для множеств конечной внешней меры.
    \end{remark}
    \begin{claim}
        Если $\tau A=0$, то $A$ $\tau$-измеримо.
    \end{claim}
    \begin{proof}
        Поскольку $E\cap A\subset A$, по \hyperref[Монотонность внешней меры]{монотонности внешней меры} $\tau(E\cap A)=0$.\\
        Поскольку $E\cap A\compl\subset A$, $\tau(E\cap A)\leqslant\tau E$. Всё.
    \end{proof}
    \begin{theorem}[Мера, порождённая внешней мерой]
        Пусть $\tau$~--- внешняя мера в $X$. Пусть $\mathbb A$~--- совокупность $\tau$-измеримых подмножеств $X$. Тогда $\mathbb A$~--- $\sigma$-алгебра и $\tau\big|_{\mathbb A}$~--- мера.
    \end{theorem}
    \begin{proof}
        Проверим кучу свойств. Начнём с того, что $\mathbb A$~--- алгебра.
        \begin{enumerate}
            \addtocounter{enumi}{-1}
            \item $\varnothing\in\mathbb A$, поэтому $A\neq\varnothing$.
            \item $A\in\mathbb A\Rightarrow A\compl\in\mathbb A$ просто потому, что в определении измеримого множества $A$ и $A\compl$ участвуют равноправно.
            \item Докажем, что $\forall A_1,A_2\in\mathbb A~A_1\cup A_2\in\mathbb A$. Зафиксируем $E\subset X$.
            \[\begin{split}
                \tau E&=\tau(E\cap A_1)+\tau(E\cap A_1\compl)=\\
                &=\tau(E\cap A_1)+\tau(E\cap A_1\compl\cap A_2)+\tau(E\cap A_1\compl\cap A_2\compl)=\\
                &=\tau(E\cap(A_1\cup A_2)\cap A_1)+\tau(E\cap (A_1\cup A_2)\cap\compl\cap A_1\compl)+\tau(E\cap(A_1\cup A_2)\compl)=\\
                &=\tau(E\cap(A_1\cup A_2))+\tau(E\cap(A_1\cup A_2)\compl)
            \end{split}\]
            По индукции получаем, что $\mathbb A$~--- алгебра.
        \end{enumerate}
        А что у нас, если $A_1$ и $A_2$ не только измеримы, но и дизъюнктны? Тогда
        $$
        \tau(E\cap(A_1\cup A_2))=\tau(E\cap(A_1\cup A_2)\cap A_1)+\tau(E\cap(A_1\cup A_2)\cap A_1\compl)=\tau(E\cap A_1)+\tau(E\cap A_2)
        $$
        По индукции утверждение верно для $n$ множеств.\\
        Надо как-то переходить от конечных семейств к счётным. Сначала перейдём к дизъюнктным. Пусть $\{A_k\}_{k=1}^\infty$ дизъюнктны, $A_k\in\mathbb A$. Докажем, что если $A=\bigsqcup\limits_{k=1}^\infty A_k$, то $A\in\mathbb A$ и $\forall E\in X~\tau(E\cap A)=\sum\limits_{k=1}^\infty \tau(E\cap A_k)$.\\
        Пусть
        $$
        B_n=\bigsqcup\limits_{k=1}^nA_k
        $$
        Тогда $B_n\in\mathbb A$, $B_n\subset A$ и $B_n\compl\supset A\compl$. Тогда
        \[\begin{split}
            \tau E&=\tau(E\cap B_n)+\tau(E\cap B_n\compl)=\\
            &=\sum\limits_{k=1}^n\tau(E\cap A_n)+\tau(E\cap A_n\compl)\geqslant\\
            &\geqslant\sum\limits_{k=1}^n\tau(E\cap A_k)+\tau(E\cap A\compl)
        \end{split}\]
        Устремим $n$ у бесконечности:
        $$
        \tau E\geqslant\sum\limits_{k=1}^\infty\tau(E\cap A_k)+\tau(E\cap A\compl)
        $$
        По полуаддитивности правая часть больше либо равна $\tau(E\cap A)+\tau(E\cap A\compl)$. Отсюда $A$ измеримо, а чтобы получить равенство $\sum\limits_{k=1}^\infty\tau(E\cap A_k)=\tau(E\cap A)$ достаточно в уже доказанном выше заменить $E$ на $E\cap A$:
        $$
        \tau(E\cap A)\geqslant\sum\limits_{k=1}^\infty\tau(E\cap A\cap A_k)+\tau(E\cap A\cap A\compl)
        $$
        Отсюда получите нужное утверждение сами.\\
        Теперь пусть $\{A_k\}_{k=1}^\infty\subset\mathbb A$ уже не обязательно дизъюнктны, $A=\bigcup\limits_{k=1}^\infty A_k$. Ну, уже имеющийся приём:
        $$
        A=A_1\sqcup\bigsqcup\limits_{k=1}^\infty(A_{k+1}\setminus A_k)
        $$
        А то что $A_{k+1}\setminus A_k\in\mathbb A$ мы знаем, мы доказали, что $\mathbb A$~--- алгебра.\\
        Осталось доказать счётную аддитивность. Пусть $\{A_k\}_{k=1}^\infty\subset\mathbb A$, $A=\bigsqcup\limits_{k=1}^\infty$. Ну так положим $E=A$ в доказательстве факта, где $A\in\mathbb A$. 
    \end{proof}
    \begin{definition}
        Пусть $\mu$~--- мера в $X$. $\mu$ называется \textbf{полной}, если
        $$A\in\mathbb P,\mu A=0,e\subset A\rightarrow e\in\mathbb P$$
        То есть если всякое подмножество множества нулевой меры лежит в полукольце.
    \end{definition}
    \begin{remark}
        Тогда $\mu e$ по монотонности равна нулю.
    \end{remark}
    \begin{remark}
        Слово <<полная>> не ст\'{о}ит никак связывать со словосочетанием <<полное пространство>>.
    \end{remark}
    \begin{corollary}
        Для любой внешней меры $\tau$ $\tau\big|_{\mathbb A}$~--- полная мера.
    \end{corollary}
    \begin{proof}
        По монотонности $\tau$ $\tau e=0$, а у нас было замечание, что из этого следует измеримость $e$.
    \end{proof}
    \begin{theorem}[Теорема Каратеодори]
        Пусть $\mu_0$~--- мера $X$, $\mu^*$~--- порождённая ей внешнюю меру, $\mathbb A$~--- совокупность $\mu^*$-измеримых подмножеств $X$.
        \begin{enumerate}
            \item $\mathbb A$~--- $\sigma$-алгебра.
            \item $\mu=\mu^*\big|_{\mathbb A}$~--- мера.
            \item $\mathbb P\subset\mathbb A$ и $\forall A\in\mathbb P~\mu A=\mu_0A$.
        \end{enumerate}
    \end{theorem}
    \begin{definition}
         Мера $\mu$ из теоремы выше называется \textbf{стандартным продолжением}/\textbf{стандартным распространением}/\textbf{продолжением по Каратеодори} меры $\mu_0$.
    \end{definition}
    \begin{proof}
        А что мы ещё не доказали? Только то, что $\mathbb P\subset\mathbb A$. Рассмотрим $A\in P$. надо доказать, что оно аддитивно разбивает всякое множество $E$.\\
        Докажем сначала для $E\in\mathbb P$. Тогда $E\cap A\in\mathbb P$, а $E\cap A\compl=\bigsqcup\limits_{k=1}^\infty C_k\mid C_k\in\mathbb P$. Тогда
        $$
        \mu^*E=\mu_0E=\mu_0(E\cap A)+\sum\limits_k\mu_0C_k=\mu^*(E\cup A)+\sum\limits_k\mu^*C_k\geqslant\mu^*(E\cap A)+\mu^*(E\cap A\compl)
        $$
        Теперь рассмотрим произвольное $E\subset X$. Если $\mu^*E=+\infty$, доказывать нечего, пусть меньше $+\infty$. Докажем с точностью до $\eps$.
        $$
        \forall\eps0~\exists\{A_k\}_k\subset\mathbb P: E\subset\bigcup\limits_kA_k,\sum\limits_k\mu_0A_k<\mu^*E+\eps
        $$
        $$
        \mu^*E+\eps>\sum\limits_k\mu_0A_k=\sum\limits_k\mu^*A_k=\sum\limits_k\mu^*(A_k\cap A)+\sum\limits_k\mu^*(A_k\cap A\compl)\geqslant\mu^*(E\cap A)+\mu^*(E\cap A\compl)
        $$
        Осталось лишь устремить $\eps$ к нулю.
    \end{proof}
    \begin{property}
        Если $A\subset X$, $\mu^*A=0$, то $A$ измеримо и $\mu A=0$.\\
        Это мы уже знаем.
    \end{property}
    \begin{property}
        Стандартное продолжение~--- полная мера.\\
        Это мы тоже уже знаем, на эту тему было следствие.
    \end{property}
    \begin{property}[Критерий измеримости]
        \label{Критерий измеримости}
        Пусть $E\subset X$ и $\forall\eps>0~\exists A_\eps,B_\eps\in\mathbb A~A_\eps\subset E\subset B_\eps$ и $\mu(B_\eps\setminus A_\eps)<\eps$. Тогда $E$ измеримо.\\
        Другими словами: если $E$ можно заключить между измеримыми множествами произвольно малого <<зазора>> между ними, то $E$ измеримо.
    \end{property}
    \begin{proof}
        Будем брать $\eps=\frac1n\mid n\in\mathbb N$. Пусть
        $$
        A=\bigcup\limits_{n=1}^\infty A_{1/n}\qquad B=\bigcup\limits_{n=1}^\infty B_{1/n}
        $$
        Тогда $A,B\in\mathbb A$ и $A\subset E\subset B$. Осталось оценить меру разности:
        $$
        \forall n~\mu(B\setminus A)\leqslant\mu(B_{1/n}\setminus A_{1/n})<\frac1n
        $$
        Отсюда $\mu(B\setminus A)=0$. А дальше понятно:
        $$
        E\setminus A\subset B\setminus A
        $$
        Тогда по полноте $\mu$ $E\setminus A\in\mathbb A$ и $\mu(E\setminus A)=0$. Тогда
        $$
        E=A\cup(E\setminus A)\in\mathbb A
        $$
    \end{proof}
    \begin{corollary}
        Если $E\subset X$ и $\forall\eps>0~\exists B_\eps\in\mathbb A~E\subset B_\eps,\mu B_\eps<\eps$, то $E\in\mathbb A$ и $\mu E=0$.
    \end{corollary}
    \begin{property}[$\sigma$-конечность $\mu_0$ и $\mu$ равносильны]
        Напоминание: мера называется $\sigma$-конечной, если всё пространства представляется в виде счётного объединения множеств конечной меры.
    \end{property}
    \begin{proof}
        Пусть $\mu_0$ $\sigma$-конечна. Тогда $X$ представлен в виде не более чем счётного объединения $A_k$, где $A_k\in\mathbb P$ и $\mu A_k<+\infty$. Ну так блин, $\mathbb P\subset\mathbb A$, а значит в виде объединения множеств из $\mathbb A$ у нас уже есть, то есть $\mu$ тоже $\sigma$-конечна.\\
        Теперь в обратную сторону. 
        $$
        X=\bigcup\limits_kA_k\mid A_k\in\mathbb A,\mu A_k<+\infty
        $$
        Тогда $\mu^*A_k=\mu A_k<+\infty$. А по определению внешней меры что такое $\mu^*A_k$? Это нам нужно разбить $A_k$ на множества полукольца, взять меру от них и взять $\inf$.  Тогда
        $$
        \forall k~\exists\{A_{k,i}\}_i\subset\mathbb P~\bigcup\limits_i\underbrace{\mu_0 A_{k,i}}_{=\mu A_{k,i}}<\mu A_k+1<+\infty
        $$
        Ну, вот и всё, у нас есть счётное количество счётных семейств $A_{k,i}$, то есть счётное количество элементов $\mathbb P$, дающих в объединении $X$. И у каждого конечная мера.
    \end{proof}
    \begin{remark}
        \hyperref[Критерий измеримости]{Критерий измеримости} и его следствие верны для любой полной меры, заданной на $\sigma$-алгебре.
    \end{remark}
    \begin{remark}
        $$\mu A=\inf\limits_{\substack{\{A_k\}\subset\mathbb P\\\bigcup_kA_k\supset A}}\sum\limits_{k}A_k$$
    \end{remark}
    \begin{claim}
        Стандартное продолжение стандартного продолжения приводит к той же самой мере на той же самой $\sigma$-алгебре. Более того, $\mu_0$ и $\mu$ порождают одну и ту же внешнюю меру.\\
        Без доказательства.
    \end{claim}
    \begin{claim}
        $\mathbb A$ не обязано быть минимальной $\sigma$-алгеброй, содержащей $\mathbb P$.\\
        Без доказательства, но для меры Лебега, так и получится.
    \end{claim}
    \begin{theorem}[Единственность стандартного продолжения]
        Пусть $X,\mathbb P,\mu_0,\mu^*,\mathbb A,\mu$~--- всё то, что мы уже знаем. И пусть у нас есть ещё какое-то продолжение $\mu_0$ с $\mathbb P$ на какую-то $\sigma$-алгебру $\mathbb B$ (назовём его $\nu$). Пусть ещё $\mu_0$ $\sigma$-конечна.\\
        Тогда
        $$
        \mu\Big|_{\mathbb A\cap\mathbb B}\equiv\nu\Big|_{\mathbb A\cap\mathbb B}
        $$
        Если, кроме того $\nu$~--- полная мера, то $\mathbb A\subset\mathbb B$.\\
        Без доказательства.
    \end{theorem}
    \begin{corollary}
        Получается $\mathbb A$~--- минимальная $\sigma$-алгебра, на которую можно продолжить $\mu_0$ до полной меры.
    \end{corollary}
    \begin{example}
        Что за странное условие на $\sigma$-конечность $\mu^0$? А вот оно необходимо.\\
        $X=\{0,1\}$, $\mathbb P=\{\varnothing,\{0\}\}$. $\mu_0\varnothing=0$, $\mu_0\{0\}=1$. Теперь посчитаем стандартное продолжение и приведём ещё одно.\\
        $$
        \mu\{1\}=+\infty\qquad\mu X=+\infty
        $$
        Теперь второе:
        $$
        \nu\{1\}=2\qquad\nu X=3
        $$
    \end{example}
    \paragraph{Мера Лебега в евклидовых пространствах.}
    \begin{remark}
        Напоминание: мы живём в $\mathbb R^n$, а также умеем сравнивать векторы:
        $$
        a<b\Leftrightarrow\forall k\in[1:n]~a_k<b_k
        $$
        Слово <<параллелепипед>> значит прямоугольный параллелепипед со сторонами, параллельными осям.
    \end{remark}
    \begin{definition}
        Пусть $a,b\in\mathbb R^n$, $a\leqslant b$. Тогда параллелепипед
        $$[a;b)=\{x\in\mathbb R^n\mid a\leqslant x<b\}$$
        называется \textbf{ячейкой}. Пустое множество также является ячейкой ($a=b$).\\
        $\mathbb P_n$~--- множество ячеек.
    \end{definition}
    \begin{remark}
        Такие будут нам удобны, потому что ими можно замостить $\mathbb R^n$ без зазоров и пересечений.
    \end{remark}
    \begin{lemma}
        $\mathbb P_n$~--- полукольцо.
    \end{lemma}
    \begin{proof}
        Пустое множество мы назвали ячейкой, так что первая аксиома выполнена.\\
        Пересечение: докажем, что $[a;b)\cap[c;d)$~--- ячейка. Несложно заметить, что
        $$
        [a;b)=\bigtimes\limits_{k=1}^n[a_k;b_k)
        $$
        Ну тогда
        $$
        [a;b)\cap[c;d)=\bigtimes\limits_{k=1}^n[a_k;b_k)\cap[c_k;d_k)=\bigtimes\limits_{k=1}^n[\max\{a_k;c_k\};\min\{b_k;d_k\})
        $$
        А справа написана ячейка.\\
        Теперь про разность. Пусть $[a;b)\subset[c;d)$. Отсюда следует, что
        $$
        \forall k\in[1:n]~a_k\leqslant c_k\leqslant d_k\leqslant b_k
        $$
        Тогда
        $$
        [a_k;b_k)=[a_k;c_k)\sqcup[c_k;d_k)\sqcup[d_k;b_k)
        $$
        Отсюда $[a;b)$ представимо как дизъюнктное объединение $3^n$ множеств, а $[a;b)\setminus[c;d)$~--- $3^n-1$.
    \end{proof}
    \begin{definition}
        \textbf{Классическим объёмом} ячейки $[a;b)$ называется
        $$v[a;b)=\prod\limits_{k=1}^\infty(b_k-a_k)$$
        Иногда $v$ пишут как $v_n$.
    \end{definition}
    \begin{property}
        Классический объём конечно-аддитивен.
    \end{property}
    \begin{proof}
        Пусть $\Delta^i$~--- последовательность дизъюнктных $n$-мерных ячеек,
        $$
        \Delta=\bigsqcup\limits_{i=1}^m\Delta_i
        $$
        Требуется доказать, что $v\Delta=\sum\limits_{i=1}^mv\Delta^i$.\\
        Докажем это сначала для конкретного разбиения. Пусть $\Delta=[a;b)$. Рассмотрим
        $$
        a_k=x_k^0<x_k^1<\cdots<x_k^{m_k}=b_k
        $$
        $$
        [a;b)=\bigtimes\limits_{k=1}^n\bigsqcup\limits_{i_k=0}^{m_k-1}[x_{i_k};x_{i_k+1})=\bigsqcup\limits_{i_1=0}^{m_k-1}\cdots\bigsqcup\limits_{i_n=0}^{m_n-1}\bigtimes\limits_{k=1}^n[x_{i_k};x_{i_k+1})
        $$
        Такое разбиение называется сетчатым. И в таком классе разбиений аддитивность очевидна.\\
        Но это же не все разбиения, не правда ли. Ну так понятно, что делать: дополнить его до сетчатого и воспользуемся тем, что уже доказали. Как это формально записать? Ну, берём все возможные концы рёбер, упорядочиваем этот набор по каждой координате, получаем сетчатое разбиение.
    \end{proof}
    \begin{remark}
        Вообще что у этого следствия, что у леммы выше есть абстрактный вариант, потому что существует конструкции <<произведение полуколец>> и <<произведение объёмов>>. Правда тут есть проблема в том, что полукольца у нас будут над разными пространствами, и с этим надо жить.
    \end{remark}
    \begin{definition}
        Пусть $\mathbb P$ и $\mathbb Q$~--- полукольца над $X$ и $Y$ соотвественно. Тогда
        $$
        \mathbb R=\{P\times Q\mid P\in\mathbb P,Q\in\mathbb Q\}
        $$
        Тогда $\mathbb R$ является полукольцом над $X\times Y$ и называется \textbf{произведением полуколец} $\mathbb P$ и $\mathbb Q$.
    \end{definition}
    \begin{definition}
        Если $u$~--- объём на $\mathbb P$, $v$~--- объём на $\mathbb Q$, то
        $$
        w\colon P\times Q\mapsto u(P)v(Q)
        $$
        называется \textbf{произведением объёмов} $u$ и $v$.
    \end{definition}
    \begin{remark}
        Чтобы доказать, что произведение полуколец является полукольцом, а произведение объёмов~--- объёмом, воспользуемся уже произведёнными методиками.
    \end{remark}
    \begin{lemma}
        Пусть $\Delta=[a;b)$~--- ячейка. Тогда для любого $\eps$ существуют ячейки $\Delta^{\pm\eps}$ со следующими свойствами:
        $$
        \overline{\Delta^{-\eps}}\subset\overset{\circ}{\Delta}\subset\overline\Delta\subset\overset\circ{\Delta^{+\eps}}
        $$
        $$
        v\Delta^{+\eps}-v\Delta<\eps\qquad v\Delta-v\Delta^{-\eps}<\eps
        $$
    \end{lemma}
    \begin{proof}
        Поскольку объём ячейки непрерывен относительно её вершин
        $$
        \exists t>0~v[a-tI;b+tI)-v[a;b)<\eps\qquad v[a;b)-v[a+tI;b-tI)<\eps
        $$
        Возьмём это $t$ и скажем, что
        $$
        \Delta^{+\eps}=[a-tI;b+tI)\qquad \Delta^{-\eps}=[a+tI;b-tI)
        $$
    \end{proof}
    \begin{theorem}
        Классический объём является мерой.
    \end{theorem}
    \begin{proof}
        Проверим счётную аддитивность объёма. Пусть
        $$
        \{\Delta_i\}_{i=1}^\infty\subset\mathbb P_n\qquad\Delta=\bigsqcup\limits_{i=1}^\infty\Delta_i
        $$
        По свойствам объёма он обладает усиленной монотонностью:
        $$
        \sum\limits_{i=1}^\infty v\Delta_i\leqslant v\Delta
        $$
        Докажем противоположное неравенство. Возьмём $\eps>0$ и построим $\Delta^{-\eps}$ из леммы выше. Также для каждого $i\in\mathbb N$ построим $D_i=\Delta_i^{+\eps/2^i}$. Тогда
        $$
        \overline{\Delta^{-\eps}}\subset\Delta=\bigcup\limits_{i=1}^\infty\Delta_i\subset\bigcup\limits_{i=1}^\infty\overset\circ{D_i}
        $$
        То есть $\{\overset\circ{D_i}\}_{i=1}^\infty$~--- покрытие компакта $\overline{\Delta^{-\eps}}$ открытыми множествами, а значит из него можно извлечь конечное подпокрытие $\{\overset\circ{D_i}\}_{i=1}^N$:
        $$
        \Delta^{-\eps}\subset\overline{\Delta^{-\eps}}\subset\bigcup\limits_{i=1}^N\overset\circ{D_i}\subset\bigcup\limits_{i=1}^ND_i
        $$
        В силу конечной полуаддитивности объёма
        $$
        v\Delta^{-\eps}\leqslant\sum\limits_{i=1}^NvD_i\leqslant\sum\limits_{i=1}^\infty vD_i
        $$
        Отсюда
        $$
        v\Delta<v\Delta^{-\eps}+\eps\leqslant\sum\limits_{i=1}^\infty vD_i+\eps<\sum\limits_{i=1}^\infty\left(v\Delta_i+\frac\eps{2^i}\right)+\eps\leqslant\sum\limits_{i=1}^\infty v\Delta_i+2\eps
        $$
        устремим $\eps$ к нулю.
    \end{proof}
    \begin{definition}
        Стандартное распространение классического объема с полукольца ячеек $\mathbb P_n$ на некоторую $\sigma$-алгебру $\mathbb A_n$ называется \textbf{мерой Лебега} в $\mathbb R^n$, а элементы $\mathbb A_n$~--- \textbf{измеримыми по Лебегу множествами}.\\
        Мера Лебега будет обозначаться через $\mu_n$, а внешняя мера, порожденная объемом (она называется \textbf{внешней мерой Лебега}),~--- через $\mu_n^*$. Индекс $n$, указывающий на размерность пространства, часто опускается.\\
        В этом параграфе, если не оговорено противное, $\mu$~--- мера Лебега.
    \end{definition}
    \begin{claim}
        Мера Лебега $\sigma$-конечна.
    \end{claim}
    \begin{proof}
        $$
        \mathbb R^n=\bigsqcup\limits_{k\in\mathbb Z^n}[k;k+I)\qquad\mu[k;k+I)=1
        $$
    \end{proof}
    \begin{remark}
        До сих пор в определении параллелепипеда $\langle a;b\rangle$ мы полагали, что $a,b\in\mathbb R^n$. Расширим это определение и будем считать, что некоторые $a$ могут равняться $-\infty$, а некоторые $b$~--- $+\infty$.
    \end{remark}
    \begin{theorem}
        Вский параллелепипед измерим по Лебегу, а го мера равна произведению длин рёбер.
    \end{theorem}
    \begin{remark}
        Как обычно, мы пользуемся соглашением $0\cdot\infty=0$. Таким образом, если у параллелепипеда есть вырожденное ребро, то его мера равна нулю, несмотря на то, что некоторые ребра могут быть бесконечны.
    \end{remark}
    \begin{proof}
        Пусть $a,b\in\mathbb R^n$, $\Pi=\langle a;b\rangle$~--- параллелепипед с конечными рёбрами. Тогда
        $$
        [a;b]=\bigcap\limits_{p=1}^\infty\left[a;b+\frac1pI\right)\qquad(a;b)=\bigcup\limits_{p=1}^\infty\left[a+\frac1pI;b\right)
        $$
        По непрерывности меры
        $$
        \mu[a;b]=\lim\limits_{p\to\infty}\left[a;b+\frac1pI\right)=\lim\limits_{p\to\infty}\prod\limits_{k=1}^\infty\left(b_k+\frac1p-a_k\right)=\prod\limits_{k=1}^\infty\left(b_k-a_k\right)
        $$
        $$
        \mu(a;b)=\lim\limits_{p\to\infty}\left[a+\frac1pI;b\right)=\lim\limits_{p\to\infty}\prod\limits_{k=1}^\infty\left(b_k-a_k-\frac1p\right)=\prod\limits_{k=1}^\infty\left(b_k-a_k\right)
        $$
        По \hyperref[Критерий измеримости]{критерию измеримости} $\Pi$ измерим, а по монотонности меры
        $$
        \mu\Pi=\mu[a;b]=\prod\limits_{k=1}^\infty\left(b_k-a_k\right)
        $$
        Теперь пусть $\exists j~b_j-a_j=+\infty$. Пусть $\Delta_p=[-pI;pI)$. Тогда $\Delta_p\subset\Delta_{p+1}$ и $\mathbb R^n=\bigcup\limits_{p=1}^\infty\Delta_i$. Отсюда
        $$
        \Pi\cap\Delta_p\subset\Pi\cap\Delta_{p+1}
        $$
        И
        $$
        \Pi=\bigcup\limits_{p=1}^\infty(\Pi\cap\Delta_p)
        $$
        Пересечение $\Pi\cap\Delta_p$ является параллелепипедом с конечными рёбрами: $\langle\max\{a_k;-p\};\min\{b_k;p\}\rangle$. По доказанному выше он измерим, а значит и $\Pi$ измерим как счётное объединение измеримых множеств. При этом если у $\Pi$ есть вырожденное ребро, то $\forall p~\mu(\Pi\cap\Delta_p)=0$, а значит и $\mu\Pi=0$, а если вырожденных рёбер нет, то по непрерывности меры
        $$
        \mu\Pi=\lim\limits_{p\to\infty}\mu(\Pi\cap\Delta_p)=\lim\limits_{p\to\infty}\prod\limits_{k=1}^n(\min\{b_k;-\}-\max\{a_k;-p\})=+\infty
        $$
    \end{proof}
    \begin{corollary}
        Всякое не более чем счётное подмножество $\mathbb R^n$ измеримо по Лебегу и имеет нулевую меру.
    \end{corollary}
    \begin{proof}
        Всякое одноточечное множество измеримо и имеет нулевую меру как параллелепипед с вырожденными ребрами. Так как измеримые множества образуют $\sigma$-алгебру, не более чем счетное множество измеримо как не более чем счетное объединение одноточечных множеств. Его мера равна нулю по счетной аддитивности.
    \end{proof}
    \begin{corollary}
        $$\mu\mathbb Q=0$$
    \end{corollary}
    \begin{theorem}[Представление открытого множества в виде объединения ячеек]
        \label{Представление открытого множества в виде объединения ячеек}
        Всякое открытое $G\subset\mathbb R^n$ представляется в виде
        $$
        G=\bigsqcup_k\Delta_k
        $$
        Где $\Delta_k$~--- кубические ячейки, $\overline{\Delta_k}\subset G$.
    \end{theorem}
    \begin{proof}
        Пусть $m\in\mathbb Z_+$. Множества $\left[\frac k{2^m};\frac{k+I}{2^m}\right)$ (где $k\in\mathbb Z_n$) будем называть двоичными $n$-мерными ячейками ранга $m$.\\
        При каждом $m$ ячейки ранга $m$ образуют разбиение $\mathbb R^n$. Поэтому для любых $x\in \mathbb R^n$ и $m\in\mathbb Z_+$ существует ровно одна ячейка ранга $m$, содержащая $x$. Обозначим ее $\Delta_{m,x}$. Кроме того, любые две двоичные ячейки или дизъюнктны, или одна из них содержит другую, а множество всех двоичных ячеек счетно.\\
        Обозначим через $H_0$ множество всех ячеек ранга 0, замыкание которых содержится в $G$. Пусть $m\in\mathbb N$, множества $H_0$, ..., $H_{m-1}$ уже определены. Тогда обозначим через $H_m$ множество всех ячеек ранга $m$, замыкание которых содержится в $G$, и которые не содержатся ни в одной ячейке из $H_0$, ..., $H_{m-1}$. Положим
        $$H=\bigcup\limits_{m=0}^\infty H_m$$
        Тогда $H$ не более чем счетное множество дизъюнктных ячеек.\\
        Докажем, что
        $$
        \bigsqcup\limits_{\Delta\in H}\Delta=G
        $$
        Включение левой части в правую очевидно. Проверим обратное включение. Пусть $x\in G$. Ввиду открытости $G$ найдется такое $r>0$, что $\overline B(x;r)\subset G$. Если $m$ таково, что $\frac{\sqrt n}{2^m}<r$, то $\overline\Delta_{m,x}\subset\overline B(x,r)\subset G$. Поскольку такие $m$ существуют,
        $$\{m\in\mathbb Z_+\mid\overline\Delta_{m,x}\subset G\}\neq\varnothing$$
        Обозначим через $m_0$ его минимум, тогда для $m<m_0$ $\overline\Delta_{m,x}\not\subset G$, а $\overline\Delta_{m_0,x}\subset G$. Это по определению значит, что $\Delta_{m_0,x}\in H_{m_0}$, а значит $x\in\bigsqcup\limits_{\Delta\in H}\Delta$.
    \end{proof}
    \begin{remark}
        Если $G\neq\varnothing$, то объединение счётно. Иначе $G=\bigsqcup\limits_{k=1}^N\overline\Delta_k$, а значит $G$ ограничено и замкнуто (а ещё открыто из условия). Такое множество не может быть непустым, это противоречит связности $\mathbb R^n$.
    \end{remark}
    \begin{corollary}
        Всякое открытое подмножество $\mathbb R^n$ измеримо по Лебегу.
    \end{corollary}
    \begin{corollary}
        Мера Лебега любого непустого открытого множества положительна.
    \end{corollary}
    \begin{corollary}
        Всякое борелевское подмножество $\mathbb R^n$ измеримо по Лебегу.
    \end{corollary}
    \begin{claim}
        Существуют неизмеримые по Лебегу подмножества $\mathbb R^n$. Более того, всякое множество положительной лебеговой меры имеет неизмеримое подмножество.\\
        Без доказательства.
    \end{claim}
    \begin{claim}
        Существуют измеримые по Лебегу множества, не являющиеся борелевскими. Более того, $\sigma$-алгебры $\mathbb A_n$ и $\mathbb B_n$ не равномощны: $\mathbb B_n$ имеет мощность континуума, то есть равномощна $\mathbb R^n$, а $\mathbb A_n$ имеет ту же мощность, что и совокупность всех подмножеств $\mathbb R^n$.\\
        Без доказательства.
    \end{claim}
    \begin{theorem}
        Если $E\subset\mathbb R^n$, то
        $$
        \mu^*E=\inf\limits_{\substack{G\supset E\\G\text{ открыто}}}\mu G
        $$
        В частности это верно для $E\in\mathbb A^n$.
    \end{theorem}
    \begin{proof}
        Обозначим правую часть за $A$. По \hyperref[Монотонность внешней меры]{монотонности внешней меры} для любого открытого множества $G\supset E$ верно
        $$
        \mu^*E\leqslant\mu^*G=\mu G
        $$
        Переходя в правой части к инфимуму, получим $\mu^*E\leqslant A$.\\
        Докажем в обратную сторону. Если $\mu^*E=+\infty$, мы победили. Иначе возьмём $\eps>0$, тогда по определению внешней меры
        $$
        \exists\{\Delta_k\}_k\subset\mathbb P_n~E\subset\bigcup\limits_k\Delta_k\qquad\sum\limits_kv\Delta_k<\mu^*E+\eps
        $$
        По лемме о существовании $\Delta^{\pm\eps}$ подберём такой открытый параллелепипед $\Delta'_k\supset\Delta_k$, что $v\Delta'_k<v\Delta_k+\frac\eps{2^k}$. Тогда $G=\bigcup\limits_k\Delta'_k$ открыто, $E\subset G$ и
        $$
        \mu G\leqslant\sum\limits_k\mu\Delta'_k<\sum\limits_k\left(v\Delta_k+\frac\eps{2^k}\right)\leqslant\sum\limits_kv\Delta_k+\eps<\mu^*E+2\eps
        $$
        Отсюда по произвольности $\eps$ $A\leqslant\mu^*E$.
    \end{proof}
    \begin{corollary}
        Пусть $E\in\mathbb A_n$, $\eps>0$. Тогда существует такое открытое множество $G\supset E$, что $\mu(G\setminus E)<\eps$.
    \end{corollary}
    \begin{proof}
        Если $\mu E<+\infty$, то утверждение напрямую следует из теоремы. Если $\mu E=+\infty$, то $E$ можно представить в виде
        $$
        E=\bigcup\limits_{k=1}^\infty\mid\mu E_k<+\infty
        $$
        (следует из $\sigma$-конечности $\mu$). Тогда по первому пункту для каждого $E_k$ можно подобрать такое открытое множество $G_k\supset E_k$, что $\mu(G_k\setminus E_k)<\frac\eps{2^k}$. Пусть $G=\bigcup\limits_{k=1}^\infty G_k$. Тогда $G$ открыто, $E\subset G$ и $G\setminus E\subset\bigcup\limits_{k=1}^\infty(G_k\setminus E_k)$, а значит
        $$
        \mu(G\setminus E)\leqslant\sum\limits_{k=1}^\infty\mu(G_k\setminus E_k)<\sum\limits_{k=1}^\infty\frac\eps{2^k}=\eps
        $$
        Это ли не то, что нам надо.
    \end{proof}
    \begin{corollary}
        Пусть $E\subset\mathbb A_n$, $\eps>0$. Тогда существует такое замкнутое $F\subset E$, что $\mu(E\setminus F)<\eps$.
    \end{corollary}
    \begin{proof}
        Примени следствие 1 к $E\compl$, найдём там открытое множество $G\supset E\compl$, для которого верно $\mu(G\setminus E\compl)<\eps$. Тогда $F=G\compl$ (проверьте сами, что подходит).
    \end{proof}
    \begin{corollary}
        Пусть $E\in\mathbb A_n$. Тогда
        $$
        \mu E=\sup\limits_{\substack{F\subset E\\F\text{ замкнуто}}}\mu F=\sup\limits_{\substack{F\subset E\\F\text{ компактно}}}\mu F
        $$
    \end{corollary}
    \begin{proof}
        Пусть
        $$
        \sup\limits_{\substack{F\subset E\\F\text{ замкнуто}}}\mu F=B\qquad\sup\limits_{\substack{F\subset E\\F\text{ компактно}}}\mu F=C
        $$
        Ясно, что $\mu E\geqslant B\geqslant C$. Первое неравенство обращается в равенство по следствию 2. Осталось доказать $B\leqslant C$.\\
        Для произвольного замкнутого множества $F\subset E$ положим $F_p=F\cap[-pI;pI]$. Множества $F_p$ компактны, $F_p\subset F_{p+1}$ и $F=\bigcup\limits_{p=1}^\infty F_p$. По \hyperref[Непрерывность меры]{теореме о непрерывности меры}
        $$
        \mu F=\lim\limits_{p\to\infty}\mu F_p\leqslant C
        $$
        Остаётся перейти к супремуму по $F$ в левой части.
    \end{proof}
    \begin{definition}
        Пусть $X$~--- метрическое пространство, мера $\mu$ задана на $\sigma$-алгебре $\mathbb A$, содержащей все открытые подмножества $X$. Мера $\mu$ называется \textbf{регулярной}, если для любого $E\in\mathbb A$
        $$
        \mu E=\inf\limits_{\substack{G\supset E\\G\text{ открыто}}}\mu G=\sup\limits_{\substack{F\subset E\\F\text{ замкнуто}}}\mu F
        $$
    \end{definition}
    \begin{remark}
        То есть мера Лебега регулярна.
    \end{remark}
    \begin{remark}
        Открытые и замкнутые множества в определении регулярности нельзя поменять ролями. Приведем примеры для меры Лебега $\mu_1$ на прямой.\\
        Единственное открытое подмножество множества $E_1=[0;1]\cap\mathbb Q$ пусто, а наименьшее содержащее $E_1$ замкнутое множество~--- $[0;1]$. Аналогичными свойствами обладает множество $E_2=[0;1]\setminus\mathbb Q$. При этом $\mu_1E_1=0$, $\mu_1E_2=1$.
    \end{remark}
    \begin{remark}
        Можно определить внутреннюю меру $E\subset\mathbb R^n$ равенством
        $$
        \mu_*E=\sup\limits_{\substack{F\subset E\\F\text{ замкнуто}}}\mu F
        $$
        В силу регулярности меры Лебега измеримость $E$ влечет равенство $\mu^*E=\mu_*E$. Это утверждение можно частично обратить: если $\mu_*E=\mu^*E<+\infty$, то $E$ измеримо. Последнее свойство использовалось Лебегом в качестве определения измеримости ограниченного множества.
    \end{remark}
    \begin{theorem}[Приближение измеримых множеств борелевскими]
        \label{Приближение измеримых множеств борелевскими}
        Пусть $E\in\mathbb A_n$. Тогда существуют такие множества $H$ и $K$ типов $F_\sigma$ и $G_\delta$ соотвественно, что
        $$
        H\subset E\subset K\qquad\mu(K\setminus H)=0
        $$
    \end{theorem}
    \begin{proof}
        По следствиям выше для любого $m\in\mathbb N$ существуют множества $F_m$ и $G_m$ такие что $F_m$ замкнуто, $F_m$ открыто, $F_m\subset E\subset G_m$, $\mu(E\setminus F_m)<\frac1m$ и $\mu(G_m\setminus E)<\frac1m$. Тогда пусть
        $$
        H=\bigcup\limits_{m=1}^\infty F_m\qquad K=\bigcap\limits_{m=1}^\infty G_m
        $$
        Эти множества по определению принадлежат указанным типам; очевидно, что $H\subset E\subset K$, а также для всех $m$
        $$
        \mu(K\setminus H)\leqslant\mu(G_m\setminus F_m)=\mu(G_m\setminus E)+\mu(E\setminus F_m)<\frac2m
        $$
        Устремляя $m\to\infty$, получим $\mu(H\setminus H)=0$.
    \end{proof}
    \begin{corollary}
        \label{Структура произвольного измеримого множества}
        Пусть $E\in\mathbb A_n$. Тогда $E$ представимо в виде
        $$
        E=\bigcup\limits_{k=1}^\infty F_k\cup e
        $$
        Где $F_k$ компактны, $F_k\subset F_{k+1}$, $\mu e=0$.
    \end{corollary}
    \begin{proof}
        Положим $e=E\setminus H$. Тогда $e\subset K\setminus H$, откуда $\mu e=0$. Далее мы знаем, что
        $$
        H=\bigcup\limits_{k=1}^\infty
        $$
        (это ещё не те самые $F_k$), где $F_k$ замкнуты. Каждое $F_k$ представимо в виде счётного объединения компактов:
        $$
        F_k=\bigcup\limits_{j=1}^\infty(F_k\cap[-pI;pI])
        $$
        А значит и $H$ можно представить в виде объединения компактов. Перенумеруем их и назовём $K_i$:
        $$
        H=\bigcup\limits_{i=1}^\infty K_i
        $$
        Приняв $\widetilde K_l=\bigcup\limits_{i=1}^lK_i$, получим последовательность компактов $\widetilde K_l$, для которой верно $\widetilde K_l\subset\widetilde K_{l+1}$. Эти $\widetilde K_l$ подойдут под $F_k$ в условии.
    \end{proof}
    \subparagraph{Сохранение измеримости и преобразование меры Лебега при отображениях.}
    \begin{claim}
        \label{Образ объединения равен объединению образов}
        Образ объединения равен объединению образов.
    \end{claim}
    \begin{proof}
        Тривиально из определений.
    \end{proof}
    \begin{theorem}[Сохранение измеримости при гладком отображении]
        \label{Сохранение измеримости при гладком отображении}
        Пусть $G$ открыто в $\mathbb R^n$, $\Phi\in C^{(1)}(G\to\mathbb R^n)$. Тогда выполнены следующие утверждения:
        \begin{enumerate}
            \item Если $e\subset G$ и $\mu e=0$, то $\Phi(e)\in\mathbb A_n$ и $\mu\Phi(e)=0$.
            \item Если $E\subset F$ и $E\in\mathbb A_n$, то $\Phi(E)\in\mathbb A_n$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item Разобьём на два случая: первый~--- когда $e$ содержится в некоторой ячейке, которая лежит в $G$ вместе с замыканием, второй~--- общий.
            \begin{enumerate}[a.]
                \item Итак, существует ячейка $P$ такая что
                $$
                e\subset P\subset\overline P\subset G\qquad P\in\mathbb P_n
                $$
                Возьмём $\eps>0$ и, пользуясь регулярностью меры Лебега, подберём такое открытое множество $g$, что $e\subset g$ и $\mu g<\eps$. Можно считать, что $g\subset G$, иначе заменим $g$ на $g\cap G$ (оно также открыто). Тогда по теореме \ref{Представление открытого множества в виде объединения ячеек}
                $$
                g=\bigsqcup_k\Delta_k
                $$
                Где $\Delta_k$~--- кубические ячейки. Следовательно
                $$
                \sum\limits_k\mu\Delta_k=\mu g<\eps\qquad e\subset\bigcup\limits_k(\Delta_k\cap P)\qquad\Phi(e)\subset\bigcup\limits_k\Phi(\Delta_k\cap P)
                $$
                Пусть $h_k$~--- длина ребра $\Delta_k$. Тогда
                $$\forall x,y,\in\Delta_k~|x-y|<h_k\sqrt n$$
                Гладкое отображение $\Phi$ удовлетворяет условию Липшица на компакте $\overline P$:
                $$
                \exists L\in(0;+\infty)~\forall x,y\in\overline P~|\Phi(x)-\Phi(y)|\leqslant L|x-y|
                $$
                Отсюда
                $$
                \forall x,y\in\Delta_k\cap P~|\Phi(x)-\Phi(y)|\leqslant Lh_k\sqrt n
                $$
                Последнее неравенство также тривиально верно для координатных функций $\Phi$, а значит, если мы зафиксируем $x\in\Delta_k\cap P$, по получим, что $\forall y\in\Delta_k\cap P$
                $$
                \Phi(y)\in[\Phi(x)-Lh_k\sqrt nI;\Phi(x)+Lh_k\sqrt nI]
                $$
                Обозначим часть справа за $\Pi_k$. То есть имеем $\Phi(\Delta_k\cap P)\subset\Pi_k$. Следовательно $\Phi(e)\subset\bigcup\limits_k\Pi_k$. Давайте оценим меру правой части:
                $$
                \mu\bigcup\limits_k\Pi_k\leqslant\sum\limits_k\mu\Pi_k=\sum\limits_k(2Lh_k\sqrt n)^n=(2L\sqrt n)^n\sum\limits_kh_k^n=(2L\sqrt n)^n\sum\limits_k\mu\Delta_k<(2L\sqrt n)^n\eps
                $$
                По одному из свойств стандартного продолжения это значит, что $\Phi(e)$ измеримо и имеет нулевую меру.
                \item Теперь рассмотрим общий случай. Мы по условию знаем, что $e\subset G$ и $\mu e=0$. Тогда представим $G$ в виде
                $$
                G=\bigcup\limits_kP_k\qquad P_k\in\mathbb P_n,\overline P_k\subset G
                $$
                Тогда
                $$
                e=\bigcup\limits_k(e\cap P_k)\qquad\Phi(e)=\bigcup\limits_k\Phi(e\cap P_k)
                $$
                По первому случаю $\forall k~\mu\Phi(e\cap P_k)=0$, а значит и $\Phi(e)\in\mathbb A_n$ и $\mu\Phi(e)=0$.
            \end{enumerate}
            \item Теперь докажем второй пункт. По следствию теоремы \ref{Приближение измеримых множеств борелевскими}
            $$
            \Phi(E)=\bigcup\limits_{k=1}^\infty\Phi(F_k)\cap\Phi(e)
            $$
            Где $F_k$ компактны, а $\mu e=0$. Тогда по теореме Вейерштрасса $\Phi(F_k)$ компактны, а $\Phi(e)$ измеримо по первому пункту.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Как несложно заметить из доказательства, от $\Phi$ достаточно требовать липшицевости на каждом компакте в $G$ (или, что равносильно, на каждом замкнутом кубе в $G$).
    \end{remark}
    \begin{remark}
        Здесь дыра в сюжете, пока кто-нибудь не скинет мне конспект по матану за 28 ноября.
    \end{remark}
    \begin{example}
        Непрерывности $\Phi$ не достаточно для сохранения измеримости.\\
        Построим функцию $\theta\colon[0;1]\to[0;1]$. $\theta(0)=0$, $\theta(1)=1$. Дальше на средней трети положим $\theta\equiv\frac12$. А дальше на средней трети каждого из отрезков положим $\theta$ равной среднему арифметическому значений на концах.
        \begin{figure}[H]
            \begin{tikzpicture}
                \begin{axis}[
                    width = 10cm,
                    height = 10cm,
                    grid = none,
                    xmin = -.1,
                    xmax = 1.1,
                    ymin = -.1,
                    ymax = 1.1,
                    axis equal,
                    axis x line = middle,
                    axis y line = middle,
                    axis line style = {->},
                    xtick = \empty,
                    ytick = \empty,
                    xlabel = \empty,
                    ylabel = \empty,
                    ]
                    \addplot[domain=1/3:2/3,samples=100,black]{1/2};
                    \addplot[domain=1/9:2/9,samples=100,black]{1/4};
                    \addplot[domain=7/9:8/9,samples=100,black]{3/4};
                    \addplot[domain=1/27:2/27,samples=100,black]{1/8};
                    \addplot[domain=7/27:8/27,samples=100,black]{3/8};
                    \addplot[domain=19/27:20/27,samples=100,black]{5/8};
                    \addplot[domain=25/27:26/27,samples=100,black]{7/8};
                    \node[coordinate] (A) at (axis cs:0,0) {};
                    \node[coordinate] (B) at (axis cs:1,1) {};
                \end{axis}
                \node[fill,circle] at (A) {};
                \node[fill,circle] at (B) {};
            \end{tikzpicture}
        \end{figure}\noindent
        Так мы определили функцию $\theta$ на всём, кроме (почти всего) канторова множества, ещё в область определения $\theta$ входят концы отрезков. Назовём множество, где мы определили $\theta$ за $D$.\\
        Как определить $\theta$ в оставшихся точках? Так, чтобы не испортить возрастание.
        $$
        \theta(x)=\sup\limits_{\substack{t<x\\t\in D}}\theta(t)
        $$
        Почему $\theta$ непрерывна на $[0;1]$? Ну, $\theta([0;1])\subset\left\{\frac k{2^m}\right\}_{k,m\in\mathbb Z_+}\cap[0;1]$. А монотонная функция на промежутке не имеет разрывов второго рода. А множество значений $\phi$ плотно в $[0;1]$, и из этого монотонности следует $\theta([0;1])=[0;1]$. Монотонная на промежутке функция непрерывна тогда и только тогда, когда множество её значений~--- промежуток.\\
        Однако у этой функции образ канторова множества равен $[0;1]$. Мера Лебега канторова множества равна нулю, а мера $[0;1]$~--- нет.
    \end{example}
    \begin{example}
        Если канторову функцию немного починить, получится гомеоморфизм.
        $$
        g(x)=\theta(x)+x
        $$
        Она уже не просто непрерывна, но возрастает строго, а значит гомеоморфизм между $[0;1]$ и $[0;2]$. Но посмотрим, куда переходит канторово множество. Ну, посмотрим: на интервалах, которые мы строили, $\theta(x)$ постоянна, а значит $g$ переводит такие интервалы в интервалы той же длины. А значит мера $g$ от дополнения Канторова множества равна 1. Следовательно и мера $g$ от самого канторова множества также равно 1, потому что множество значений $g$ имеет меру 2.
    \end{example}
    \begin{claim}
        Гомеоморфизм сохраняет измеримость по Борелю.\\
        Без доказательства.
    \end{claim}
    \begin{lemma}
        Пусть $\nu$~--- мера на $\mathbb A_n$ (на той же $\sigma$-алгебре, что и мера Лебега). Пусть $c\in[0;+\infty)$~--- такое число, что для любой кубической ячейки $\Delta$ $\nu\Delta=c\mu\Delta$. Тогда $\forall E\in\mathbb A_n~\nu E=c\mu E$.
    \end{lemma}
    \begin{proof}
        Если $c=0$, тривиально, иначе поделим на $c$, получим новую меру на той же $\sigma$-алгебре, которая на ячейках совпадает с мерой Лебега. Это же теорема о единственности стандартного продолжения. Но подождите, мы же его не доказывали...
    \end{proof}
    \begin{proof}
        Будем постепенно усложнять множество.
        \begin{enumerate}
            \item Пусть $G$ открыто. Тогда оно представимо в виде дизъюнктного объединения кубических ячеек.
            $$
            G=\bigsqcup\limits_k\Delta_k
            $$
            Тогда
            $$
            \nu G=\sum\limits_k\nu\Delta_k=\sum\limits_kc\mu\Delta_k=c\sum\limits_k\mu\Delta_k=c\mu G
            $$
            \item Пусть $F$ компакт. $\exists B$~--- такой открытый шар, что $F\subset B$. Шар открыт, $F$ замкнуто, значит $B\setminus F$ открыто. Мера обоих множеств $B$ и $B\setminus F$ конечна (обе меры).
            $$
            \nu F=\nu B-\nu(B\setminus F)=c\mu B-c\mu(B\setminus F)=c\mu F
            $$
            \item Пусть $\mu e=0$, докажем, что $\nu e=0$. По регулярности меры Лебега
            $$
            \forall\eps>0~\exists g\supset e\text{ открыто}~\mu g<\eps
            $$
            Тогда $\nu e\leqslant\nu g=c\mu g<c\eps$. Устремляя $\eps$ к нулю, получим искомое.
            \item Общий случай получаем по \hyperref[Структура произвольного измеримого множества]{формуле о структуре произвольного измеримого множества}.
            $$
            E=\bigcup\limits_{k=1}^\infty F_k\cap e
            $$
            Где $F_k$~--- такие компактные множества, что $F_k\subset F_{k+1}$, $\mu e=0$. Тогда
            $$
            \nu E=\lim\limits_{N\to\infty}\nu F_k=\lim\limits_{N\to\infty}c\mu F_k=c\mu E
            $$
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        Пусть $\Phi\colon\mathbb R^n\to\mathbb R^n$ обратимо и переводит измеримое множество в измеримое. Пусть $c\in[0;+\infty)$, $\forall\Delta$~--- кубическая ячейка $\mu\Phi(\Delta)=c\mu\Delta$. Тогда
        $$
        \forall E=\in\mathbb A_n~\mu\Phi(E)=c\mu E
        $$
    \end{corollary}
    \begin{proof}
        Ну так лол, пусть $\nu E=\mu\Phi E$, остаётся лишь проверить, что $\nu$~--- мера.
        \begin{enumerate}
            \item $\nu\varnothing=0$ тривиально.
            \item $E=\bigsqcup\limits_k E_k$ где $E_k\in\mathbb A_n$. Тогда
            $$
            \nu E=\mu\Phi E=\mu\bigsqcup\limits_k\Phi E_k=\sum\limits_k\mu\Phi E_k=\sum\limits_k\nu E_k
            $$
            Почему $\Phi E_k$ дизъюнктны? Ну, по обратимости $\Phi$.
        \end{enumerate}
    \end{proof}
    \begin{definition}
        Пусть $v\in\mathbb R^n$, тогда
        $$
        T_v\colon\substack{\mathbb R^n\to\mathbb R^n\\x\mapsto x+v}
        $$
        называется \textbf{сдвигом}. $T_v(E)$ также обозначается $E+v$.
    \end{definition}
    \begin{corollary}
        \label{Инвариантность меры Лебега относительно сдвига}
        Мера Лебега инвариантна относительно сдвига:
        $$
        \forall E\in\mathbb A_n~\forall v\in\mathbb R^n~\mu E=\mu(E+v)
        $$
    \end{corollary}
    \begin{theorem}[Описание мер, инвариантных относительно сдвига]
        \label{Меры, инвариантные относительно сдвига}
        Пусть $\nu$~--- инвариантная относительно сдвига мера на $\mathbb A_n$ и мера каждой ячейки конечна. Тогда $\exists c\in[0;+\infty)~\nu\equiv c\mu$.
    \end{theorem}
    \begin{proof}
        Пусть $c=\nu[\mathbb0;\mathbb1)$. То есть на единичной ячейке это равенство выполняется, надо доказать для всех остальных множеств.
        \begin{enumerate}
            \item Сначала положим $c=1$. Тогда нам надо доказать, что $\nu\equiv\mu$.
            \begin{enumerate}
                \item Сначала докажем это на кубических ячейках ребра $\frac1N$. Ну, из-за инвариантности относительно сдвига все они имеют одинаковую меру, а $N^n$ ячеек образуют в дизъюнктном объединении единичную ячейку. Отсюда мера каждой маленькой ячейки равна $\frac1{N^n}$ для обеих мер.
                \item Раз так, меры любой ячейки с рациональными координатами совпадают.
                \item А значит $\mu$ и $\nu$ совпадают на всех ячейках по непрерывности меры (обеих мер).
                \item По лемме $\nu\equiv\mu$.
            \end{enumerate}
            \item Если $c>0$, положим $\tilde\nu=\frac\nu c$, тогда по первому пункту $\tilde\nu\equiv\mu$.
            \item $c=0$ тривиально: $\nu\equiv0$ на всех ячейках, а значит просто тождественна равна нулю.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Если $\nu$~--- инвариантная относительно сдвига мера на $\sigma$-алгебре $\mathbb A'$ такой что $\mathbb P_n\subset\mathbb A'\subset\mathbb A_n$ и $\nu\equiv c\mu\big|_{\mathbb A'}$, то следствие теоремы также верно.
    \end{remark}
    \begin{remark}
        Условие конечности на ячейках нельзя опустить (считающая мера~--- контрпример).
    \end{remark}
    \begin{theorem}
        Всякое множество положительной меры имеет неизмеримое подмножество.
    \end{theorem}
    \begin{proof}
        Пусть $\mu A>0$. Не умаляя общности можно считать $A$ лежащем в некотором шаре (у $A$ найдётся ограниченная часть положительной меры т.к. $\mu A=\lim\limits_{R\to\infty}A\cap B(\mathbb 0,R)$). Тогда $\mu A<+\infty$. Обозначим радиус этого шара за $R$.\\
        Введём на $A$ отношение эквивалентности:
        $$
        x\sim y\Leftrightarrow x-y\in\mathbb Q^n
        $$
        Возьмём из каждого класса эквивалентности по одному элементу. Они образуют некое множество $E\subset A$. Оно искомое. Докажем его неизмеримость. Для этого поймём некоторые свойства $E$.
        $$
        \{E+r\}_{r\in\mathbb Q^n}\text{ дизъюнктны}
        $$
        Очевидно.\\
        Также заметим, что
        $$
        A\subset\bigsqcup\limits_{\substack{r\in\mathbb Q^n\\|r|<2R}}E+r=W
        $$
        Возьмём $x\in A$, тогда $\exists y\in E~y\sim x$. Тогда $x-y=r\in\mathbb Q^n$. Также $|r|<2R$, а значит вот оно, искомое $r$, что $x\in E+r$, отсюда $x\in W$\\
        Теперь предположим, что $E$ измеримо. Тогда все $E+r$ измеримы и имеют ту же меру. Заметим также, что $W$ тоже измеримо как счётное объединение измеримых. Более того, $W\subset B(\mathbb 0;3R)$, а значит мера его конечна. И положительна так как $W\supset A$. Что ж.
        $$
        \mu W=\sum\limits_{\substack{r\in\mathbb Q^n\\|r|<2R}}\mu(E+r)=\sum\limits_{\substack{r\in\mathbb Q^n\\|r|<2R}}\mu E
        $$
        Подождите-ка, тут сумма бесконечного количества одного и того же. Это либо ноль, либо бесконечность. Противоречие.
    \end{proof}
    \begin{remark}
        Не существует меры, которая инвариантна относительно сдвига, конечна на ячейках и задана на всех подмножествах $\mathbb R^n$.\\
        С. Банах: Если отказаться от счётной аддитивности (требовать только конечной), то объём со искомыми свойствами существует, но не единственный (даже если постановить $v[\mathbb0;\mathbb1)=1$).\\
        Но на самом деле $\mathbb A_n$ содержит все <<хорошие>> множества. Вы не найдёте неизмеримые множества, если целенаправленно не будете их искать. У вас просто нет мотивации приписывать меру всем множествам, неизмеримым по Лебегу.
    \end{remark}
    \begin{claim}
        Мера Лебега инвариантна относительно движений.
    \end{claim}
    \begin{proof}
        
    \end{proof}
    \begin{remark}
        С. Банах: при $n=1$ и $n=2$ существует объём, измеряющий все подмножества $\mathbb R^n$, равный единице на единичной ячейке и инвариантный относительно движений (опять же, не единственный).\\
        Ф. Хаусдорф: при $n\geqslant 3$ такого объёма не существует.\\
        Почему так? Потому что в $\mathbb R^3$ разных движений слишком много бывает, чтобы всё было хорошо.
    \end{remark}
    \begin{remark}
        Помните наше наивное определение объёма? Там ещё был непонятный термин <<квадрируемые множества>>. Так вот, пожалуйста, мы построили сейчас то, что хотели.\\
        Хотя на самом деле математики во времена до Лебега имели ввиду не его меру, а, скорее, меру Жордана: множество измеримо, если его можно приблизить снаружи и изнутри \textbf{конечным} объединением многогранников. Это даже мера получается, правда задана она только не полукольце, а не $\sigma$-алгебре, но если расширить, получится мера Лебега. Есть даже теорема о том, что множество измеримо по Жордану тогда и только тогда, когда его граница имеет нулевую меру Лебега.
    \end{remark}
    \begin{theorem}[Мера Лебега при линейном отображении]
        \label{Мера Лебега при линейном отображении}
        \label{Теорема о геометрическом смысле определителя}
        Пусть $\scriptA$~--- линейный оператор в $\mathbb R^n$. Тогда
        $$\forall E\in\mathbb A_n~\mu\scriptA(E)=|\det\scriptA|\mu E$$
    \end{theorem}
    \begin{proof}
        Для начала, заметим, что $\scriptA$~--- гладкое отображение, а значит оно переводит измеримые множества в измеримые.\\
        Пусть $\nu E=\mu\scriptA(E)$.
        \begin{enumerate}
            \item Первый случай: $\det\scriptA\neq0$. В силу обратимости $\scriptA$ $\nu$~--- мера, причём инвариантная относительно сдвига:
            $$
            \scriptA(E+v)=\scriptA(E)+\scriptA v
            $$
            А мера Лебега инвариантна относительно сдвига на $\scriptA v$.\\
            Остаётся доказать, что $\nu$~--- конечна на ячейках и что $\nu[\mathbb0;\mathbb1)=\det\scriptA$.\\
            Теперь будем постепенно усложнять оператор $\scriptA$.
            \begin{enumerate}
                \item Пусть $\scriptA$~--- диагональный оператор с положительными собственными числами. Для него
                $$
                \scriptA[\mathbb0;\mathbb1)=\bigtimes\limits_{k=1}^n[0;\lambda_k)
                $$
                Значит $\nu[\mathbb0;\mathbb1)$ равно произведению собственных чисел т.е. $\det\scriptA$.
                \item Пусть $\scriptA=\scriptU$ ортогональный оператор. Тогда $|\det\scriptU|=1$. Поскольку ортогональный оператор сохраняет норму, он сохраняет на месте единичный шар, а значит
                $$
                \mu\scriptU(B)=\mu B
                $$
                А значит $\scriptU$ конечно на ячейках, значит $\nu$ пропорционально $\mu$. А коэффициент пропорциональности равен единице.
                \item Общий случай невырожденного оператора. Всякий невырожденный линейный оператор представим в виде
                $$\scriptA=\scriptU_1\scriptD\scriptU_2$$
                Где $\scriptU_1,\scriptU_2$ ортогональны, $\scriptD$~--- диагональный с положительными собственными числами. Отсюда следует искомое.
            \end{enumerate}
            \item А что если $\det\scriptA=0$? Тогда $\scriptA(\mathbb R^n)=L$ имеет размерность $l<n$. Докажем, что $L$ имеет нулевую меру. Тогда по полноте $\forall E\in\mathbb A_n~\mu\scriptA(E)=0$.\\
            Рассмотрим специальное подпространство $L_l=\{x\in\mathbb R^n\mid x_{l+1}=\cdots=x_n=0\}$. Его мера тривиально равна нулю т.к. $L_l$~--- вырожденный параллелепипед. При этом $L$ можно перевести в $L_l$ ортогональным преобразованием так как они имеют одинаковую размерность.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Напоминание: движение $\mathbb R^n$~--- отображение $M\colon\mathbb R^n\to\mathbb R^n$, сохраняющее расстояние.
    \end{remark}
    \begin{remark}
        Всякое движение $\mathbb R^n$ есть композиция ортогонального преобразования и сдвига.\\
        Без доказательства.
    \end{remark}
    \begin{corollary}
        Мера Лебега инвариантно относительно движений.
    \end{corollary}
    \begin{definition}
        Композиция линейного отображения и сдвига называется \textbf{аффинным отображением}. \textbf{Определитель аффинного отображения} считается равным определителю линейной части.
    \end{definition}
    \begin{corollary}
        Если $\Phi$~--- аффинное отображение, то
        $$
        \forall E\in\mathbb A_n~\mu\Phi(E)=|\det\Phi|\mu E
        $$
    \end{corollary}
    \begin{corollary}
        Если $\lambda>0$, то
        $$
        \forall E\in\mathbb A_n~\mu(\lambda E)=\lambda^n\mu E
        $$
    \end{corollary}
    \paragraph{Измеримые функции.}
    \begin{definition}
        Тройка объектов $(X;\mathbb A;\mu)$, где $\mu$~--- мера на $\mathbb A$, а $\mathbb A$~--- $\sigma$-алгебра над $X$, называется \textbf{пространством с мерой}. Элементы $\mathbb A$ называются \textbf{измеримыми множествами}.
    \end{definition}
    \begin{definition}
        Если $\scriptP(x)$~--- одноместный предикат, то $E(\scriptP)=\{x\in E\mid\scriptP(x)\}$
    \end{definition}
    \begin{definition}
        Пусть $f\colon\underset{\subset X}E\to\overline{\mathbb R}$, $a\in\mathbb R$. Множества
        $$
        E(f<a)\qquad E(f\leqslant a)\qquad E(f>a)\qquad E(f\geqslant a)
        $$
        называются \textbf{Лебеговыми множествами} функции $f$ (прообразы промежутков в $\overline{\mathbb R}$, короче).
    \end{definition}
    \begin{definition}
        $f\colon\underset{\subset X}E\to\overline{\mathbb R}$ называется \textbf{измеримой}, если $\forall a\in\mathbb A$ все её лебеговы множества (все 4 для всех $a$) измеримы.\\
        Множество функций, измеримых на $E$ обозначается $S(E)$.\\
        Если $\mathbb A=\mathbb A_n$, $f$ называется измеримой по Лебегу. Если $\mathbb A=\mathbb B_n$, то измеримой по Борелю.
    \end{definition}
    \begin{claim}
        Если $f\in S(E)$, то $E$ измеримо
    \end{claim}
    \begin{proof}
        $$
        E=E(f<+\infty)\cup E(f=+\infty)=\bigcup\limits_{n=1}^\infty E(f<n)\cup\bigcap\limits_{n=1}^\infty E(f>n)
        $$
    \end{proof}
    \begin{lemma}
        Пусть $E\in\mathbb A$, $f\colon E\to\overline{\mathbb R}$. Для измеримости $f$ достаточно измеримости всех её лебеговых множеств одного типа.
    \end{lemma}
    \begin{proof}
        $$E(f\leqslant a)=\bigcup\limits_{n=1}^\infty E\left(f<a+\frac1n\right)$$
        $$E(f>a)=E\setminus E(f\leqslant a)$$
        $$E(f\geqslant a)=\bigcap\limits_{n=1}^\infty E\left(f>a-\frac1n\right)$$
        $$E(f<a)=E\setminus E(f\geqslant a)$$
    \end{proof}
    \begin{remark}
        Условие $E\in\mathbb A$ существенно. Пример: $f\equiv+\infty$ на неизмеримом $E$. Все множества $E(f<a)$ пусты.
    \end{remark}
    \begin{property}
        $f\in S(E)\Leftrightarrow -f\in S(E)$
    \end{property}
    \begin{property}
        Постоянная функция на измеримом множестве измерима.\\
        Очевидно.
    \end{property}
    \begin{property}
        Если $f\in S(E)$, $E_1\subset E$, $E_1\in\mathbb A$, то $f\big|_{E_1}\in S(E_1)$.
    \end{property}
    \begin{proof}
        $$E_1(f<a)=E_1\cap E(f<a)$$
    \end{proof}
    \begin{property}
        Если $E=\bigcup\limits_kE_k$, $\forall k~f\in S(E_k)$, то $f\in S(E)$.
    \end{property}
    \begin{proof}
        $$
        E(f<a)=\bigcup\limits_k E_k(f<a)
        $$
    \end{proof}
    \begin{property}
        Пусть $E=\bigsqcup\limits_kE_k$, $E_k\in\mathbb A$, $f\big|_{E_k}=c_k=\mathrm{const}$. Тогда $f\in S(E)$.\\
        Из предыдущих.
    \end{property}
    \begin{remark}
        Напоминание:
        $$\chi_E(x)=\begin{cases}
            1 & x\in E\\
            0 & x\notin E
        \end{cases}$$
        $\chi_E$~--- характеристическая функция.
    \end{remark}
    \begin{property}
        $$E\in\mathbb A\Leftrightarrow\chi_E\in S(X)$$
    \end{property}
    \begin{proof}
        Слева направо из предыдущего.\\
        Обратно:
        $$
        E=X\left(\chi_E>\frac12\right)
        $$
    \end{proof}
    \begin{property}
        Если $f\in S(E)$, то прообраз любого промежутка в $\overline{\mathbb R}$ измерим.
    \end{property}
    \begin{proof}
        Для лучей мы знаем, докажем для всех остальных промежутков.
        $$
        E(f=+\infty)=\bigcap\limits_{n=1}^\infty E(f>n)\qquad E(f=-\infty)=\bigcap\limits_{n=1}^\infty E(f<-n)
        $$
        С $E(f=\mathrm{const})$ и $E(a<f<b)$ понятно, если остались какие-то ещё промежутки, переберите их сами.
    \end{proof}
    \begin{property}
        Если $f\in S(E)$, то
        $$\forall B\in\mathbb B_1~f^{-1}(B)\in\mathbb A$$
    \end{property}
    \begin{proof}
        Знаем для промежутков (в частности для ячеек). А значит знаем для открытых множеств.\\
        Рассмотрим $\mathbb D=\{B\subset\mathbb R\mid f^{-1}(B)\in\mathbb A\}$. Это, очевидно, $\sigma$-алгебра, которая содержит все открытые множества (а значит содержит борелевскую $\sigma$-алгебру т.е. борелевская~--- минимальная, содержащая все открытые множества).
    \end{proof}
    \begin{proof}
        Пусть $\mu$~--- полная мера, $\mu e=0$, $f\colon e\to\overline{\mathbb R}$. Тогда $f\in S(e)$.
    \end{proof}
    \begin{proof}
        $$
        e(f<a)\subset e
        $$
        Значит мера первого равна нулю по полноте меры.
    \end{proof}
    \begin{theorem}[Измеримость граней и пределов]
        \label{Измеримость граней и пределов}
        \mbox{}\\
        \begin{enumerate}
            \item Пусть $\{f_n\}_n\subset S(E)$. Тогда $x\mapsto\sup\limits_nf_n(x)\in S(E)$ и $x\mapsto\inf\limits_nf_n(x)\in S(E)$.
            \item Пусть $\{f_n\}_{n=1}^\infty\subset S(E)$. Тогда $x\mapsto\limsup\limits_{n\to\infty} f_n(x)\in S(E)$, $x\mapsto\liminf\limits_{n\to\infty} f_n(x)\in S(E)$.
        \end{enumerate}
        В частности, если $\forall x\in E~\exists\lim\limits_{n\to\infty}f_n(x)$, то $x\mapsto\lim\limits_{n\to\infty} f_n(x)\in S(E)$. Никакая равномерная сходимость тут не нужна.
    \end{theorem}
    \begin{proof}
        Пусть
        $$g\colon x\mapsto\sup\limits_nf_n(x)\in S(E)\qquad h\colon x\mapsto\inf\limits_nf_n(x)\in S(E)$$
        Тогда
        $$
        E(g>a)=\bigcup\limits_nE(f_n>a)\qquad E(h<a)=\bigcup\limits_nE(f_n<a)
        $$
        Теперь с пределами.
        $$
        \limsup\limits_{n\to\infty}f_n=\lim\limits_{k\to\infty}\sup\limits_{n\geqslant k}f_n=\inf\limits_k\sup\limits_{n\geqslant k}f_n
        $$
        Пользуемся первым пунктом дважды.
    \end{proof}
    \begin{definition}
        Если $f\colon E\to\overline{\mathbb R}$, то
        $$
        f_+(x)=\max\{f(x);0\}\qquad f_-(x)=\max\{-f(x);0\}
        $$
    \end{definition}
    \begin{property}
        $$
        f_+(x)=\frac{|f(x)|+f(x)}2\qquad f(x)\neq-\infty
        $$
        $$
        f_-(x)=\frac{|f(x)|-f(x)}2\qquad f(x)\neq+\infty
        $$
    \end{property}
    \begin{property}
        $$f_\pm\geqslant0\qquad f_++f_-=|f|\qquad f_+-f_-=f$$
    \end{property}
    \begin{property}
        $$f\in S(E)\Leftrightarrow f_\pm\in S(E)$$
    \end{property}
    \begin{proof}
        Слева направо по теореме \ref{Измеримость граней и пределов}, а справа налево придётся доказать.
        $$
        E(f>a)=\begin{cases}
            E(f_+>a) & a\geqslant0\\
            E(-f_->a) & a<0\\
        \end{cases}
        $$
    \end{proof}
    \begin{definition}
        Функция $\phi\colon X\to\mathbb C$ называется \textbf{ступенчатой}, если $\phi$ измерима, обладает конечным множеством значений.\\
        Функция $\phi\colon X\to\mathbb R$ называется \textbf{простой}, если $\phi$ она ступенчатая и неотрицательна.
    \end{definition}
    \begin{property}
        Очевидно, всякая простая функция может быть записана в виде
        $$
        \phi=\sum\limits_{k=1}^Nc_k\chi_{A_k}\mid c_k\in[0;+\infty)\text{ различны},A_k\in\mathbb A,\bigsqcup\limits_{k=1}^NA_k=X
        $$
        Притом единственным образом.
    \end{property}
    \begin{remark}
        Если убрать условие $c_k\in[0;+\infty)$, получатся ступенчатые функции.\\
        Если не следить за различностью $c_k$ и дизъюнктностью $A_k$, представление всё равно породит простую/ступенчатую функцию, но это представление не будет единственным.
    \end{remark}
    \begin{property}
        Если $\phi,\psi$ ступенчатые, то $\phi+\psi$, $\phi-\psi$, $\phi\psi$, $\alpha\phi$ и $|\phi|$ ступенчатые.
    \end{property}
    \begin{proof}
        Все аналогичны, докажем для суммы, например. Если
        $$
        \phi=\sum\limits_{k=1}^Nc_k\chi_{A_k}\qquad \psi=\sum\limits_{j=1}^Md_j\chi_{B_j}
        $$
        То
        $$
        \phi+\psi=\sum\limits_{k=1}^N(c_k+d_j)\chi_{A_k\cap B_j}
        $$
        тут как раз и потеряется различность и дизъюнктность, для этого и было сделано замечание выше.
    \end{proof}
    \begin{theorem}[Приближение измеримой функции простыми]
        \label{Приближение измеримой функции простыми}
        Если $f\in S(E\to[0;+\infty])$, то $\exists\{\phi_n\}_{n=1}^\infty$~--- такие простые функции, что $\phi_n\leqslant\phi_{n+1}$ и $\forall x\in E~\phi_n(x)\underset{n\to\infty}\longrightarrow f(x)$.
    \end{theorem}
    \begin{proof}
        Пусть
        $$
        E_{in}=\begin{cases}
            E\left(\frac i{2^n}\leqslant f<\frac{i+1}{2^n}\right) & i\in[0:n2^n-1]\\
            E(f\geqslant n) & i=n2^n
        \end{cases}
        $$
        % Картинка для $n=1$ TODO: pic
        Положим
        $$\phi_n=\sum\limits_{i=0}^{n2^n}\frac i{2^n}\chi_{E_{in}}$$
        Заметим, что $E_{in}\in\mathbb A$ и дизъюнктны при фиксированном $n$. А значит $\phi_n$ действительно простые функции.\\
        Проверим возрастание и поточечный предел. Для этого напишем ещё одну формулу для $\phi_n$:
        $$
        \phi_n(x)=\min\left\{\frac{\left\lfloor2^nf(x)\right\rfloor}{2^n},n\right\}
        $$
        Отсюда докажем возрастание. Достаточно доказать, что
        $$
        \frac{\left\lfloor2^{n+1}f(x)\right\rfloor}{2^{n+1}}\geqslant\frac{\left\lfloor\overbrace{2^nf(x)}^A\right\rfloor}{2^n}
        $$
        Это равносильно
        $$
        \lfloor 2A\rfloor\geqslant2\lfloor A\rfloor
        $$
        Что очевидно верно.\\
        Теперь докажем сходимость. Рассмотрим 2 случая: первый~--- $f(x)=+\infty$. Тогда $\forall n~\phi_n(x)=n\rightarrow+\infty$. Второй~--- $f(x)<+\infty$. Тогда
        $$\forall n>f(x)~\exists i\in[0:n2^n-1]~x\in E_{in}$$
        Тогда
        $$0\leqslant f(x)-\phi_n(x)<\frac1{2^n}$$
    \end{proof}
    \begin{remark}
        Что будет, если отказаться от неотрицательности функции? Функции из простых станут ступенчатыми и возрастание $\phi_n\leqslant\phi_{n+1}$. Но его можно чем-то заменить...
    \end{remark}
    \begin{corollary}[Приближение измеримой функции ступенчатыми]
        \label{Приближение измеримой функции ступенчатыми}
        Если $f\in S(E)$, то $\exists\{\psi_n\}_{n=1}^\infty$~--- такие \textbf{ступенчатые} функции, что $|\psi_n|\leqslant|f|$ и $\forall x\in E~\psi_n(x)\underset{n\to\infty}\longrightarrow f(x)$.
    \end{corollary}
    \begin{proof}
        $f=f_+-f_-$. Подберём две последовательности простых функций $\{\phi_n\}$ и $\{\varphi_n\}$, приближающих соответственно $f_+$ и $f_-$. Тогда
        $$
        \phi_n\leqslant\phi_{n+1}\qquad\varphi_n\leqslant\varphi_{n+1}\qquad\phi_n\rightarrow f_+\qquad\varphi_n\rightarrow f_-
        $$
        Если взять $\psi=\phi+\varphi$, то получим все нужные нам условия, кроме $|\psi_n|\leqslant|f|$. Ну, если $f(x)\geqslant0$, то $f(x)=f_+(x)$, а $f_-(x)=0$. Тогда
        $$
        \phi(x)\leqslant f_+(x)=|f(x)|\qquad\varphi(x)=0
        $$
        Если $f(x)<0$ аналогично.
    \end{proof}
    \begin{corollary}
        Если в условиях теоремы \ref{Приближение измеримой функции простыми} и следствия \ref{Приближение измеримой функции ступенчатыми} $f$ ограничена, то сходимость равномерна.
    \end{corollary}
    \begin{proof}
        Если в теореме \ref{Приближение измеримой функции простыми} $f(x)\leqslant M$, то неравенство
        $$0\leqslant f(x)-\phi_n(x)<\frac1{2^n}$$
        верно для всех $n>M$ и всех $x\in E$. Это и есть равномерная сходимость.\\
        Переход к ступенчатым функциям вытекает из того, что разность двух равномерно сходящихся последовательностей равномерно сходится.
    \end{proof}
    \begin{remark}
        Теорема \ref{Приближение измеримой функции простыми} и следствие \ref{Приближение измеримой функции ступенчатыми} допускают обращение (передел последовательности простых/ступенчатых функций измерим).
    \end{remark}
    \begin{remark}
        Пусть $f,g\colon E\to\overline{\mathbb R}$. Где определена $f+g$? Пусть
        $$
        e_1=E(f=+\infty)\cap E(g=-\infty)
        e_2=E(f=-\infty)\cap E(g=+\infty)
        E_1=E\setminus(e_1\cap e_2)
        $$
        Тогда $f+g\colon E_1\to\overline{\mathbb R}$.\\
        Аналогичные приколы возникают и с $f-g$:
        $$
        e'_1=E(f=+\infty)\cap E(g=+\infty)
        e'_2=E(f=-\infty)\cap E(g=-\infty)
        E'_1=E\setminus(e'_1\cap e'_2)
        $$
        Тогда $f-g\colon E'_1\to\overline{\mathbb R}$.\\
        $fg$ определено всюду на $E$ так как $0\cdot\infty=0$.\\
        С частным надо какое-то разумное доопределение. Давайте на ноль делить не будем, а $\frac\infty\infty=0$, чтобы мы могли написать $\frac fg=f\cdot\frac1g$. Тогда $\frac fg\colon E(g\neq0)\to\overline{\mathbb R}$.
    \end{remark}
    \begin{theorem}[Арифметические действия над измеримыми функциями]
        Пусть $f,g\in S(E)$, $\alpha\in\mathbb R$, $p>0$. Тогда
        \begin{enumerate}
            \item $\alpha f\in S(E)$.
            \item $|f|\in S(E)$.
            \item Если $f\geqslant 0$, то $f^p\in S(E)$.
            \item $f+g\in S(E_1)$.
            \item $f-g\in S(E'_1)$.
            \item $fg\in S(E)$.
            \item $\frac fg\in S(E(g\neq0))$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        Первые 6 утверждений доказываются одним и тем же способом. Вот, например, первое
        \begin{enumerate}
            \item Возьмём последовательность ступенчатых функций $\phi_n$, тогда $\alpha\psi_n$ сходится к $\alpha f$.
            \addtocounter{enumi}{4}
            \item Всё примерно то же самое, но у нас было доказательство произведения пределов с дополнительным условием. Так что проведём его честно:
            $$
            \psi^*_n\to f\qquad\psi^{**}_n\to g\qquad |\psi^*_n|\leqslant|f|\qquad |\psi^{**}_n|\leqslant|g|
            $$
            Тогда $\psi^*_n$ и $\psi^{**}_n$ ограничены, тогда предел произведения равен произведению пределов.
            \item Достаточно доказать для $f\equiv1$. Давайте простоты записи считать, что $g\neq0$, то есть $E(g\neq0)=E$.\\
            По определению рассмотрим лебеговы множества. Пусть $a\in\mathbb R$.
            $$
            E\left(\frac1g>a\right)=\begin{cases}
                E(g>0)\cap E\left(g<\frac1a\right) & a>0\\
                E(g>0)\cap E\left(g<+\infty\right) & a=0\\
                E(g>0)\cup E\left(g<\frac1a\right) & a<0
            \end{cases}
            $$
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        Сумма ряда измеримых функций измерима:\\
        Если $f_k\in S(E)$, $F=\sum\limits_{k=1}^\infty f_k$ существует в $\overline{\mathbb R}$, то $F\in S(E)$.
    \end{corollary}
    \begin{corollary}
        Если $f,g\in S(E)$, то множества
        $$
        E(f<g)\qquad E(f\leqslant g)\qquad E(f=g)\qquad E(f\neq g)
        $$
        измеримы.
    \end{corollary}
    \begin{proof}
        Например,
        $$E(f<g)=E(f-g<0)$$
        Ещё например,
        $$
        E(f=g)=E(f-g=0)\cup e'_1\cup e'_2
        $$
        Оставшиеся два множества тривиально из этих.
    \end{proof}
    \begin{claim}
        Композиция двух измеримых по Лебегу функций может быть не измерима, но если внутренняя функция непрерывна, то композиция измерима.\\
        Без доказательства.
    \end{claim}
    \begin{theorem}[Непрерывность и измеримость по Лебегу]
        \label{Непрерывность и измеримость по Лебегу}
        Пусть $E\in\mathbb A_n$, $f\colon E\to\overline{\mathbb R}$,
        $$\forall\eps>0~\exists E_\eps\subset E~\left\{\begin{aligned}
            &\mu(E\setminus E_\eps)<\eps\\
            &f\big|_{E_\eps}\in C(E_\eps)
        \end{aligned}\right.$$
        Тогда $f\in S(E)$.
    \end{theorem}
    \begin{proof}
        Сначала рассмотрим частный случай, когда $f\in C(E)$. Как устроены $E(f<a)$? Это прообраз открытого промежутка, а значит он открыт в $E$. То есть
        $$
        E(f<a)=E\cap G_a\mid G_a\text{ открыто в }\mathbb R^n
        $$
        Это пересечение двух измеримых, всё хорошо.\\
        Теперь общий случай. Возьмём $\eps=\frac1m\mid m\in\mathbb N$. Обозначим
        $$e_{\frac 1m}=E\setminus E_{\frac1m}$$
        Пусть
        $$e=\bigcap\limits_{m=1}^\infty e_{\frac 1m}$$
        Тогда $\mu e=0$. Теперь можно представить $E$ как
        $$
        E=\bigcup\limits_{m=1}^\infty E_{\frac1m}\cup e
        $$
        Для любого $m$ $f\in S(E_{1/m})$ по первому пункту, а на $e$ измеримо так как мера Лебега полна (а для полной меры любая функция измерима на множестве нулевой меры).
    \end{proof}
    \begin{corollary}
        Если $E\in\mathbb A_n$, $f\colon E\to\overline{\mathbb R}$, множество точек разрыва $f$ имеет нулевую меру (Лебега), то $f\in S(E)$.
    \end{corollary}
    \begin{example}
        Функция Дирихле: $\chi_{\mathbb Q}$. Она всюду разрывна, но её сужение на $\mathbb R\setminus\mathbb Q$ тождественно равно нулю, а значит функция Дирихле измерима.\\
        Эта функция обслуживается теоремой ($E_\eps\equiv\mathbb Q$), но не следствием.
    \end{example}
    \begin{definition}
        Пусть $(X;\mathbb A;\mu)$~--- пространство с мерой, $E\subset X$, $\scriptP(x)$~--- одноместный предикат на $E$. Если $\exists e\in\mathbb A:\mu e=0$ и $\forall x\in E\setminus e~\scriptP(x)$, то говорят, что $\scriptP$ \textbf{выполнено почти всюду} на $E$ относительно меры $\mu$ (также \textbf{$\mu$-почти везде выполнено}).
    \end{definition}
    \begin{remark}
        Если $\mu$~--- полная мера, то определение сокращается до <<мера множества истинности $\neg\scriptP$ равна нулю>>.
    \end{remark}
    \begin{claim}
        Представьте себе не более чем счётный набор утверждений $\{\scriptP_k\}_k$. Если каждое $\scriptP_k$ верно почти везде на $E$, то и все они одновременно почти везде на $E$.
    \end{claim}
    \begin{proof}
        Если $\scriptP_k$ верно вне $e_k$, то
        $$
        \bigwedge\limits_k\scriptP_k\text{ верно вне }\bigcup\limits_ke_k
        $$
        А мера того, что справа, равно нулю.
    \end{proof}
    \begin{definition}
        Функции называются \textbf{эквивалентными}, если они равны почти всюду.
    \end{definition}
    \begin{claim}
        Если $\mu$ полна, то эквивалентные функции либо обе измеримы, либо обе~--- нет.
    \end{claim}
    \begin{proof}
        Пусть $f,g\colon E\to\overline{\mathbb R}$, $f\sim g$.
        $$
        E=E(f=g)\cup E(f\neq g)
        $$
        Второе имеет меру ноль, $E$ измеримо, а значит и $E(f=g)\in\mathbb A$. Тогда
        $$
        g\in S(E(f=g))\text{ как равная }f\qquad g\in S(E(f\neq g))\text{ потому что множество нулевой меры}
        $$
    \end{proof}
    \begin{remark}
        Можно говорить об измеримости функций, заданных почти везде на $E$ (даже определение не поменяется).
    \end{remark}
    \begin{claim}
        Пусть $\mu$ полна, $f_n\in S(E)$, $f_n\to f$ почти везде на $E$. Тогда $f\in S(E)$.
    \end{claim}
    \begin{proof}
        Обозначим
        $$
        E_1=E\setminus E(f_n\nrightarrow f)
        $$
        Правое имеет меру ноль (значим на нём измерима $f$), $E_1$ измеримо (и на нём $f$ измеримо как предел последовательности измеримых), дальше как в утверждении выше.
    \end{proof}
    \begin{definition}
        Пусть $(X;\mathbb A;\mu)$~--- пространство с мерой, $f_n,f$ заданы почти везде на $E$, измеримы на $E$ и почти везде конечны на $E$. Говорят, что последовательность $f_n$ \textbf{сходится} к $f$ \textbf{по мере} $\mu$, если
        $$
        \forall\sigma>0~\mu E(|f_n-f|\geqslant\sigma)\underset{n\to\infty}\longrightarrow0
        $$
        Запись:
        $$
        f_n\overset\mu\longrightarrow f\,(E)
        $$
    \end{definition}
    \begin{property}[Единственность предела по мере]
        Предел по мере единственный с точностью до замены на эквивалентную.\\
        Остаётся на дом читателю.
    \end{property}
    \begin{claim}
        Поточечная сходимость и сходимость по мере не влекут друг друга.
    \end{claim}
    \begin{example}
        $\mu=\mu_1$, $E=[0;+\infty)$, $f_n=\chi_{[n;+\infty)}$. Тогда $f_n$ поточечно стремится к нулю, но не сходится по мере:
        $$
        \forall\sigma>0~\mu E(|f_n-0|\geqslant\sigma)=+\infty
        $$
    \end{example}
    \begin{example}
        Над промежутком длины 1 бесконечное количество раз проплывает промежуток длины $\frac1n$ ($n$ уменьшается).\\
        $E=[0;1)$, $\phi_{m,k}=\chi_{\left[\frac km;\frac{k+1}m\right)}$, $k\in[0:m-1]$. Если перенумеровать это одним индексом в таком порядке:
        $$
        \phi_{1,0};\phi_{2,0};\phi_{2,1};\phi_{3,0};\phi_{3,1};\phi_{3,2};\ldots
        $$
        Получим некую последовательность $f_n$. Тогда
        $$
        \mu E(\phi_{m,k}\neq0)=\frac1m\rightarrow0
        $$
        Поэтому $f_n\overset\mu\rightarrow 0$.\\
        А поточечной сходимости нет т.к. $f_n$ бесконечное количество раз принимают значения 0 и 1.
    \end{example}
    \begin{theorem}[Теорема А. Лебега]
        Если $\mu E<+\infty$, $f_n,f\in S(E)$ и конечны почти везде на $E$ и $f_n\to f$ почти везде на $E$, то $f_n\overset\mu\to f$ на $E$.\\
        Без доказательства.
    \end{theorem}
    \begin{theorem}[Теорема Ф. Рисса]
        \label{Теорема Рисса}
        Если $f_n\overset\mu\to f$ то существует подпоследовательность $f_{n_k}$, которая сходится к $f$ почти везде.\\
        Без доказательства.
    \end{theorem}
    \begin{theorem}[C-свойство Лузина]
        \label{C-свойство Лузина}
        Пусть $E\in\mathbb A_n$, $f\colon E\to\overline{\mathbb R}$ измерима и почти везде конечна. Тогда
        $$
        \forall\eps>0~\exists\varphi_\eps\in C(\mathbb R^n)~\mu E(f\neq\varphi_\eps)<\eps
        $$
        Без доказательства.
    \end{theorem}
    \paragraph{Интеграл по мере.}
    \begin{definition}
        Пусть $(X;\mathbb A;\mu)$~--- пространство с мерой, $E\in\mathbb A$.\\
        \textbf{Интегралом простой функции} $f=\sum\limits_{k=1}^Nc_k\chi_{A_k}$, $A_k\in\mathbb A$ дизъюнктны, $c_k\in[0;+\infty)$ называется
        $$\int_E f~\mathrm d\mu=\sum\limits_{k=1}^Nc_k\mu(A_k\cap E)$$
        \textbf{Интегралом измеримой неотрицательной} функции $f$ называется
        $$
        \int_E f~\mathrm d\mu=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E}}\int_E\phi~\mathrm d\mu
        $$
        \textbf{Интегралом произвольной измеримой функции} $f$ называется
        $$
        \int_Ef~\mathrm d\mu=\int_Ef_+~\mathrm d\mu-\int_Ef_-~\mathrm d\mu
        $$
        Если хотя бы один из интегралов в правой части конечен. Иначе говорим, что $f$ интеграла не имеет.\\
        Если $\int_Ef~\mathrm d\mu$ конечен, $f$ называется \textbf{суммируемой} на $E$ \textbf{по мере} $\mu$.\\
        Класс суммируемых функций обозначается $L(E,\mu)$. Интеграл по мере также обозначается
        $$
        \int_E f(x)~\mathrm\mu(x)\qquad\int_E f(x)~\mu(\mathrm dx)
        $$
        Если мера фиксирована, то её иногда не пишут.
    \end{definition}
    \begin{remark}
        Доказательство корректности будет дано потом.
    \end{remark}
    \begin{claim}
        Функция суммируема тогда и только тогда, когда конечны интегралы от её левой и правой части.
    \end{claim}
    \begin{theorem}[Монотонность интеграла по функции]
        \label{Монотонность интеграла по мере по функции}
        Если $f,g\in S(E)$ и $\exists\int f,\int g$ и $f\leqslant g$, то $\int_E f~\mathrm d\mu\leqslant\int_E g~\mathrm d\mu$.
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item Пусть $f,g$ простые.
            $$
            f=\sum\limits_{k=1}^Nc_k\chi_{A_k}\qquad g=\sum\limits_{i=1}^Md_i\chi_{B_i}
            $$
            Н.У.О. пусть $\bigcap\limits_k A_k=X=\bigcap\limits_i A_i$ (иначе добавим нулевые слагаемые).\\
            Пусть $D_{ki}=A_k\cap B_i\in\mathbb A$ и дизъюнктны. Тогда
            $$
            \int_E f~\mathrm d\mu=\sum\limits_k c_k\mu(A_k\cap E)=\sum\limits_k c_k\mu\left(\bigcup\limits_i(D_{ki}\cap E)\right)=\sum\limits_{k,i} c_k\mu(D_{ki}\cap E)
            $$
            Аналогично
            $$
            \int_E g~\mathrm d\mu=\sum\limits_{k,i} d_i\mu(D_{ki}\cap E)
            $$
            Рассмотрим такое $D_{ki}$, то $\mu(D_{ki}\cap E)>0$. Тогда в $D_{ki}\cap E$ есть хоть один элемент $x$, а значит $c_k=f(x)\leqslant g(x)=d_i$. А если $\mu(D_{ki}\cap E)=0$, то не важно, что умножать на ноль. Отсюда одна сумма меньше другой.
            \item Теперь пусть $f,g$ неотрицательны. Ну, интегралы $f$ и $g$~--- это супремумы следующих множеств
            $$
            \left\{\int_E\phi\mid\phi\leqslant f\text{ на }E,\phi\text{ простая}\right\}\qquad\left\{\int_E\phi\mid\phi\leqslant g\text{ на }E,\phi\text{ простая}\right\}
            $$
            Ну, первое включено во второе, а значит супремум первого не больше супремума второго.
            \item
            $$
            f\leqslant g\Leftrightarrow f_+\leqslant g_+\land f_-\geqslant g_-
            $$
            Запишем неравенства справа для интегралов, вычтем одно неравенство из другого.
        \end{enumerate}
    \end{proof}
    \begin{theorem}[Определение интеграла по мере корректно]
        \begin{enumerate}
            \item Выбор $c_k$ в пункте 1 не влияет на значение интеграла.
            \item Интеграл в смысле пункта 2 для простой функции совпадает с интегралом в смысле 1.
            \item Интеграл в смысле пункта 3 для простой функции совпадает с интегралом в смысле 2.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        Первое мы уже доказали выше. Второе и третье докажем сейчас. Возьмём простую функцию $f$. Поскольку $f\leqslant f$ интеграл в смысле 1 не больше интеграла в смысле 2. Также для любой простой $\varphi\leqslant f$ на $E$ $\int_E f\leqslant \int_E f$ (оба интеграла в смысле 1). Перейдя к супремуму, получим, что интеграл в смысле 1 не меньше интеграла в смысле 2.\\
        Теперь к третьему, но там всё понятно, $f=f_+$.
    \end{proof}
    \begin{lemma}
        \label{Добавление нулей в интеграл по мере}
        Пусть $f\in S(E)$, $E_1\subset E$, $E_1\in\mathbb A$. Пусть $f=0$ на $E\setminus E_1$. Тогда
        $$
        \int_E f~\mathrm d\mu=\int_{E_1} f~\mathrm d\mu
        $$
        Интегралы в левой и правой части одновременно существуют или нет, и если существуют, то равны.
    \end{lemma}
    \begin{proof}
        \begin{enumerate}
            \item Пусть $f=\sum\limits_{k=1}^Nc_k\chi_{A_k}$, $A_k\in\mathbb A$ дизъюнктны, $c_k\in[0;+\infty)$.
            $$
            \int_E f~\mathrm d\mu=\sum\limits_k c_k\mu(A_k\cap E)
            $$
            Если $c_k\neq0$, то $A_k\cap (E\setminus E_1)=\varnothing$. Тем самым $\mu(A_k\cap E)=\mu(A_k\cap E_1)$. Отсюда равны интегралы.
            \item Если $f$ неотрицательна.
            $$
            \int_E f=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E}}\int_E\phi~\mathrm d\mu
            $$
            На множестве $E\setminus E_1$ $f$ равна нулю, а значит и $\phi$ должны обнулиться.
            $$
            \int_E f~\mathrm d\mu=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E}}\int_E\phi~\mathrm d\mu=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E\\\phi(x)\equiv0\text{ на }E\setminus E_1}}\int_E\phi~\mathrm d\mu=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E\\\phi(x)\equiv0\text{ на }E\setminus E_1}}\int_{E_1}\phi~\mathrm d\mu=\sup\limits_{\substack{\phi\text{ простая}\\\phi\leqslant f\text{ на }E_1}}\int_{E_1}\phi~\mathrm d\mu=\int_{E_1}f~\mathrm d\mu
            $$
            \item $f$ произвольная~--- вычтите из одного равенства другое.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Можно интегрировать функции, заданные на $X$ (доопределить $f$ нулём вне $E$).
    \end{remark}
    \begin{corollary}[Монотонность интеграла по множеству]
        \label{Монотонность интеграла по мере по множеству}
        Пусть $f\in S(E)$, $f\geqslant 0$, $E_1\subset E$, $E_1\in\mathbb A$. Тогда
        $$
        \int_{E_1}f~\mathrm d\mu\leqslant\int_Ef~\mathrm d\mu
        $$
    \end{corollary}
    \begin{proof}
        $$
        f\chi_{E_1}\leqslant f\chi_E
        $$
        Тогда
        $$
        \int_{E_1} f\overset{\ref{Добавление нулей в интеграл по мере}}=\int_Ef\chi_{E_1}\overset{\ref{Монотонность интеграла по мере по функции}}\leqslant\int_Ef\chi_E=\int_Ef
        $$
    \end{proof}
    \begin{corollary}
        $f\in L(E;\mu)$, $E_1\subset E$, $E_1\in\mathbb A$. Тогда $f\in L(E_1;\mu)$.
    \end{corollary}
    \begin{proof}
        $$
        \int_{E_1}f_\pm~\mathrm d\mu\leqslant\int_E f_\pm~\mathrm d\mu<+\infty
        $$
    \end{proof}
    \begin{theorem}[Теорема Л\'{е}ви]
        \label{Теорема Леви}
        Пусть $f_n\geqslant 0$, $f_n\in S(E)$, $f_n\leqslant f_{n+1}$. Пусть $f=\lim\limits_{n\to\infty} f_n$. Тогда
        $$
        \int_Ef_n~\mathrm d\mu\underset{n\to\infty}\longrightarrow\int_Ef~\mathrm d\mu
        $$
    \end{theorem}
    \begin{proof}
        $f\in S(E)$, $f\geqslant 0$, значит интеграл имеет смысл (интеграл от неотрицательной измеримой функции всегда существует).\\
        Из $f_n\leqslant f$ имеем $\int_E f_n\leqslant \int_Ef$, а из $f_n\leqslant f_{n+1}$~--- $\int_E f_n\leqslant \int_Ef_{n+1}$. Из второго $\exists\lim\int_Ef_n=\alpha\in[0;+\infty]$. Из первого $\alpha\leqslant\int_Ef$.\\
        Надо доказать обратное неравенство. Докажем его с точностью до множителя меньше единицы. Пусть $q\in(0;1)$. Рассмотрим произвольную просту функцию $\phi\leqslant f$ на $E$. Пусть $E_n=E(f_n\geqslant q\phi)$. Тогда $E_n\subset E_{n+1}$ (по возрастаемости $f_n$). Во-вторых, $E_n\in\mathbb A$. Проверим, что $\bigcup\limits_{n=1}^\infty E_n=E$. Очевидно включение левого в правое, а обратно?\\
        Пусть $x\in E$. Если $\phi(x)=0$, то $\forall n~x\in E_n$. Если $\phi(x)>0$, то $q\phi(x)<\phi(x)\leqslant f(x)=\lim f_n(x)$. По определению предела начиная с некоторого номера $f_n(x)$ будет больше $q\phi(x)$.\\
        Включение доказали, теперь
        $$
        \int_Ef_n\overset{\ref{Монотонность интеграла по мере по множеству}}\geqslant\int_{E_n}f_n\overset{\ref{Монотонность интеграла по мере по функции}}\geqslant\int_{E_n}q\phi=\sum\limits_kqc_k\mu(A_k\cap E_n)
        $$
        Устремим $n$ к бесконечности. Предел в левой части~--- $\alpha$. Предел в правой части равен $\mu(A_k\cap E)$ так как $A_k\cap E_n\subset A_k\cap E_{n+1}$, а значит предел равен объединению:
        $$
        \alpha\geqslant q\int_E\phi
        $$
        Остаётся устремить $q$ у единице.
    \end{proof}
    \begin{lemma}
        Пусть $E,E_1\in\mathbb A$, $E_1\subset E$, $\mu(E\subset E_1)=0$. Пусть $f\in S(E)$. Тогда 
        $$
        \int_{E_1}f~\mathrm d\mu=\int_Ef~\mathrm d\mu
        $$
        Интегралы одновременно существуют или нет, если существуют, то равны.
    \end{lemma}
    \begin{proof}
        \begin{enumerate}
            \item Пусть $f$ простая:
            $$
            f=\sum\limits_kc_k\chi_{A_k}
            $$
            Тогда
            $$
            \int_Ef=\sum\limits_kc_k\mu(A_k\cap E)=\sum\limits_kc_k\mu(A_k\cap E_1)=\int_{E_1}f
            $$
            \item Пусть $f$ неотрицательная. Тогда искомое очевидно следует из \hyperref[Теорема Леви]{теоремы Леви}.
            \item Очевидно.
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Если $\mu$ полная, то можно требовать $f\colon E\to\overline{\mathbb R}$, $f\in S(E_1)$ (т.к. отсюда следует $f\in S(E)$).
    \end{remark}
    \begin{corollary}
        Если $\mu e=0$, $f\in S(e)$, то $\int_ef~\mathrm d\mu=0$. Если мера $\mu$ полная, то $f\in S(e)$ можно не требовать (это и так всегда верно).
    \end{corollary}
    \begin{remark}
        Можно интегрировать функции, заданные почти всюду на $E$.
    \end{remark}
    \begin{definition}
        Пусть $E\in\mathbb A$, $f\colon E_1\to\overline{\mathbb R}$, $f\in S(E_1)$, $E_1\subset E$, $\mu(E\subset E_1)=0$. Тогда $f$ называется \textbf{измеримой} на $E$ в \textbf{широком смысле}.\\
        $$
        \int_Ef~\mathrm d\mu\overset{\mathrm{def}}=\int_{E_1}f~\mathrm d\mu
        $$
        Если последний существует.
    \end{definition}
    \begin{corollary}
        Если $f\sim g$, $f,g\in S(E)$, то
        $$
        \int_Ef~\mathrm d\mu=\int_Eg~\mathrm d\mu
        $$
        Как обычно, интегралы существуют или нет одновременно, в первом случае равны.
    \end{corollary}
    \begin{proof}
        $$
        \int_Ef~\mathrm d\mu=\int_{\underbrace{E(f=g)}_{\in\mathbb A}}f~\mathrm d\mu=\int_{E(f=g)}g~\mathrm d\mu=\int_Eg~\mathrm d\mu
        $$
    \end{proof}
    \begin{theorem}[Однородность интеграла]
        Пусть $E$ измеримо, $f\colon E\to\overline{\mathbb R}$, $\alpha\in\mathbb R$, существует $\int_E f~\mathrm d\mu$. Тогда
        $$
        \exists \int_E \alpha f~\mathrm d\mu=\alpha\int_E f~\mathrm d\mu
        $$
    \end{theorem}
    \begin{proof}
        Если $\alpha=0$, доказывать нечего. Иначе докажем теорему при $\alpha>0$ и при $\alpha<0$.
        \begin{enumerate}
            \item $\alpha>0$.
            \begin{enumerate}
                \item $f$ простая:
                $$
                f=\sum\limits_kc_k\chi_{A_k}
                $$
                Тогда $\alpha f$ тоже простая
                $$
                \alpha f=\sum\limits_k\alpha c_k\chi_{A_k}
                $$
                Равенство интегралов очевидно следует, поскольку мы умеем выносить константу за знак суммы.
                \item $f$ неотрицательная. Тогда существуют $\phi_n$ простые, что $\phi_n\uparrow f$, а значит $\alpha \phi_n\uparrow\alpha f$. При этом
                $$
                \int_E\alpha\psi_n~\mathrm d\mu=\alpha\int_E\psi_n~\mathrm d\mu
                $$
                Из предыдущего.\\
                Тогда устремим $n$ у бесконечности, получим требуемое по \hyperref[Теорема Леви]{теореме Леви}.
                \item Общий случай
                $$
                (\alpha f)_+=\alpha f_+\qquad (\alpha f)_-=\alpha f_-
                $$
                Дальше понятно.
            \end{enumerate}
            \item Поскольку положительное мы выносить умеем, остаётся научиться выносить $-1$.\\
            Заметим, что
            $$
            (-f)_+=\max\{-f;0\}=f_-\qquad (-f)_-=\max\{f;0\}=f_+
            $$
            Отсюда всё ясно.
        \end{enumerate}
    \end{proof}
    \begin{theorem}[Аддитивность интеграла по функции]
        \label{Аддитивность интеграла по функции}
        Пусть $f,g\colon E\to\overline{\mathbb R}$, $\exists\int_E f~\mathrm d\mu,\int_E g~\mathrm d\mu$ и не обращаются в бесконечности разных знаков. Тогда
        $$
        \exists \int_E f+g~\mathrm d\mu=\int_E f~\mathrm d\mu+\int_E g~\mathrm d\mu
        $$
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item $f,g$ простые.
            $$
            f=\sum\limits_kc_k\chi_{A_k}\qquad g=\sum\limits_id_i\chi_{B_i}
            $$
            $$
            c_k,d_i\in[0;+\infty)\qquad A_k,B_i\text{ дизъюнктны}\qquad A_k,B_i\in\mathbb A
            $$
            Можно считать, что $\bigsqcup\limits_kA_k=\bigsqcup\limits_iB_i=E$ (иначе добавим нулевые слагаемые). Пусть $D_{k,i}=A_k\cap B_i$, тогда $D_{k,i}$ измеримы и дизъюнктны,
            $$
            \bigsqcup\limits_kD_{k,i}=B_i\qquad \bigsqcup\limits_iD_{k,i}=A_k
            $$
            Отсюда
            $$
            \int_Ef=\sum\limits_kc_k\mu A_k=\sum\limits_{k,i}c_k\mu D_{k,i}\qquad \int_Eg=\sum\limits_id_i\mu B_i=\sum\limits_{k,i}d_i\mu D_{k,i}
            $$
            $$
            \int_Ef+g=\sum\limits_{k,i}(c_k+d_i)\mu D_{k,i}
            $$
            \item $f,g\geqslant0$. Пусть $\phi_n\uparrow f,\psi_n\uparrow g$, тогда $\phi_n+\psi_n\uparrow f+g$ и опять из \hyperref[Теорема Леви]{теоремы Леви} следует то, что мы хотим.
            \item Пусть $h=f+g$. Пусть $h$ задано на
            $$
            E_1=E\setminus(e_1\cup e_2)\qquad e_1=E(f=+\infty)\cap E(g=-\infty),e_2=E(f=-\infty)\cap E(g=+\infty)
            $$
            Докажем, что $h$ определена почти везде (т.е. $\mu e_1=\mu e_2=0$). Докажем для $e_1$, для $e_2$ аналогично. Докажем от противного. Пусть $\mu e_1>0$. Тогда
            $$
            \int_E f_+\geqslant\int_{e_1}f_+=+\infty
            $$
            Аналогично
            $$
            \int_E g_-=+\infty
            $$
            Тогда из определения интеграла $\int_E f_-$ и $\int_E g_+$ конечны, а значит
            $$
            \int_E g=+\infty\qquad \int_E g=-\infty
            $$
            Противоречие с условием теоремы.\\
            То есть $h$ задана почти всюду на $E$, и интегрировать её на $E$ можно. Тогда
            $$h=h_+-h_-=f_++g_+-f_--g_-$$
            \textit{Это равенство не надо понимать так, что $h_-=f_-+g_-$, это в общем случае неправда.} Но
            $$
            h_+\leqslant f_++g_+\qquad f_-\leqslant f_-+f_-
            $$
            По определению ${(\cdot)}_+$ и ${(\cdot)}_-$:
            $$
            h_+=\max\{f+g;0\}\leqslant\max\{f;0\}+\max\{g;0\}=f_++g_+
            $$
            Докажем, что $h_++f_-+g_-=f_++g_++h_-$. Будем рассуждать поточечно.
            $$
            f_-+g_-<+\infty\Rightarrow h_-<+\infty\text{, значит можно переносить члены}
            $$
            $$
            f_-+g_-=+\infty\Rightarrow h_+=+\infty\text{ и равенство верно}
            $$
            Очень хорошо, тогда
            $$
            \int_Eh_++\int_Ef_-+\int_Eg_-=\int_Ef_++\int_Eg_++\int_Eh_-
            $$
            Хочется перенести члены вида $\int_E{(\cdot)}_-$ в другую сторону. Тогда получим то, что нам надо.\\
            Ну,
            $$
            \int_Ef_-+\int_Eg_-<+\infty\overset{h_-\leqslant f_-+g_-}\Longrightarrow\int_E h_-<+\infty\text{, значит можно переносить члены}
            $$
            А если $\int_E f_-+\int_Eg_-$ бесконечен, то хотя бы один из этих двух интегралов бесконечен (пусть $\int_Ef_-\infty$, тогда $\int_Ef_+<+\infty$). Поскольку существует сумма интегралов $f$ и $g$, $\inf_Eg<+\infty$, а значит $\int_Eg_+<+\infty$. Отсюда по неравенству $h_+\leqslant f_++g_+$ $\int_Eh_+<+\infty$, а также из изначального равенства $\int_E h_-=+\infty$, а неравенство с перенесёнными слагаемыми верно.
        \end{enumerate}
    \end{proof}
    \begin{corollary}[Теорема Леви для рядов]
        \label{Теорема Леви для рядов}
        Ряд неотрицательных измеримых функций можно интегрировать почленно.
    \end{corollary}
    \begin{proof}
        Пусть $f_k\in S(E)$, $f_k\geqslant0$. Тогда
        $$
        \sum\limits_{k=1}^n\int_Ef_k=\int_E\sum\limits_{k=1}^nf_k
        $$
        Поскольку суммы неотрицательны, $\int_E\sum\limits_{k=1}^nf_k\uparrow\int_E\sum\limits_{k=1}^\infty f_k$, а значит по \hyperref[Теорема Леви]{теореме Леви}
        $$
        \lim\limits_{n\to\infty}\int_E\sum\limits_{k=1}^nf_k=\int_E\sum\limits_{k=1}^\infty f_k
        $$
        А
        $$
        \lim\limits_{n\to\infty}\sum\limits_{k=1}^n\int_Ef_k\overset{\mathrm{def}}=\sum\limits_{k=1}^\infty\int_Ef_k
        $$
    \end{proof}
    \begin{corollary}[Суммируемость функции и её модуля]
        \begin{enumerate}
            \item Суммируемость $f$ и $|f|$ равносильны.
            \item Если $\exists\int_E f~\mathrm d\mu$, то
            $$
            \left|\int_E f~\mathrm d\mu\right|\leqslant\int_E |f|~\mathrm d\mu
            $$
        \end{enumerate}
    \end{corollary}
    \begin{proof}
        \begin{enumerate}
            \item Поскольку $f\in L(E;\mu)$, $f_\pm\in L(E;\mu)$, а значит $|f|\in L(E;\mu)$. То что $|f|\in S(E)$.
            \item
            $$
            \left|\int_E f\right|=\left|\int_E f_+-\int_Ef_-\right|\leqslant\int_E f_++\int_Ef_-=\int_E|f|
            $$
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        Пусть $f\in S(E)$, $\Phi\in L(E;\mu)$, $|f|<\Phi$ почти везде. Тогда $f\in L(E;\mu)$
    \end{corollary}
    \begin{proof}
        $$
        \int_E|f|\leqslant\int_E\Phi<+\infty
        $$
    \end{proof}
    \begin{corollary}
        Ограниченная измеримая функция на множестве конечной меры суммируема.
    \end{corollary}
    \begin{lemma}[Неравенство Чебышёва]
        \label{Неравенство Чебышёва}
        Пусть $f\in L(E;\mu)$, $t\in(0;+\infty)$. Тогда
        $$
        \mu E(|f|\geqslant t)\leqslant\frac1t\int_E|f|~\mathrm d\mu
        $$
    \end{lemma}
    \begin{proof}
        $$
        \int_E|f|~\mathrm d\mu\geqslant\int_{E(|f|\geqslant t)}|f|~\mathrm d\mu\geqslant\int_{E(|f|\geqslant t)}t~\mathrm d\mu=t\mu E(|f|\geqslant t)
        $$
    \end{proof}
    \begin{corollary}
        Если $f\in L(E;\mu)$, то $f$ почти везде конечна.
    \end{corollary}
    \begin{proof}
        $$
        E(|f|=+\infty)=\bigcap\limits_{k=1}^\infty E(|f|\geqslant n)
        $$
        Но по \hyperref[Неравенство Чебышёва]{неравенству Чебышёва}:
        $$
        \mu E(|f|\geqslant n)\leqslant\frac1n\int_E|f|\underset{n\to\infty}\longrightarrow0
        $$
    \end{proof}
    \begin{corollary}
        Пусть $f\in L(E;\mu)$, $f\geqslant0$ и $\inf_Ef=0$. Тогда $f\sim0$ (почти везде равна нулю).
    \end{corollary}
    \begin{proof}
        $$
        E(f>0)=\bigcup\limits_{n=1}^\infty E\left(f\geqslant\frac1n\right)
        $$
        Каждое из множеств правой части имеет нулевую меру по \hyperref[Неравенство Чебышёва]{неравенству Чебышёва}:
        $$
        \mu E(f\geqslant\frac1n)\leqslant n\int_Ef=0
        $$
    \end{proof}
    \begin{theorem}[Cчётная аддитивность интеграла по множеству]
        \label{Cчётная аддитивность интеграла по множеству}
        Пусть $E=\bigsqcup\limits_kE_k\mid E_k\in\mathbb A$ и $\exists\int_E f~\mathrm d\mu$. Тогда
        $$
        \int_E f~\mathrm d\mu=\sum\limits_k\int_{E_k}f~\mathrm d\mu
        $$
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item Пусть $f$ неотрицательно. Поскольку $E_k$ дизъюнктны,
            $$
            \chi_E=\sum\limits_k\chi_{E_k}
            $$
            Тогда
            $$
            f\chi_E=\sum\limits_kf\chi_{E_k}
            $$
            По \hyperref[Теорема Леви для рядов]{теореме Леви для рядов} это можно проинтегрировать по $E$, получив
            $$
            \int_Ef=\sum\limits_k\int_Ef\chi_{E_k}=\sum\limits_k\int_{E_k}f
            $$
            \item Общий случай:
            $$
            \int_Ef_+=\sum\limits_k\int_{E_k}f_+\qquad \int_Ef_-=\sum\limits_k\int_{E_k}f_-
            $$
            Нам дано, что $\int_Ef$ существует, значит $\int_Ef_+$ и $\int_Ef_-$ одновременно в бесконечность не обращаются, а значит и не обращаются $\int_{E_k}f_+$ и $\int_{E_k}f_-$. Отсюда всё ясно.
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        Пусть $f\in S(X)$, $f\geqslant 0$. Пусть
        $$\nu A=\int_Af~\mathrm d\mu\mid A\in\mathbb A$$
        Тогда $\nu$~--- мера на $\mathbb A$.
    \end{corollary}
    \begin{proof}
        Тривиально из теоремы \ref{Cчётная аддитивность интеграла по множеству}.
    \end{proof}
    \begin{corollary}[Приближение интеграла интегралом по множеству конечной меры]
        \label{Приближение интеграла интегралом по множеству конечной меры}
        Пусть $\mu E=+\infty$, $f\in S(E)$. Тогда
        $$
        \forall\eps>0~\exists E_\eps\subset E:\mu E_\eps<+\infty~\left|\int_Ef~\mathrm d\mu-\int_{E_\eps}f\mathrm d\mu\right|<\eps
        $$
    \end{corollary}
    \begin{proof}
        Во-первых,
        $$
        \left|\int_{E\setminus E_\eps}f\right|\leqslant\int_{E\setminus E_\eps}|f|
        $$
        А значит можно считать, что $f\geqslant 0$.\\
        Пусть
        $$
        A_n=E\left(f\leqslant\frac1n\right)\qquad A=E(f=0)
        $$
        Тогда
        $$
        A_{n+1}\subset A_n\qquad A=\bigcap\limits_{n=1}^\infty A_n
        $$
        Пусть $\nu A=\int_Ef\mathrm d\mu$. Тогда
        $$
        \nu A_n=\int_{A_n}f\mathrm d\mu\leqslant\int_Ef~\mathrm d\mu<+\infty\qquad \nu A=0
        $$
        По \hyperref[Непрерывность меры]{непрерывности меры} $\nu A_n\rightarrow \nu A=0$, а значит существует такое $N$, что $\nu A_N<\eps$.\\
        Положим $E_\eps=E\setminus A_N$. Тогда
        $$
        \int_{E\setminus E_\eps}f=\nu A_N<\eps
        $$
        А поскольку $E_\eps=E(f\geqslant\frac1N)$
        $$
        \mu E_\eps\leqslant N\int_Ef<+\infty
        $$
        По \hyperref[Неравенство Чебышёва]{неравенству Чебышёва}.
    \end{proof}
    \begin{theorem}[Теорема Фату]
        \label{Теорема Фату}
        \begin{enumerate}
            \item Если $f_n\in S(E)$, $f_n\geqslant0$, то
            $$
            \int_E\liminf f_n~\mathrm d\mu\leqslant\liminf \int_Ef_n~\mathrm d\mu
            $$
            \item Если $f_n,f\in S(E)$, $f_n\geqslant0$, $f_n\rightarrow f$ почти везде на $E$. Тогда
            $$
            \int_Ef~\mathrm d\mu\leqslant\liminf\int_Ef_n~\mathrm d\mu
            $$
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item Пусть $g_n=\inf\limits_{k\geqslant n}f_k$. Тогда $g_n\in S(E)$, $g_n\geqslant0$, $g_n\uparrow$, $g_n\rightarrow\liminf f_n$ и $g_n\leqslant f_n$.\\
            Последнее проинтегрируем:
            $$
            \int_Eg_n\leqslant\int_Ef_n
            $$
            Перейдём к нижнему пределу:
            $$
            \liminf\int_Eg_n\leqslant\liminf\int_Ef_n
            $$
            В левой части есть обычный предел по \hyperref[Теорема Леви]{теореме Леви}:
            $$
            \liminf\int_Eg_n=\lim\int_Eg_n=\int_E\liminf f_n
            $$
            \item Из первого
            $$
            f=\lim f_n=\liminf f_n
            $$
        \end{enumerate}
    \end{proof}
    \begin{corollary}
        $f_n,f\in S(E)$, $f\geqslant0$, $f_n\rightarrow n$ почти везде на $E$ и
        $$
        \forall n~\int_E f_n~\mathrm d\mu\leqslant K
        $$
        То
        $$
        \int_E f~\mathrm d\mu\leqslant K
        $$
    \end{corollary}
    \begin{proof}
        Посмотрите на доказательство \hyperref[Теорема Фату]{теоремы Фату}.
    \end{proof}
    \begin{remark}
        Вообще из этого следует теорема Фату, но пофиг.
    \end{remark}
    \begin{theorem}[Теорема Лебега о мажорированной сходимости]
        \label{Теорема Лебега о мажорированной сходимости}
        Пусть $f_n,f\in S(E)$, $f_n\rightarrow f$ почти везде на $E$, $\exists \Phi\in L(E;\mu)~\forall n\in\mathbb N~|f_n|<\Phi$ почти везде. Тогда
        $$
        \int_Ef_n~\mathrm d\mu\underset{n\to+\infty}\longrightarrow\int_Ef~\mathrm d\mu
        $$
    \end{theorem}
    \begin{remark}
        Сначала про $\forall n\in\mathbb N~|f_n|<\Phi$ почти везде. Тут имеется ввиду, что существует множество нулевой меры своё для каждого $n$. Но поскольку тут число условий счётно, можно взять их объединие, получим одно большое множество нулевой меры для всех утверждений сразу.
    \end{remark}
    \begin{proof}
        Почти везде одновременно верны
        $$
        |f_n|\leqslant\Phi\qquad f_n\rightarrow f
        $$
        Отсюда $|f|\leqslant\Phi$ почти везде, а значит $f_n,f\in L(E;\mu)$.
        $$
        \int_E\Phi+\int_Ef=\int_E(\Phi+f)=\int_E\lim(\underbrace{\Phi+f_n}_{\geqslant0})\overset{\ref{Теорема Фату}}\leqslant\liminf\int_E(\Phi+f_n)=\liminf\left(\int_E\Phi+\int_Ef_n\right)=\int_E\Phi+\liminf\int_Ef_n
        $$
        Слева и справа вычтем $\int_E\Phi$, получим
        $$
        \int_Ef\leqslant\liminf\int_Ef_n
        $$
        Если мы докажем, что $\limsup\int_Ef_n\leqslant\int_Ef$, то получим искомое.\\
        Рассмотрим
        \[\begin{split}
            \int_E\Phi-\int_Ef&=\int_E(\Phi-f)=\int_E\lim(\underbrace{\Phi-f_n}_{\geqslant0})\overset{\ref{Теорема Фату}}\geqslant\liminf\int_E(\Phi-f_n)=\liminf\left(\int_E\Phi-\int_E f_n\right)=\\
            &=\int_E\Phi+\liminf(-\int_Ef_n)=\int_E\Phi-\limsup\int_Ef_n
        \end{split}\]
    \end{proof}
    \begin{corollary}
        \label{cor:Лебега,1}
        Пусть $\mu E<+\infty$, $f_n,f\in S(E)$, $f_n$ равномерно ограничена на $E$ и $f_n\rightarrow f$ почти везде на $E$. Тогда
        $$
        \int_Ef_n~\mathrm d\mu\underset{n\to+\infty}\longrightarrow\int_Ef~\mathrm d\mu
        $$
    \end{corollary}
    \begin{proof}
        В качестве мажоранты выступает константа.
    \end{proof}
    \begin{remark}
        \hyperref[Теорема Лебега о мажорированной сходимости]{Теорема Лебега} и следствие \ref{cor:Лебега,1} усиливают теорему о предельном переходе при условии равномерной сходимости.\\
        По модулю, конечно, того, что мы пока не сказали ничего про связь интеграла Римана и Лебега.
    \end{remark}
    \begin{claim}
        Сходимость почти везде в теоремах \ref{Теорема Фату} и \ref{Теорема Лебега о мажорированной сходимости} можно заменить на сходимость по мере.
    \end{claim}
    \begin{proof}
        Без доказательства, но это нетрудно, в доказательстве может помочь \hyperref[Теорема Рисса]{теорема Рисса}.
    \end{proof}
    \begin{claim}
        Если $\mu$ полно, то в теоремах \ref{Теорема Фату} и \ref{Теорема Лебега о мажорированной сходимости} измеримости $f$ можно не требовать: она следует из остальных условий.
    \end{claim}
    \begin{theorem}[Абсолютная непрерывность интеграла]
        \label{Абсолютная непрерывность интеграла}
        Если $f\in L(E;\mu)$, то
        $$
        \forall\eps>0~\exists\delta>0~\forall e\subset E:\mu e<\delta~\left|\int_ef~\mathrm d\mu\right|<\eps
        $$
    \end{theorem}
    \begin{proof}
        Достаточно рассматривать неотрицательные функции.\\
        Зафиксируем $\eps>0$. Подберём простую функцию $\phi$, которая приближает $\int f$ с точностью до $\frac\eps2$:
        $$
        \exists\phi\text{ простая}:\phi<f\text{ на }E~\int_Ef<\int_E\psi+\frac\eps2
        $$
        У простой функции конечное количество значений, а значит
        $$
        \exists M\in(0;+\infty)~\phi\leqslant M
        $$
        Осталось лишь предъявить $\delta=\frac\eps{2M}$. Почему такое подойдёт? Ну, рассмотрим $e\subset E:\mu e<\delta$. Тогда
        $$
        \int_ef=\int_ef-\int_e\phi+\int_e\phi=\int_e(\underbrace{f-\phi}_{\geqslant0\text{ на }E})+\int_e\phi\leqslant\int_E(f-\phi)+M\mu e<\frac\eps2+\frac\eps2=\eps
        $$
    \end{proof}
    \subparagraph{Сравнение интегралов Римана и Лебега.}
    \begin{definition}
        Пусть $f\colon[a;b]\to\overline{\mathbb R}$, $\delta>0$, $x_0\in[a;b]$. Положим
        $$
        M_\delta(x_0)=\sup\limits_{(x_0-\delta;x_0+\delta)\cap[a;b]}f
        $$
        $$
        m_\delta(x_0)=\inf\limits_{(x_0-\delta;x_0+\delta)\cap[a;b]}f
        $$
        Тогда $M_\delta$ возрастает по $\delta$, а $m_\delta$~--- убывает. Тогда пусть
        $$
        M(x_0)=\lim\limits_{\delta\to+0}M_\delta(x_0)\qquad m(x_0)=\lim\limits_{\delta\to+0}m_\delta(x_0)
        $$
        Функции $m,M\colon[a;b]\to\overline{\mathbb R}$ называются \textbf{функциями Бэра} $f$ (соответственно, нижней и верхней).
    \end{definition}
    \begin{property}
        $$m_\delta(x_0)\leqslant m(x_0)\leqslant f(x_0)\leqslant M(x_0)\leqslant M_\delta(x_0)$$
    \end{property}
    \begin{theorem}[Теорема Бэра]
        \label{Теорема Бэра}
        Пусть $f\colon [a;b]\to\overline{\mathbb R}$, $x_0\in[a;b]$, $f(x_0)<+\infty$. Тогда следующие утверждения равносильны:
        \begin{enumerate}
            \item $f\in C(x_0)$.
            \item $M(x_0)=m(x_0)$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{enumerate}
            \item[$1\to2$] Запишем определение непрерывности:
            $$
            \forall\eps>0~\exists\delta>0~\forall x\in(x_0-\delta;x_0+\delta)\cap[a;b]~f(x_0)\in(f(x_0)-\eps;f(x_0)+\eps)
            $$
            Возьмём $\sup$ и $\inf$ по $x$:
            $$
            f(x_0)-\eps\leqslant m(x_0)\leqslant M(x_0)\leqslant f(x_0)+\eps
            $$
            Отсюда $m(x_0)$ и $M(x_0)$ конечны и $M(x_0)-m(x_0)<2\eps$. Устремим $\eps\to+0$, получим $M(x_0)=m(x_0)$.
            \item[$2\to1$] Поскольку $m(x_0)\leqslant f(x_0)\leqslant M(x_0)$ и $m(x_0)=M(x_0)$, также верно $m(x_0)=f(x_0)=M(x_0)\in\mathbb R$.\\
            По определению $M$ и $m$
            $$
            \forall\eps>0~\exists\delta>0~m(x)-m_\delta(x)<\eps,M_\delta(x)-M(x)<\eps
            $$
            Тогда
            $$
            f(x_0)-\eps=m(x_0)-\eps<m_\delta(x_0)\leqslant M_\delta(x_0)<M(x_0)+\eps<f(x_0)+\eps
            $$
            Если $x\in(x_0-\delta;x_0+\delta)\cap[a;b]$, то $m_\delta(x_0)\leqslant f(x)\leqslant M_\delta(x_0)$ по определению $M_\delta(x_0)$ и $m_\delta(x_0)$. То есть
            $$
            f(x_0)-\eps<m_\delta(x_0)\leqslant f(x)\leqslant M_\delta(x_0)<f(x_0)+\eps
            $$
            Всё.
        \end{enumerate}
    \end{proof}
    \begin{lemma}
        \label{lm:о последовательности дроблений}
        Пусть $f\colon[a;b]\to\overline{\mathbb R}$. Пусть $\{\tau_i\}_{i=1}^\infty=\{\{x_k^{(i)}\}_{k=0}^{n_i}\}$~--- последовательность дроблений $[a;b]$.
        $$\lambda_i=\max\limits_{0\leqslant k\leqslant n_i-1}(x_{k+1}^{(i)}-x_k^{(i)})\underset{i\to\infty}\longrightarrow0$$
        Пусть
        $$M_k^{(i)}=\sup\limits_{[x_k^{(i)};x_{k+1}^{(i)}]}\qquad m_k^{(i)}=\inf\limits_{[x_k^{(i)};x_{k+1}^{(i)}]}$$
        Пусть
        $$
        \Phi_i=\sum\limits_{k=0}^{n_i-1}M_k^{(i)}\chi_{(x_k^{(i)};x_{k+1}^{(i)})}\qquad \phi_i=\sum\limits_{k=0}^{n_i-1}m_k^{(i)}\chi_{(x_k^{(i)};x_{k+1}^{(i)})}
        $$
        Пусть $x_0\in[a;b]$ не совпадает ни с одной точкой ни одного дробления. Тогда
        $$
        \Phi_i(x_0)\underset{i\to\infty}\longrightarrow M(x_0)\qquad \phi_i(x_0)\underset{i\to\infty}\longrightarrow m(x_0)
        $$
    \end{lemma}
    \begin{proof}
        Докажем для $\phi_i$, для $\Phi_i$ аналогично.\\
        При каждом $i$ $x_0$ попадает между какими-то точками дробления. Пусть
        $$
        x_0\in(x_l^{(i)};x_{l+1}^{(i)})
        $$
        Обозначим $l$ как $l(i)$.\\
        Докажем, что $\phi_i(x_0)\leqslant m(x_0)$. Пусть $\sigma=\min\{x_0-x_l^{(i)},x_{l+1}^{(i)}-x_0\}$. Тогда $\forall\delta\in(0;\sigma)~(x-\delta;x+\delta)\subset(x_l^{(i)};x_{l+1}^{(i)})$. Перейдя в этом неравенстве к инфимуму, получим
        $$
        m_\delta(x_0)\geqslant m_l^{(i)}=\phi_i(x_0)
        $$
        Устремив $\delta\to0+$, получим неравенство
        $$\phi_i(x_0)\leqslant m(x_0)$$
        Таким образом мы доказали лемму в очень частном случае: $m(x_0)=-\infty$. Дальше мы будем считать, что $m(x_0)>-\infty$.\\
        Возьмём $c<m(x_0)$ и докажем, что начиная с некоторого номера $\phi_i(x_0)>c$.\\
        Существует такое $\gamma>0$, что $m_\gamma(x_0)>c$. Существует такое $I\in\mathbb N$, что $\forall i>I~\lambda_i<\gamma$.
        $$
        x_0\in(x_l^{(i)};x_{l+1}^{(i)})\subset[x_l^{(i)};x_{l+1}^{(i)}]\subset(x_0-\gamma;x_0+\gamma)
        $$
        Перейдём тут к $\inf$, получим
        $$
        m_l^{(i)}=\phi_i(x_0)\geqslant m_\gamma(x_0)>c
        $$
        Получили то, что хотели: $\phi_i(x_0)\in(c;m(x_0)]$ для любого $c<m(x_0)$.
    \end{proof}
    \begin{corollary}
        Функции Бэра любой $f\colon[a;b]\to\overline{\mathbb R}$ измеримы по Лебегу.
    \end{corollary}
    \begin{proof}
        Потому что функции Бэра~--- пределы последовательностей измеримых функций $\Phi_i$ и $\phi_i$ почти везде (везде, кроме точек дробления, а таких точек счётное число).
    \end{proof}
    \begin{remark}
        Далее интеграл Римана обозначается $(R)\!\int$, а интеграл Лебега~--- $(L)\!\int$.
    \end{remark}
    \begin{theorem}[Критерий Лебега]
        \label{Критерий Лебега}
        Пусть $f\colon[a;b]\to\mathbb R$. Тогда $f\in R[a;b]$ тогда и только тогда, когда $f$ ограничена и множество её точек разрыва имеет нулевую меру.
    \end{theorem}
    \begin{theorem}[Сравнение интегралов Римана и Лебега]
        \label{Сравнение интегралов Римана и Лебега}
        Если $f\in R[a;b]$, то $f\in L[a;b]$ и $(R)\!\int f=(L)\!\int f$.
    \end{theorem}
    \begin{remark}
        Включение $R[a;b]$ в $L[a;b]$ строгое. Примером функции из второго, но не первого, может служить функция Дирихле.
    \end{remark}
    \begin{proof}
        Из всех посылок следует, что $f$ ограничена. Пусть ограничена числом $K$. Тогда $|\phi_i|,|\Phi_i|\leqslant K$.\\
        $$
        (L)\!\int\limits_a^b\phi_i=s_i\qquad (L)\!\int\limits_a^b\Phi_i=S_i
        $$
        Где $s_i,S_i$~--- суммы Дарбу.\\
        По лемме \ref{lm:о последовательности дроблений} и \hyperref[Теорема Лебега о мажорированной сходимости]{теореме Лебега}
        $$
        (L)\!\int\limits_a^b\phi_i\underset{i\to\infty}\longrightarrow(L)\!\int\limits_a^bm\qquad (L)\!\int\limits_a^b\Phi_i\underset{i\to\infty}\longrightarrow(L)\!\int\limits_a^bM
        $$
        Тогда
        $$
        S_i-s_i\underset{i\to\infty}\longrightarrow(L)\!\int\limits_a^b(M-m)
        $$
        Начинаем доказывать теоремы
        \begin{enumerate}
            \item Как мы знаем из свойств интеграла
            $$f\in R[a;b]\Leftrightarrow f\text{ ограничена}\land S_i-s_i\rightarrow0$$
            При этом второе равносильно тому, что $f$ ограничена и $(L)\!\int\limits_a^b(M-m)=0$, а это равносильно тому, что $M$ и $m$ совпадают почти везде, что равносильно непрерывности $f$ почти везде.
            \item $f\in R[a;b]\Rightarrow f=M=m$ почти везде, а значит $f$ измеримо по Лебегу (а так как ещё верна ограниченность $f$, $f\in L[a;b]$).\\
            Осталось лишь доказать равенство интегралов.\\
            С одной стороны $s_i$ стремится к $(R)\!\int\limits_a^bf$, а с другой~--- к $(L)\!\int_a^bm=(L)\!\int_a^bf$.
        \end{enumerate}
    \end{proof}
    \paragraph{Кратные и повторные интегралы.}
    \begin{remark}
        Напоминание: $\mu_n$~--- мера Лебега в $\mathbb R^n$. Также лень писать $\int_Ef(x)~\mathrm \mu_n(x)$, вместо этого будем писать $\int_Ef(x)~\mathrm x$. Также последнее пишут так:
        $$
        {\int\cdots\int}_Ef(x_1;\ldots;x_n)~\mathrm dx_1\cdots\mathrm dx_n
        $$
        Также пишут вещи наподобие
        $$
        \iiint_Ef(x;y;z)~\mathrm dx\mathrm dy\mathrm dz
        $$
        Напоминание: сечением множества $E\subset\mathbb R^{n+m}$ элементом $x\in\mathbb R^n$ называется $E(x)=\{y\in\mathbb R^m\mid x\in E\}$.
    \end{remark}
    \begin{theorem}[Восстановление меры множества по мерам сечений (оно же принцип Кавальери)]
        \label{Восстановление меры множества по мерам сечений}
        \label{Принцип Кавальери}
        Пусть $E\in\mathbb A_{n+m}$. Тогда
        \begin{enumerate}
            \item При почти всех $x\in\mathbb R^n$ $E(x)\in\mathbb A_m$.
            \item Функция, которая почти каждому $x$ сопоставляет $\mu_mE(x)$ измерима в $\mathbb R^n$.
            \item $\mu_{n+m} E=\int_{\mathbb R^n}\mu_mE(x)~\mathrm dx$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        Доказывать будем, постепенно усложняя $E$.
        \begin{enumerate}[a.]
            \item Пусть $E$~--- ячейка ($n+m$-мерная). Обозначим её буквой $\Delta$. $\Delta=\Delta^{(n)}\times\Delta^{(m)}\mid \Delta^{(n)}\in\mathbb R_n,\Delta^{(m)}\in\mathbb R_m$. Здесь легко написать сечение.
            $$\Delta(x)=\begin{cases}
                \Delta^{(m)} & x\in\Delta^{(n)}\\
                \varnothing & x\in\Delta^{(n)}
            \end{cases}$$
            Это множество измеримо при всех $x$,
            $$\mu_m\Delta(x)=\mu_m\Delta^{(m)}\chi_{\Delta^{(n)}}(x)$$
            $$
            \int_{\mathbb R^n}\mu_m\Delta(x)~\mathrm dx=\mu_m\Delta^{(m)}\mu_n\Delta^{(n)}=\mu_{n+m}\Delta
            $$
            \item Пусть $E$ открыто (обозначим его буквой $G$). Тогда его можно представить в виде счётного объединения дизъюнктных кубических ячеек:
            $$
            G=\bigsqcup\limits_k\Delta_k
            $$
            Заметим, что из определения сечения
            $$
            G(x)=\bigsqcup\limits_k\Delta_k(x)
            $$
            $\Delta_k(x)$ измеримы, счётное их объединение измеримо.\\
            Отсюда
            $$
            \mu_mG(x)=\sum\limits_k\mu_m\Delta_k(x)
            $$
            Эта функция измерима как сумма ряда измеримых функций. Теперь проинтегрируем
            $$
            \int_{\mathbb R^n}G(x)~\mathrm dx\overset{\ref{Теорема Леви для рядов}}=\sum\limits_k\int_{\mathbb R^m}\mu_m\Delta_k(x)~\mathrm dx=\sum\limits_k\mu_{n+m}\Delta_k=\mu_{n+m}G
            $$
            \item Пусть теперь $E=K$~--- множество типа $G_\delta$ конечной меры. По определению типа $G_\delta$
            $$
            K=\bigcap\limits_{k=i}^\infty G_k\mid G_k\text{ открыты}
            $$
            Не уменьшая общности можно считать, что $G_{k+1}\subset G_k$ (иначе берём $\widetilde{G_k}=G_1\cap G_2\cap\cdots\cap G_k$) и что $\mu_{n+m}G_1<+\infty$ (иначе по регулярности меры Лебега подберём такое $G_0\supset K:\mu_{n+m}G_0<\mu_{n+m}K+1$, после чего $\widetilde{G_k}=G_k\cap G_0$).
            $$
            K(x)=\bigcap\limits_{k=1}^\infty G_k(x)
            $$
            Тогда
            $$
            G_k(x)\in\mathbb A_m
            $$
            Следовательно $K(x)\in\mathbb A_m$.\\
            Хорошо. Тогда заметим, что $G_{k+1}(x)\subset G_k(x)$. Далее:
            $$
            \int_{\mathbb R^n}\mu_mG_1(x)~\mathrm dx=\mu_{n+m}G_1<+\infty
            $$
            Значит почти везде $\mu_mG_1(x)<+\infty$. То есть при почти всех $x$
            $$
            \mu_mK(x)=\lim\limits_{N\to\infty}\mu_mG_N(x)
            $$
            То есть $K(x)$ измеримо как преде измеримых (по полноте меры Лебега).\\
            Проверим формулу:
            $$
            \int_{\mathbb R^n}\mu_mK(x)~\mathrm dx=\int_{\mathbb R_n}\lim\limits_{N\to\infty}\mu_mG_n(x)~\mathrm dx\overset{\ref{Теорема Лебега о мажорированной сходимости}}=\lim\limits_{N\to\infty}\int_{\mathbb R_n}\mu_mG_N(x)~\mathrm dx=\lim\limits_{N\to\infty}\mu_{n+m}G_N\overset{\ref{Непрерывность меры}}=\mu_{n+m}K
            $$
            \item Докажем теорему для множества нулевой меры $E=e$. Измеримое по Лебегу множество можно заключить в множество типа $G_\delta$ той же меры:
            $$
            \exists K~\mu_{n+m}K=0,e\subset K
            $$
            Тогда $e(x)\subset K(x)$. По предыдущему пункту $0=\mu_{n+m}K=\int_{\mathbb R^n}\mu_m K(x)~\mathbb dx$, следовательно почти везде $\mu_m K(x)=0$. А значит и $\mu_m e(x)$ почти везде равно нулю. А значит $e(x)\in\mathbb A_n$ почти всегда равно нулю, а $x\mapsto\mu_m e(x)$ измерима как эквивалентная нулю. Остаётся проверить формулу интеграла
            $$
            \int_{\mathbb R^n}\mu_me(x)~\mathrm dx=0=\int_{\mathbb R^n}\mu_mK(x)=\mu_{n+m}K=0=\mu_{n+m}e
            $$
            \item Рассмотрим произвольное множество $E$ конечной меры. Поместим его в множество типа $G_\delta$.
            $$
            \exists K\text{ типа }G_\delta~E\subset K,\mu_{n+m}(K\setminus E)=0
            $$
            Обозначим $K\setminus E=e$. Тогда $E(x)\subset K(x)$, $K(x)\setminus E(x)=e(x)$.\\
            При почти всех $x$ $\mu_{n+m}e(x)$ измеримо и имеет нулевую меру, отсюда $E(x)=K(x)\setminus e(x)\in\mathbb A_m$ при почти всех $x$. $\mu_n E(x)=\mu_n K(x)$ при почти всех $x$, а по доказанному ранее второе измеримо, а также
            $$
            \int_{\mathbb R^n}\mu_mE(x)~\mathrm dx=\int_{\mathbb R^n}\mu_mK(x)~\mathrm dx=\mu_{n+m}K=\mu_{n_m}E
            $$
            \item Пусть $\mu_{n+m}E=+\infty$. Представим $E$ в виде счётного объединения множеств конечной меры:
            $$
            E=\bigcup\limits_{p=1}^\infty\underbrace{E\cap[-p\mathbb1;p\mathbb1)}_{E_p}
            $$
            Тогда $E_{p+1}\supset E_p$. Заметим, что
            $$
            E(x)=\bigcup\limits_{p=1}^\infty E_p(x)
            $$
            А $E_p(x)\in\mathbb A_m$ при почти всех $x$ (а значит при почти всех $x$ все они $\in\mathbb A_m$), то есть и $E(x)\in\mathbb A_m$ почти всегда.\\
            Второе:
            $$
            \mu_mE(x)=\lim\limits_{N\to\infty}\mu_mE_p(x)
            $$
            А значит $E(x)$ измеримо как предел измеримых.
            $$
            \int_{\mathbb R^n}\mu_mE(x)~\mathbb R^n=\int_{\mathbb R^n}\lim\limits_{N\to\infty}\mu_mE_N(x)~\mathrm dx\overset{\ref{Теорема Леви}}=\lim\limits_{N\to\infty}\int_{\mathbb R^n}\mu_mE_N(x)~\mathrm dx=\lim\limits_{N\to\infty}\mu_{n+m}E_N\overset{\ref{Непрерывность меры}}=\mu_{n+m}E
            $$
        \end{enumerate}
    \end{proof}
    \begin{remark}
        Если $\mu_{n+m}E(x)<+\infty$, то для почти всех точек $x\in\mathbb R^n~\mu_mE(x)<+\infty$.
    \end{remark}
    \begin{remark}
        Словосочетание <<почти везде>> существенно.\\
        Для подтверждения этого возьмём $e$~--- неизмеримое в $\mathbb R^m$, $x\in\mathbb R^n$. Тогда $\{x\}\times e$ имеет меру ноль, но $E(x)$ не измеримо.
    \end{remark}
    \begin{example}
        Мера шара.\\
        Пусть $\overline B_n(a,R)=\{x\in\mathbb R^n\mid |x-a|\leqslant R\}$. $\mu_n\overline B_n(a;R)$. Поскольку мера Лебега инвариантна относительно сдвига, от $a$ результат не зависит, а значит можно считать $a=\mathbb0$. Также мы знаем, как мера ведёт себе при гомотетии: $\mu_n\overline B_n(\mathbb0;R)=R^n\mu_n\overline B_n(\mathbb0;1)$. Обозначим $V_n=\mu_n\overline B_n(\mathbb 0_n;1)$
        $$B_n(x_n)=\begin{cases}
            \varnothing & |x_n|>1\\
            \overline B_{n-1}(\mathbb 0_{n-1};1) & |x_n|\leqslant 1
        \end{cases}$$
        То есть
        $$
        V_n=\int\limits_{-1}^1\mu_{n-1}(\overline B_{n-1}(\mathbb0_{n-1};\sqrt{1-x_n^2}))~\mathrm dx_n=V_{n-1}\int\limits_{-1}^1(\sqrt{1-x^2})^{n-1}~\mathrm dx=2V_{n-1}\frac{(n-1)!!}{n!!}\begin{cases}
            1 & n\not\divby2\\
            \frac\pi2 & n\divby 2
        \end{cases}
        $$
        Имеем рекуррентное соотношение $V_n=2I_nV_{n-1}$. Умеем считать $V_1=2$. То есть
        $$
        V_n=2^{n-1}\left(\prod\limits_{k=2}^nI_k\right)\cdot2=2^n\frac1{n!!}\left(\frac\pi2\right)^{\left\lfloor\frac n2\right\rfloor}
        $$
    \end{example}
    \begin{remark}
        Для открытого шара имеем тот же ответ.
    \end{remark}
    \begin{theorem}
        Пусть $A\in\mathbb A_n$, $B\in\mathbb A_m$, тогда $A\times B\in\mathbb A_{n+m}$ и $\mu_{n+m}A\times B=\mu_nA\mu_mB$.
    \end{theorem}
    \begin{proof}
        Если измеримость была бы нам известна, то формула была бы понятна по \hyperref[Принцип Кавальери]{принципу Кавальери}:
        $$
        (A\times B)(x)=\begin{cases}
            B&x\in A\\\varnothing&x\notin A
        \end{cases}
        $$
        Для открытых и для замкнутых $A,B$ очевидно (произведение двух открытых открыто, произведение двух замкнутых замкнуто, произведение открытого на замкнутое: замкнутое~--- разность двух открытых).\\
        Для всех остальных множеств будем приближать. Для начала пусть $\mu_nA<+\infty$, $\mu_mB<+\infty$
        $$
        \forall\eps>0~\exists G_1,G_2\text{ открытые},F_1,F_2\text{ замкнутые}~\mu_n(G_1\setminus F_1)<\eps,\mu_m(G_2\setminus F_2)<\eps,F_1\subset A\subset G_1,F_2\subset B\subset G_2
        $$
        Тогда
        $$
        F_1\times F_2\subset A\times B\subset G_1\times G_2
        $$
        А
        $$
        E=G_1\times G_2\setminus F_1\times F_2=((G_1\setminus F_1)\times F_2)\cup(F_1\times(G_2\setminus F_2))\cup((G_1\setminus F_1)\times(G_2\setminus F_2))
        $$
        Тогда
        $$
        \mu_{n+m}E\leqslant\eps\mu_mF_2+\eps\mu_nF_1+\eps^2\leqslant\eps\mu_mB+\eps\mu_nA+\eps^2
        $$
        По \hyperref[Критерий измеримости]{критерию измеримости} $A\times B\in\mathbb A_{n+m}$.\\
        Для $\mu_n A=+\infty$ или $\mu_m B=+\infty$ пользуемся
        $$
        A=\bigcup\limits_iA_i,B=\bigcup\limits_jB_j\qquad \mu_n A_i,\mu_m B_i<+\infty
        $$
        Тогда
        $$
        A\times B=\bigcup\limits_{i,j}(A_i\times B_j)
        $$
        Что измеримо по доказанному.
    \end{proof}
    \begin{example}
        Мера конуса.\\
        Пусть $E\subset\mathbb R^n$~--- основание конуса, $h$~--- высота конуса, $a=(\mathbb0_n;h)$~--- вершина конуса. Тогда
        $$
        K=\{(\lambda\xi;(1-\lambda)h)\mid\xi\in E,\lambda\in[0;1]\}
        $$
        Хочется сказать, что если $E$ измеримо в $\mathbb R^n$, то $K$ измеримо в $\mathbb R^{n+1}$. $\Phi(\xi;\lambda)=(\lambda\xi;(1-\lambda)h)$ гладкое, $E\times[0;1]$ измеримо, отсюда и $K=\Phi(E\times[0;1])$ измеримо.\\
        $$
        K(z)=\begin{cases}
            \left(1-\frac zh\right)E&z\in[0;h]\\
            \varnothing&z\notin[0;h]
        \end{cases}
        $$
        $$
        \mu_{n+1}K=\int_{\mathbb R}\mu_nK(z)~\mathrm dz=\int\limits_0^h\left(1-\frac zh\right)^n~\mathrm dz\mu_n E=h\int\limits_0^1(1-t)^n~\mathrm dt\mu_nE=\frac h{n+1}\mu_nE
        $$
    \end{example}
    \begin{definition}
        $$
        S_n(a)=\left\{x~\middle|~x_k\geqslant 0,\sum\limits_{k=1}^nx_k\leqslant a\right\}
        $$
        При $a>0$ называется $n$-мерным \textbf{стандартным симплексом}.
    \end{definition}
    \begin{property}
        $$\mu_nS_n(a)=\frac{a^k}{n!}$$
    \end{property}
\end{document}